# åº”ç”¨æ¶æ„è®¾è®¡
äº‘å¼€å‘èŒƒå¼ä¸­çš„åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•æ˜¯ä¸€å¥—å°†éç»“æ„åŒ–ä¸šåŠ¡éœ€æ±‚è¿›è¡Œç»“æ„åŒ–å’ŒæŠ½è±¡ï¼Œæœ€ç»ˆè½åœ°â€œç¬¦åˆé¢å‘å¯¹è±¡ç¼–ç¨‹(Object Oriented Programmingï¼ŒOOP) æ€æƒ³ã€å¾®æœåŠ¡æ‹†åˆ†åˆç†â€çš„ç¨‹åºçš„æ–¹æ³•è®ºã€‚

## æ¦‚å¿µ
### å¾®æœåŠ¡ã€å‘å¸ƒå•å…ƒã€æœåŠ¡å•å…ƒ
å¾®æœåŠ¡ï¼ˆMicroserviceï¼‰ æ˜¯æŒ‡â€œä¸€ä¸ªåŸºæœ¬çš„ã€ç‹¬ç«‹çš„è¿è¡Œå•å…ƒâ€ã€‚

- ä»ç ”å‘è§†è§’æ¥è¯´ï¼Œä¸€ä¸ªå¾®æœåŠ¡å¯¹åº”ä¸€ä¸ªå‘å¸ƒå•å…ƒã€‚
  >- **å‘å¸ƒå•å…ƒ**é€šå¸¸ä¸èƒ½ç›´æ¥è¿è¡Œï¼Œéœ€è¦åœ¨ç›®æ ‡æœåŠ¡å™¨ï¼ˆç‰©ç†æœºã€è™šæœºã€å®¹å™¨ï¼‰ä¸Šæä¾›ä¸€ä¸ªç¯å¢ƒï¼ˆåˆç§°ä¸ºæœ¬åœ°ä¾èµ–ï¼‰ä¾›å‘å¸ƒå•å…ƒè¿è¡Œï¼ŒåŒ…æ‹¬ï¼šæ“ä½œç³»ç»Ÿã€åº”ç”¨å®¹å™¨ï¼ˆå¦‚Tomcatï¼‰ã€ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼ˆå¦‚æ•°æ®åº“é©±åŠ¨ã€å‘½ä»¤è¡Œç­‰ï¼‰ã€é…ç½®æ–‡ä»¶ç­‰ã€‚
  >- **æœåŠ¡å•å…ƒ**åŒ…å«è¿è¡Œå‘å¸ƒå•å…ƒéœ€è¦çš„æœ¬åœ°ä¾èµ–ï¼Œä¸€ä¸ªå‘å¸ƒå•å…ƒé€šå¸¸ä¼šå¯¹åº”ä¸€åˆ°å¤šä¸ªæœåŠ¡å•å…ƒï¼Œè¿™äº›æœåŠ¡å•å…ƒåˆ†åˆ«å¯¹åº”ä¸åŒçš„è¿è¡Œç¯å¢ƒï¼ˆDEVã€STã€UATã€PRDï¼‰ã€éƒ¨ç½²å¹³å°ï¼ˆX86 VMã€Dockerï¼‰æˆ–ç½‘ç»œåˆ†åŒºï¼ˆOAã€BIZã€DMZï¼‰ã€‚å› æ­¤ï¼Œ
- ä»è¿ç»´è§†è§’æ¥è¯´ï¼Œä¸€ä¸ªå¾®æœåŠ¡å¯å¯¹åº”ä¸€åˆ°å¤šä¸ªæœåŠ¡å•å…ƒï¼Œå¾®æœåŠ¡çš„èµ„æºç”³è¯·ã€éƒ¨ç½²åŠè¿ç»´ä»¥æœåŠ¡å•å…ƒä¸ºå•ä½ã€‚

### æ¶æ„å®šä¹‰
- **ä¸šåŠ¡æ¶æ„**ï¼šä¼ä¸šå„ç±»ä¸šåŠ¡çš„è¿ä½œæ¨¡å¼åŠä¸šåŠ¡ä¹‹é—´çš„å…³ç³»ç»“æ„ã€‚ä¸€èˆ¬ç”±ä¸šåŠ¡éƒ¨é—¨çš„ä¸“å®¶è´Ÿè´£ï¼Œå±äºé¡¶å±‚è®¾è®¡ï¼Œä¼šå½±å“åˆ°ç»„ç»‡ç»“æ„ã€‚ä¾‹å¦‚ï¼Œé›¶å”®ã€å¯¹å…¬çš„ä¸šåŠ¡åˆ’åˆ†ã€‚

- **åº”ç”¨æ¶æ„**ï¼šä»£ç çš„ç»„ç»‡æ¨¡å¼å’Œç»“æ„ã€‚å…·ä½“åœ°ï¼Œâ€œåº”ç”¨æ¶æ„â€æè¿°äº†å¦‚ä½•é€šè¿‡åˆ†å±‚ã€åˆ†åŒ…ã€ä¾èµ–å…³ç³»ç­‰æœºåˆ¶å¯¹ä»£ç ç»“æ„æä¾›åˆç†çº¦æŸã€‚å…¶ç›®æ ‡æ˜¯è®¾è®¡åŠŸèƒ½æ˜“æ‰©å±•ã€ä¸šåŠ¡æ˜“æµ‹è¯•ã€ä»£ç é€»è¾‘æ˜“è¯»æ‡‚çš„åº”ç”¨ç³»ç»Ÿã€‚

- **ç³»ç»Ÿæ¶æ„**ï¼šæ ¹æ®å¯ç”¨æ€§ã€å®‰å…¨æ€§ã€ç¨³å®šæ€§ã€æ€§èƒ½ç­‰éåŠŸèƒ½ç‰¹æ€§æ‰€åšå‡ºçš„æŠ€æœ¯é€‰å‹ï¼Œä¾‹å¦‚å¯¹äº‘æœåŠ¡ã€æ•°æ®åº“ã€ç°åº¦ç­–ç•¥ç­‰è¿›è¡Œçš„é€‰å‹å’Œå†³ç­–ã€‚å…¶ç›®æ ‡æ˜¯è®¾è®¡é«˜å¯ç”¨ã€é«˜ç¨³å®šã€é«˜æ€§èƒ½çš„åº”ç”¨ç³»ç»Ÿã€‚

- **æ•°æ®æ¶æ„**ï¼šæ•°æ®çš„ç»„ç»‡å½¢å¼å’Œç»“æ„ã€‚ä¾‹å¦‚åœ¨å¤§æ•°æ®åœºæ™¯ä¸­ï¼Œæ•°æ®æ¶æ„å®šä¹‰äº†å¦‚ä½•å°†å„ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®æ±‡èšåœ¨ä¸€èµ·ï¼Œç»™ä¸šåŠ¡æä¾›æ•´ä½“è§†å›¾ã€‚

- **ç‰©ç†æ¶æ„**ï¼šè®¡ç®—æœºç¡¬ä»¶è®¾å¤‡ã€ä¼ è¾“åª’ä»‹å’Œç‰©ç†è¿æ¥æ–¹å¼ç­‰ç»„æˆçš„è®¡ç®—æœºç³»ç»Ÿçš„ç»“æ„å’Œå¸ƒå±€ã€‚

### MECE åŸåˆ™
MECEï¼šMutually Exclusiveï¼ŒCollectively Exhaustive
- Mutually Exclusiveï¼šæ¨¡å‹ä¸­çš„å„ä¸ªå…ƒç´ ï¼ˆå¦‚å®ä½“ã€å€¼å¯¹è±¡ã€èšåˆã€å­åŸŸã€é™ç•Œä¸Šä¸‹æ–‡ã€æ¦‚å¿µåˆ†ç±»ç­‰ï¼‰ä¹‹é—´åº”è¯¥æœ‰æ¸…æ™°ã€æ— é‡å çš„è¾¹ç•Œã€‚ä¸€ä¸ªæ¦‚å¿µæˆ–èŒè´£åªèƒ½å½’å±äºä¸€ä¸ªå…ƒç´ ã€‚
- Collectively Exhaustiveï¼šæ¨¡å‹ä¸­çš„å…ƒç´ ç»„åˆèµ·æ¥ï¼Œåº”è¯¥èƒ½å¤Ÿå®Œæ•´åœ°è¦†ç›–é—®é¢˜åŸŸçš„æ‰€æœ‰ç›¸å…³æ–¹é¢ã€‚æ²¡æœ‰é‡è¦çš„ä¸šåŠ¡æ¦‚å¿µã€è§„åˆ™æˆ–åœºæ™¯è¢«é—æ¼ã€‚
## æ¶æ„é€‰å‹
### ç®€å•åº”ç”¨æ¶æ„ or å¤æ‚åº”ç”¨æ¶æ„é€‰å“ªä¸ªï¼Ÿ
1. ï¼ˆ**ä¸šåŠ¡å˜æ›´é¢‘ç‡** * **è§„åˆ™å¤æ‚åº¦**ï¼‰> å›¢é˜Ÿå­¦ä¹ æˆæœ¬ ä¸”ï¼ˆ**ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸä»·å€¼**ï¼‰> æ¶æ„å‡çº§æˆæœ¬ï¼Œé€‰æ‹©å››å±‚æ¶æ„ã€‚
2. å¦‚æœä¸èƒ½å¾ˆç¡®å®šé€‰å“ªç§ï¼Œåˆ™é€‰æ‹©â€œç®€å•åº”ç”¨æ¶æ„è®¾è®¡â€å’Œä¸‰å±‚æ¶æ„ã€‚

### ä¼ ç»Ÿä¸‰å±‚æ¶æ„å’Œäº‘å¼€å‘èŒƒå¼ä¸‰å±‚æ¶æ„çš„åŒºåˆ«ï¼Ÿ
1. æ€æƒ³ä¸Šï¼šä¼ ç»Ÿmvcæœ¬è´¨ä¸Šæ˜¯ä¸€ç§é¢å‘æ•°æ®çš„è®¾è®¡ï¼Œä¸»è¦å…³æ³¨æ•°æ®ï¼Œæ˜¯ä¸€ç§è‡ªä½å‘ä¸Šçš„æ€æƒ³ï¼›DDDçš„å¼€å‘æ¨¡å¼ï¼šæ˜¯é¢†åŸŸé©±åŠ¨ï¼Œè‡ªé¡¶å‘ä¸‹ï¼Œå…³æ³¨ä¸šåŠ¡æ´»åŠ¨ã€‚
2. å®æ–½è¿‡ç¨‹ä¸Šï¼šä¼ ç»ŸMVCè¿‡ç¨‹ä¸ºéœ€æ±‚åˆ†æ-ç ”å‘äººå‘˜è®¾è®¡åº“è¡¨ç»“æ„-ç¼–å†™ä»£ç ã€‚äº‘å¼€å‘èŒƒå¼çš„ä¸‰å±‚æ¶æ„å’Œå››å±‚æ¶æ„ä¸€æ ·ï¼Œéœ€è¦å®Œæ•´çš„ä¸šåŠ¡å»ºæ¨¡-æŠ€æœ¯å»ºæ¨¡-ä»£ç è½åœ°ã€‚
3. ä»£ç å®ç°ä¸Šï¼šäº‘å¼€å‘èŒƒå¼ä¸‰å±‚æ¶æ„å¼ºè°ƒå……è¡€å®ä½“ä¸æ¥å£é˜²è…ã€‚

### ä¸‰å±‚æ¶æ„ vs å››å±‚æ¶æ„
#### ä¸ºä»€ä¹ˆç®€å•åº”ç”¨é€‰æ‹©ä¸‰å±‚æ¶æ„ï¼Ÿ
1. ç®€å•åº”ç”¨åœºæ™¯çš„ä¸šåŠ¡é€»è¾‘è¾ƒç®€å•ï¼Œä¸€èˆ¬ä»…æ¶‰åŠä¸€ä¸ªè¾ƒå°çš„é—®é¢˜åŸŸã€‚
2. ç®€å•åº”ç”¨åœºæ™¯çš„æ•°æ®æŒä¹…åŒ–é€»è¾‘å’Œéœ€æ±‚ä¹Ÿè¾ƒä¸ºç®€å•ã€‚
3. ç®€å•åº”ç”¨åœºæ™¯ä¸å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’å¾ˆå°‘ï¼Œå¯åœ¨æœåŠ¡å±‚é€šè¿‡ä¸“é—¨çš„æ¥å£å¤„ç†å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’ï¼Œé˜²æ­¢å¤–éƒ¨ç³»ç»Ÿçš„å˜æ›´è…åŒ–æœ¬ç³»ç»Ÿã€‚

#### ä¸ºä»€ä¹ˆå¤æ‚åº”ç”¨é€‰æ‹©å››å±‚æ¶æ„ï¼Ÿ
1. å¤æ‚åº”ç”¨åœºæ™¯çš„ä¸šåŠ¡è¾ƒå¤æ‚ï¼Œé€šå¸¸åŒ…å«å¤šä¸ªå­é—®é¢˜åŸŸã€‚
   > éƒ¨åˆ†ä¸šåŠ¡æ“ä½œæˆ–æ ¡éªŒè§„åˆ™æ¶‰åŠå¤šä¸ªé¢†åŸŸå¯¹è±¡ï¼Œä»»ä½•ä¸€ä¸ªé¢†åŸŸå¯¹è±¡å‡æ— æ³•ç‹¬ç«‹æ‰¿è½½ã€‚å¦‚æœé‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼Œè¿™éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘å°†æ•£è½åœ¨æœåŠ¡å±‚ã€‚å¦‚æœé‡‡ç”¨å››å±‚æ¶æ„ï¼Œå¯ä»åº”ç”¨å±‚ï¼ˆåœ¨ä¸‰å±‚æ¶æ„å«æœåŠ¡å±‚ï¼‰å°†è¿™éƒ¨åˆ†é€»è¾‘å‰¥ç¦»å‡ºæ¥ï¼Œæ²‰æ·€åˆ°é¢†åŸŸæœåŠ¡ã€‚é¢†åŸŸæœåŠ¡ä¸é¢†åŸŸå¯¹è±¡ä¸€èµ·å†…èšåˆ°é¢†åŸŸå±‚ï¼ˆDomainï¼‰ï¼Œæ›´æ˜¾æ€§åŒ–å†…èšä¸šåŠ¡é€»è¾‘ã€‚
2. å¤æ‚åº”ç”¨åœºæ™¯çš„æ•°æ®æŒä¹…åŒ–é€»è¾‘å’Œéœ€æ±‚ä¹Ÿè¾ƒä¸ºå¤æ‚ã€‚
   > å¦‚æœé‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼ŒæœåŠ¡å±‚éœ€åˆ†åˆ«é’ˆå¯¹ä¸‰ä¸ªæœˆå†…ï¼ˆå¦‚å­˜å‚¨åœ¨GaussDBï¼‰ã€å†å²æ•°æ®ï¼ˆå¦‚å­˜å‚¨åœ¨ECSï¼ŒElastic Cloud Storageï¼‰å®ç°ä¸åŒçš„æ•°æ®æ“ä½œé€»è¾‘ï¼Œå­˜å‚¨æ–¹å¼çš„å˜æ›´éœ€è°ƒæ•´æœåŠ¡å±‚çš„ä»£ç é€»è¾‘ã€‚å¦‚æœé‡‡ç”¨å››å±‚æ¶æ„ï¼Œé¢†åŸŸå±‚åªéœ€è¦å®šä¹‰æ•°æ®æŒä¹…åŒ–æ¥å£ï¼Œåº”ç”¨å±‚è°ƒç”¨é¢†åŸŸå±‚å®šä¹‰çš„æ¥å£ï¼ŒåŸºç¡€è®¾æ–½å±‚å®ç°é¢†åŸŸå±‚å®šä¹‰çš„æ¥å£ï¼Œå±è”½æŒä¹…åŒ–çš„å¤æ‚é€»è¾‘ï¼Œè¿™æ ·åˆ†å±‚èŒè´£æ›´æ¸…æ™°ã€‚
3. å¤æ‚åº”ç”¨åœºæ™¯ä¸å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’ä¹Ÿè¾ƒä¸ºå¤æ‚ã€‚
   > å¦‚æœé‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼Œä¸å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’é€»è¾‘æ•£è½åœ¨æœåŠ¡å±‚ï¼Œä¸æœ¬ç³»ç»Ÿçš„åŠŸèƒ½ä»£ç†äº¤ç»‡åœ¨ä¸€èµ·ï¼Œä»£ç éš¾ä»¥ç»´æŠ¤ã€‚å¤–éƒ¨ç³»ç»Ÿçš„å˜æ›´ï¼Œéœ€åŒæ­¥ä¿®æ”¹æœåŠ¡å±‚é€»è¾‘ä»£ç ï¼ŒåŒæ—¶å¯èƒ½ç›´æ¥å½±å“æœ¬ç³»ç»Ÿå·²æœ‰åŠŸèƒ½çš„å¯ç”¨æ€§ã€‚å¦‚æœé‡‡ç”¨å››å±‚æ¶æ„ï¼Œé¢†åŸŸå±‚å®šä¹‰ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’çš„æ¥å£ï¼Œåº”ç”¨å±‚è°ƒç”¨é¢†åŸŸå±‚å®šä¹‰çš„æ¥å£ï¼Œä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’çš„é€»è¾‘åœ¨åŸºç¡€è®¾æ–½å±‚å®ç°ã€‚é€šè¿‡å››å±‚æ¶æ„çš„åŸºç¡€è®¾æ–½å±‚å°†æœ¬ç³»ç»Ÿçš„ä¸šåŠ¡é€»è¾‘ï¼ˆå³é¢†åŸŸå±‚ã€åº”ç”¨å±‚ï¼‰ä¸å¤–éƒ¨ç³»ç»Ÿè§£è—•ï¼Œèµ·åˆ°é˜²è…çš„ä½œç”¨ã€‚

#### ä¸‰å±‚æ¶æ„å’Œå››å±‚æ¶æ„å¯¹æ¯”
![](images/ä¸‰å±‚æ¶æ„å’Œå››å±‚æ¶æ„å¯¹æ¯”.png)
ä¸¤ä¸ªæ–¹æ³•çš„ä¸»è¦å·®å¼‚ç‚¹å¦‚ä¸‹ï¼š  
1.**æ¢³ç†éœ€æ±‚**ï¼š ä¸¤ä¸ªæ–¹æ³•å‡é€šè¿‡â€œç”¨æˆ·æ•…äº‹â€æ¢³ç†éœ€æ±‚ï¼Œåˆæ­¥ç»“æ„åŒ–ä¸šåŠ¡éœ€æ±‚ã€‚ä½†ä¸¤è€…å¯¹ä»»åŠ¡ï¼ˆå³ç”¨æˆ·æ•…äº‹çš„"what"ï¼Œè¯¦è§ä¸¤ç§æ–¹æ³•çš„ä¸šåŠ¡å»ºæ¨¡éƒ¨åˆ†ï¼‰ç»†èŠ‚è¦æ±‚ä¸åŒã€‚  
ï¼ˆ1ï¼‰å¯¹äºç®€å•çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ¢³ç†çš„ä»»åŠ¡ç²’åº¦è¾ƒç»†ï¼Œå¯ä»¥è¾ƒæ¸…æ™°å®Œæ•´åœ°æè¿°ä¸šåŠ¡éœ€æ±‚ã€‚å³ä½¿å­˜åœ¨éƒ¨åˆ†ä»»åŠ¡æè¿°ä¸å¤Ÿæ¸…æ™°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å°‘é‡â€œå‘½ä»¤â€å’Œâ€œè§„åˆ™â€è¿›ä¸€æ­¥ç»†åŒ–ã€‚  
ï¼ˆ2ï¼‰å¯¹äºå¤æ‚çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ¢³ç†çš„ä»»åŠ¡ç²’åº¦è¾ƒç²—ï¼Œå¯¹éœ€æ±‚çš„æè¿°è¾ƒå®½æ³›ï¼Œéœ€ä½¿ç”¨è¾ƒå¤šâ€œå‘½ä»¤â€å’Œâ€œè§„åˆ™â€æ‰èƒ½ç»†åŒ–ä»»åŠ¡çš„æ—¶åºç»†èŠ‚ã€‚ç”¨æˆ·æ•…äº‹åœ°å›¾çš„ç›®æ ‡æ˜¯å±•ç°ä¸šåŠ¡å…¨æ™¯ï¼Œä¸éœ€è¦å…³æ³¨æ¯ä¸ªç»†èŠ‚ï¼Œå› æ­¤ï¼Œè¿™é‡Œåªéœ€ä½¿ç”¨ä»»åŠ¡ç»†èŠ‚è¡¥å……ä»»åŠ¡çš„å…³é”®ä¿¡æ¯ï¼Œåç»­åœ¨è¯†åˆ«é¢†åŸŸå¯¹è±¡é˜¶æ®µå†ç”¨â€œäº‹ä»¶é£æš´â€ç»†åŒ–æ¯ä¸ªä»»åŠ¡çš„æ—¶åºæµç¨‹åŠè§„åˆ™ç»†èŠ‚ã€‚  

2.**è¯†åˆ«é¢†åŸŸå¯¹è±¡**ï¼šâ€œå¤æ‚åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•â€åˆ©ç”¨â€œäº‹ä»¶é£æš´â€ç»†åŒ–æ¯ä¸ªä»»åŠ¡çš„äº‹ä»¶ã€å‘½ä»¤ã€è§„åˆ™ï¼Œç„¶åè¯†åˆ«é¢†åŸŸå¯¹è±¡ã€‚è€Œâ€œç®€å•åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•â€å¯ç›´æ¥æ ¹æ®â€œæ¢³ç†éœ€æ±‚â€çš„äº§ç‰©è¯†åˆ«é¢†åŸŸå¯¹è±¡ã€‚

3.**åˆ’åˆ†èšåˆ**ï¼šâ€œå¤æ‚åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•â€å¯é€‰â€œåˆ’åˆ†èšåˆâ€ï¼Œå°†å…·æœ‰å¼ºä¸šåŠ¡ä¸€è‡´æ€§ã€ç”Ÿå‘½å‘¨æœŸç›¸åŒçš„é¢†åŸŸå¯¹è±¡åˆ’åˆ†åˆ°ä¸€ä¸ªèšåˆã€‚

4.**è¯†åˆ«å®ä½“**ï¼šâ€œå¤æ‚åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•â€ä¼šåŒºåˆ†å®ä½“å’Œå€¼å¯¹è±¡ï¼Œè€Œâ€œç®€å•åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•â€å¯ä»¥ä¸åšåŒºåˆ†ã€‚

5.**åˆ†é…èŒè´£**ï¼šâ€œå¤æ‚åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•â€ä¼šè€ƒè™‘å°†æ¨¡å—å†…æ¶‰åŠå¤šä¸ªå®ä½“çš„å…·æœ‰æ˜ç¡®ä¸šåŠ¡è¯­ä¹‰çš„æ–¹æ³•æ²‰æ·€åˆ°é¢†åŸŸæœåŠ¡ã€‚

6.**ORMè¡¨è®¾è®¡**ï¼šâ€œå¤æ‚åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•â€ä¸­å®ä½“ä¸æŒä¹…åŒ–æ¨¡å‹ï¼ˆPersistence Objectï¼Œç®€ç§°POï¼‰é€šå¸¸ä¸ä¸€è‡´ï¼Œå› æ­¤å®ä½“ä¸ORMè¡¨åº”åˆ†å¼€è®¾è®¡ï¼›è€Œâ€œç®€å•åº”ç”¨æ¶æ„è®¾è®¡æ–¹æ³•â€ä¸­ï¼Œå®ä½“ä¸POåŸºæœ¬ä¿æŒä¸€è‡´ï¼ŒORMè¡¨è®¾è®¡å¯å‚è€ƒå®ä½“çš„è®¾è®¡ã€‚

åˆ’åˆ†å¾®æœåŠ¡çš„æ–¹æ³•ã€æµç¨‹ã€åŸåˆ™åŠè¦æ±‚åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œå‡å¼ºè°ƒåˆç†åœ°æ‹†åˆ†å¾®æœåŠ¡ï¼Œä»¥æ›´é«˜æ•ˆåœ°åˆ©ç”¨äº‘ä¼˜åŠ¿ã€‚

### ä¸‰å±‚æ¶æ„å¦‚ä½•å‘å››å±‚æ¶æ„æ¼”è¿›
æœ€æ ¸å¿ƒçš„ä¸¤ç‚¹ï¼šå……è¡€å’Œé˜²è…
ç¬¬ä¸€é˜¶æ®µå±€éƒ¨é‡æ„ï¼šé˜²è…å±‚è§£è—•ã€å®ä½“é€æ­¥å……è¡€ã€åˆ’åˆ†æ¨¡å—
ç¬¬äºŒé˜¶æ®µæ•´ä½“é‡æ„ï¼šåˆ’åˆ†å¾®æœåŠ¡ã€æŠ€æœ¯å»ºæ¨¡ã€å®Œæ•´å»ºæ¨¡è·¯å¾„

### dddå››å±‚ä¸šåŠ¡å»ºæ¨¡åœ¨è½åœ°é˜¶æ®µï¼Œæˆ–è€…æ˜¯æœ‰æ–°ä¸šåŠ¡éœ€æ±‚æ—¶ï¼Œä¸šåŠ¡æ¨¡å‹æ€ä¹ˆä¿é²œï¼Ÿ
åœ¨DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰å››å±‚ä¸šåŠ¡å»ºæ¨¡çš„è½åœ°é˜¶æ®µï¼Œæˆ–åœ¨é¢ä¸´æ–°ä¸šåŠ¡éœ€æ±‚æ—¶ï¼Œä¿æŒä¸šåŠ¡æ¨¡å‹çš„â€œä¿é²œâ€æ˜¯è‡³å…³é‡è¦çš„ã€‚ä¿æŒæ¨¡å‹çš„æ´»åŠ›ã€çµæ´»æ€§å’Œå‡†ç¡®æ€§ï¼Œå¯ä»¥è®©å›¢é˜Ÿæ›´å¥½åœ°åº”å¯¹å¤æ‚çš„ä¸šåŠ¡éœ€æ±‚å’Œå˜åŒ–ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…·ä½“çš„ç­–ç•¥å’Œæ–¹æ³•ï¼š

#### 1. **æŒç»­çš„é¢†åŸŸå»ºæ¨¡ä¸ä¸šåŠ¡ä¸“å®¶åˆä½œ**

* **å®šæœŸä¸ä¸šåŠ¡ä¸“å®¶æ²Ÿé€š**ï¼šé¢†åŸŸæ¨¡å‹æ˜¯éšç€ä¸šåŠ¡éœ€æ±‚çš„å˜åŒ–è€Œå˜åŒ–çš„ã€‚ä¸ä¸šåŠ¡ä¸“å®¶ï¼ˆå¦‚äº§å“ç»ç†ã€ä¸šåŠ¡åˆ†æå¸ˆï¼‰ä¿æŒç´§å¯†æ²Ÿé€šï¼Œå®šæœŸå›é¡¾ä¸šåŠ¡éœ€æ±‚å’Œç›®æ ‡ï¼Œç¡®ä¿ä¸šåŠ¡æ¨¡å‹èƒ½å¤Ÿåæ˜ æœ€æ–°çš„ä¸šåŠ¡ç°å®ã€‚
* **åé¦ˆç¯è·¯**ï¼šåœ¨é¡¹ç›®å®æ–½è¿‡ç¨‹ä¸­ï¼Œä¸šåŠ¡ä¸“å®¶çš„åé¦ˆå°¤ä¸ºé‡è¦ã€‚é€šè¿‡å®šæœŸçš„éœ€æ±‚è®¨è®ºã€æ¨¡å‹å®¡æŸ¥å’Œè¿­ä»£ï¼Œå¯ä»¥åŠæ—¶å‘ç°é¢†åŸŸæ¨¡å‹çš„æ½œåœ¨é—®é¢˜å¹¶è¿›è¡Œä¿®æ­£ã€‚

#### 2. **æ¨¡å‹è¿­ä»£ä¸æ¼”åŒ–**

* **é¢†åŸŸæ¨¡å‹çš„æ¼”åŒ–**ï¼šDDDçš„æ ¸å¿ƒç†å¿µä¹‹ä¸€æ˜¯é¢†åŸŸæ¨¡å‹åº”éšç€ä¸šåŠ¡çš„å‘å±•å’Œå˜åŒ–è€Œä¸æ–­æ¼”åŒ–ã€‚æ¯æ¬¡æ–°å¢ä¸šåŠ¡éœ€æ±‚æ—¶ï¼Œéƒ½éœ€è¦å¯¹æ¨¡å‹è¿›è¡Œå®¡æŸ¥å’Œä¿®æ”¹ã€‚å¦‚æœæŸä¸ªé¢†åŸŸå­˜åœ¨å¤æ‚çš„ä¸šåŠ¡å˜åŒ–ï¼Œå¯èƒ½éœ€è¦æ‹†åˆ†ã€åˆå¹¶æˆ–è€…è°ƒæ•´é¢†åŸŸå®ä½“ã€å€¼å¯¹è±¡ç­‰ã€‚
* **é€šè¿‡é‡æ„ä¿æŒæ¨¡å‹çš„ç®€æ´ä¸æ¸…æ™°**ï¼šåœ¨æ¯ä¸ªå¼€å‘å‘¨æœŸæˆ–ç‰ˆæœ¬å‘å¸ƒæ—¶ï¼Œè¿›è¡Œå¿…è¦çš„æ¨¡å‹é‡æ„ã€‚æ¯”å¦‚ï¼ŒåŸå…ˆçš„æŸäº›å®ç°å¯èƒ½å·²ç»ä¸å†é€‚åº”æ–°çš„ä¸šåŠ¡éœ€æ±‚ï¼Œè¿™æ—¶å€™éœ€è¦è°ƒæ•´é¢†åŸŸå¯¹è±¡çš„è®¾è®¡ï¼Œä¼˜åŒ–ä»£ç æ¶æ„ï¼Œç¡®ä¿æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ä¸ä¸šåŠ¡éœ€æ±‚å¯¹æ¥ã€‚

#### 3. **å»ºç«‹æµ‹è¯•å’ŒéªŒè¯æœºåˆ¶**

* **ä¸šåŠ¡è§„åˆ™è‡ªåŠ¨åŒ–éªŒè¯**ï¼šç¡®ä¿é¢†åŸŸæ¨¡å‹å’Œä¸šåŠ¡é€»è¾‘èƒ½å¤Ÿé€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•è¿›è¡ŒéªŒè¯ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å•å…ƒæµ‹è¯•æ¥ç¡®ä¿é¢†åŸŸæ¨¡å‹çš„è¡Œä¸ºç¬¦åˆä¸šåŠ¡è§„åˆ™ï¼Œä½¿ç”¨é›†æˆæµ‹è¯•æ¥ç¡®ä¿æ•´ä½“çš„ä¸šåŠ¡æµç¨‹æœ‰æ•ˆè¿è¡Œã€‚
* **ç”¨ä¾‹é©±åŠ¨å¼€å‘**ï¼šåœ¨ä¸šåŠ¡éœ€æ±‚å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥é€šè¿‡é‡æ–°æ¢³ç†ç”¨ä¾‹ï¼Œæ¥éªŒè¯é¢†åŸŸæ¨¡å‹çš„æ­£ç¡®æ€§ã€‚é€šè¿‡ç”¨ä¾‹æ¥ç¡®ä¿æ¨¡å‹ä»ç„¶èƒ½å¤Ÿè¦†ç›–æ‰€æœ‰ä¸šåŠ¡æµç¨‹ï¼Œå¹¶ä¸”æ²¡æœ‰é—æ¼æ–°çš„éœ€æ±‚æˆ–çº¦æŸã€‚

#### 4. **æ¨¡å—åŒ–å’Œè§£è€¦**

* **åˆç†åˆ’åˆ†è¾¹ç•Œä¸Šä¸‹æ–‡ï¼ˆBounded Contextï¼‰**ï¼šéšç€ä¸šåŠ¡éœ€æ±‚çš„å¢åŠ ï¼Œæ–°çš„åŠŸèƒ½æ¨¡å—å¾€å¾€éœ€è¦å’Œç°æœ‰æ¨¡å—è¿›è¡Œé›†æˆã€‚æ­¤æ—¶ï¼Œå¯ä»¥é€šè¿‡æ¸…æ™°åˆ’åˆ†é¢†åŸŸæ¨¡å‹çš„è¾¹ç•Œä¸Šä¸‹æ–‡ï¼Œé¿å…ä¸åŒå­ç³»ç»Ÿä¹‹é—´çš„è¿‡åº¦è€¦åˆå’Œå¤æ‚ä¾èµ–ã€‚æ¯ä¸ªè¾¹ç•Œä¸Šä¸‹æ–‡åº”å½“å…·æœ‰ç‹¬ç«‹çš„é¢†åŸŸæ¨¡å‹ï¼Œå‡å°‘è·¨é¢†åŸŸæ¨¡å‹çš„å˜åŒ–å½±å“ã€‚
* **é¢†åŸŸæœåŠ¡ä¸åº”ç”¨æœåŠ¡è§£è€¦**ï¼šç¡®ä¿åº”ç”¨æœåŠ¡å’Œé¢†åŸŸæ¨¡å‹ä¹‹é—´çš„è§£è€¦ã€‚åº”ç”¨æœåŠ¡ä¸»è¦å…³æ³¨ä¸šåŠ¡æµç¨‹çš„åè°ƒå’Œäº‹åŠ¡æ§åˆ¶ï¼Œè€Œé¢†åŸŸæ¨¡å‹åˆ™é›†ä¸­ç²¾åŠ›å¤„ç†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€‚é€šè¿‡å°†é¢†åŸŸæ¨¡å‹å’Œåº”ç”¨æœåŠ¡åˆ†ç¦»ï¼Œå¯ä»¥åœ¨å¼•å…¥æ–°éœ€æ±‚æ—¶ï¼Œé¿å…ç›´æ¥å½±å“æ ¸å¿ƒä¸šåŠ¡æ¨¡å‹çš„è®¾è®¡ã€‚

#### 5. **ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆEDAï¼‰åº”å¯¹å¤æ‚ä¸šåŠ¡**

* **äº‹ä»¶æºï¼ˆEvent Sourcingï¼‰ä¸CQRS**ï¼šäº‹ä»¶é©±åŠ¨æ¶æ„å’Œå‘½ä»¤æŸ¥è¯¢è´£ä»»åˆ†ç¦»ï¼ˆCQRSï¼‰å¯ä»¥å¸®åŠ©ç®¡ç†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å’Œæ¨¡å‹çš„å˜åŒ–ã€‚å½“ä¸šåŠ¡éœ€æ±‚å¤æ‚ä¸”å˜åŒ–é¢‘ç¹æ—¶ï¼ŒCQRSå¯ä»¥å°†è¯»æ“ä½œä¸å†™æ“ä½œåˆ†ç¦»ï¼Œä¼˜åŒ–æŸ¥è¯¢çš„æ€§èƒ½ï¼Œè€Œäº‹ä»¶æºåˆ™å¯ä»¥æä¾›ä¸šåŠ¡çŠ¶æ€çš„å†å²è¿½æº¯ï¼Œæœ‰åŠ©äºä¿è¯ä¸šåŠ¡æ¨¡å‹çš„æŒç»­ä¸€è‡´æ€§ã€‚
* **é¢†åŸŸäº‹ä»¶ä¸é›†æˆäº‹ä»¶**ï¼šéšç€ä¸šåŠ¡éœ€æ±‚çš„å˜åŒ–ï¼Œå¯ä»¥å®šä¹‰æ–°çš„é¢†åŸŸäº‹ä»¶ï¼Œå¹¶é€šè¿‡æ¶ˆæ¯æ€»çº¿ï¼ˆä¾‹å¦‚Kafkaã€RabbitMQç­‰ï¼‰è¿›è¡Œäº‹ä»¶çš„å‘å¸ƒå’Œè®¢é˜…ã€‚è¿™ç§æ–¹å¼ä½¿å¾—ä¸šåŠ¡æ¨¡å‹å¯ä»¥æ›´çµæ´»åœ°é€‚åº”ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚ã€‚

#### 6. **ä¿æŒæ¨¡å‹çš„é«˜å†…èšå’Œä½è€¦åˆ**

* **å†…èšæ€§é«˜ã€è€¦åˆåº¦ä½çš„è®¾è®¡**ï¼šåœ¨é¢å¯¹æ–°éœ€æ±‚æ—¶ï¼Œå°½é‡ä¿æŒæ¨¡å‹çš„é«˜å†…èšæ€§ï¼Œç¡®ä¿æ¯ä¸ªæ¨¡å—åªè´Ÿè´£ç‰¹å®šçš„é¢†åŸŸèŒèƒ½ã€‚åŒæ—¶ï¼Œé¿å…è¿‡åº¦è€¦åˆå…¶ä»–é¢†åŸŸçš„æ¨¡å‹ï¼Œä½¿å¾—æ–°çš„ä¸šåŠ¡éœ€æ±‚å¯ä»¥ç‹¬ç«‹åœ°åŠ å…¥ï¼Œè€Œä¸å½±å“å·²æœ‰çš„ä¸šåŠ¡é€»è¾‘ã€‚
* **é¢†åŸŸé©±åŠ¨çš„è®¾è®¡åŸåˆ™**ï¼šå°½é‡éµå¾ªDDDçš„è®¾è®¡åŸåˆ™ï¼Œå¦‚èšåˆæ ¹ã€å®ä½“ã€å€¼å¯¹è±¡ç­‰çš„æ­£ç¡®ä½¿ç”¨ï¼Œé¿å…æ¨¡å‹è®¾è®¡ä¸­å‡ºç°ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚

#### 7. **é‡è§†æŠ€æœ¯ä¸å·¥å…·çš„æ”¯æŒ**

* **æ”¯æŒé¢†åŸŸå»ºæ¨¡çš„å·¥å…·**ï¼šä½¿ç”¨UMLã€äº‹ä»¶å»ºæ¨¡ã€é¢†åŸŸå»ºæ¨¡å·¥å…·ç­‰ï¼Œå¸®åŠ©å›¢é˜Ÿåœ¨é¢å¯¹æ–°éœ€æ±‚æ—¶ï¼Œèƒ½å¤Ÿæ¸…æ™°åœ°è¡¨è¾¾å’Œè°ƒæ•´é¢†åŸŸæ¨¡å‹ã€‚é€šè¿‡è¿™äº›å·¥å…·ï¼Œå¯ä»¥å‡å°‘æ¨¡å‹å¤æ‚åº¦ï¼Œå¸®åŠ©å¼€å‘äººå‘˜æ›´å¥½åœ°ç†è§£å’Œå®ç°é¢†åŸŸæ¨¡å‹ã€‚
* **æ–‡æ¡£ä¸æ¨¡å‹å…±äº«**ï¼šä¿æŒé¢†åŸŸæ¨¡å‹æ–‡æ¡£çš„å®æ—¶æ›´æ–°å’Œå…±äº«ã€‚æ— è®ºæ˜¯ä¸šåŠ¡å›¢é˜Ÿè¿˜æ˜¯å¼€å‘å›¢é˜Ÿï¼Œå¤§å®¶éœ€è¦å¯¹é¢†åŸŸæ¨¡å‹æœ‰å…±åŒçš„ç†è§£ã€‚éšç€æ–°éœ€æ±‚çš„åŠ å…¥ï¼Œè¦ç¡®ä¿æ–‡æ¡£èƒ½å¤ŸåŠæ—¶åæ˜ å‡ºæœ€æ–°çš„æ¨¡å‹å˜åŒ–ã€‚

#### 8. **å›¢é˜Ÿæ–‡åŒ–å’ŒæŒç»­å­¦ä¹ **

* **é¼“åŠ±é¢†åŸŸå»ºæ¨¡çš„æŒç»­å­¦ä¹ **ï¼šä¸šåŠ¡æ¨¡å‹çš„â€œä¿é²œâ€ä¸ä»…ä»…æ˜¯æŠ€æœ¯ä¸Šçš„é—®é¢˜ï¼Œè¿˜ä¸å›¢é˜Ÿçš„æ–‡åŒ–å’Œå®è·µæ¯æ¯ç›¸å…³ã€‚é¼“åŠ±å›¢é˜Ÿæˆå‘˜å‚ä¸é¢†åŸŸå»ºæ¨¡çš„åŸ¹è®­ï¼Œåˆ†äº«å®è·µç»éªŒï¼Œå®šæœŸè¿›è¡Œé¢†åŸŸå»ºæ¨¡çš„å¤ç›˜ï¼Œèƒ½å¤Ÿä¸æ–­æé«˜å›¢é˜Ÿå¯¹ä¸šåŠ¡éœ€æ±‚çš„æ•æ„Ÿæ€§å’Œå¯¹æ¨¡å‹çš„ç†è§£ã€‚
* **åæ€ä¸è°ƒæ•´**ï¼šåœ¨é¡¹ç›®å®æ–½çš„è¿‡ç¨‹ä¸­ï¼Œå®šæœŸè¿›è¡Œå›é¡¾ï¼Œåæ€å½“å‰çš„æ¨¡å‹è®¾è®¡æ˜¯å¦æœ‰æ•ˆï¼Œæ˜¯å¦ç¬¦åˆä¸šåŠ¡éœ€æ±‚ã€‚é€šè¿‡æŒç»­çš„åæ€å’Œè°ƒæ•´ï¼Œç¡®ä¿æ¨¡å‹çš„å¥åº·ã€‚

#### æ€»ç»“ï¼š

è¦ä¿æŒDDDå››å±‚ä¸šåŠ¡æ¨¡å‹çš„â€œä¿é²œâ€ï¼Œéœ€è¦å…³æ³¨é¢†åŸŸæ¨¡å‹çš„æŒç»­æ¼”åŒ–ä¸ä¸šåŠ¡éœ€æ±‚çš„ç´§å¯†å¯¹æ¥ï¼Œä¿æŒæ¨¡å‹çš„çµæ´»æ€§å’Œç®€æ´æ€§ï¼Œå¹¶é€šè¿‡åˆé€‚çš„æ¶æ„å’ŒæŠ€æœ¯æ‰‹æ®µæ”¯æŒä¸šåŠ¡æ¨¡å‹çš„å˜åŒ–ã€‚åŒæ—¶ï¼Œå›¢é˜Ÿå†…éƒ¨çš„æ²Ÿé€šã€åä½œå’ŒæŒç»­å­¦ä¹ ä¹Ÿæ˜¯ç¡®ä¿é¢†åŸŸæ¨¡å‹èƒ½å¤Ÿéšç€ä¸šåŠ¡å‘å±•è€Œä¸æ–­ä¼˜åŒ–çš„å…³é”®ã€‚


## ä¸šåŠ¡å»ºæ¨¡
### æ¦‚å¿µå®šä¹‰
#### ä¸šåŠ¡å»ºæ¨¡ç›®æ ‡
ä¸šåŠ¡å»ºæ¨¡çš„ç›®æ ‡æ˜¯å®ç°ä¸šåŠ¡éœ€æ±‚çš„ç»“æ„åŒ–æè¿°ï¼Œè¾“å‡ºç”¨æˆ·æ•…äº‹åœ°å›¾ã€é¢†åŸŸå¯¹è±¡åŠä¸šåŠ¡æ¨¡å—ã€‚

#### ä¸šåŠ¡å»ºæ¨¡çš„æµç¨‹
ç®€å•åº”ç”¨æ¶æ„ï¼š
1) æ¢³ç†éœ€æ±‚ï¼šæ¢³ç†ç”¨æˆ·æ•…äº‹ã€è¡¥å……å‘½ä»¤ã€ç¡®è®¤éœ€æ±‚
2) è¯†åˆ«é¢†åŸŸå¯¹è±¡ï¼šè¯†åˆ«åè¯ã€åˆ†é…ä¸šåŠ¡çŸ¥è¯†åˆ°é¢†åŸŸå¯¹è±¡
3) åˆ’åˆ†æ¨¡å—ï¼šå»ºç«‹å…³è”å…³ç³»ã€æ¨¡å—åŒ–

å¤æ‚åº”ç”¨æ¶æ„ï¼š
1) æ¢³ç†éœ€æ±‚ï¼šæ¢³ç†ç”¨æˆ·æ•…äº‹åœ°å›¾ã€ç¡®è®¤éœ€æ±‚
2) è¯†åˆ«é¢†åŸŸå¯¹è±¡ï¼šäº‹ä»¶é£æš´ã€è¯†åˆ«åè¯ã€åˆ†é…ä¸šåŠ¡çŸ¥è¯†åˆ°é¢†åŸŸå¯¹è±¡
3) åˆ’åˆ†æ¨¡å—ï¼šå»ºç«‹å…³è”å…³ç³»ã€æ ¹æ®å…³è”å…³ç³»åˆ’åˆ†æ¨¡å—
4) åˆ’åˆ†èšåˆï¼šæ ¹æ®ä¸šåŠ¡å¼ºä¸€è‡´æ€§åˆ’åˆ†æ¨¡å—ï¼ˆå¯é€‰ï¼‰

#### ç”¨æˆ·æ•…äº‹åŠç”¨æˆ·æ•…äº‹åœ°å›¾
#### ç”¨æˆ·æ•…äº‹ï¼ˆUser Storyï¼‰
ç”¨æˆ·æ•…äº‹æ˜¯è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ç”¨ç¬¦åˆç‰¹å®šæ ¼å¼ï¼ˆæˆ–è€…ç§°ç»“æ„åŒ–ï¼‰çš„è‡ªç„¶è¯­è¨€æè¿°ä¸šåŠ¡éœ€æ±‚çš„å¸¸ç”¨æ–¹å¼ã€‚ç”¨æˆ·æ•…äº‹å†…å®¹é€šå¸¸åŒ…æ‹¬â€œè§’è‰²(who)â€ã€â€œç”¨æˆ·æ‰§è¡Œçš„åŠ¨ä½œ(what)â€ä»¥åŠâ€œä»·å€¼(why)â€ï¼Œå¦‚æœä»·å€¼æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œæˆ–è€…æ²¡æœ‰é‚£ä¹ˆé‡è¦ï¼Œä¹Ÿå¯ä»¥ä¸å†™ã€‚

##### ç”¨æˆ·æ•…äº‹åœ°å›¾ï¼ˆUser Story Mappingï¼‰

æŒ‰ç…§æ—¶é—´çº¿ï¼Œå°†å¤šä¸ªç”¨æˆ·æ•…äº‹ä¸²èµ·æ¥ç»„æˆçš„ä¸šåŠ¡å…¨æ™¯å›¾ï¼Œå³ç”¨æˆ·æ•…äº‹åœ°å›¾ã€‚ç”¨æˆ·æ•…äº‹åœ°å›¾åŒ…å«ä»¥ä¸‹6è¦ç´ ï¼Œå®è·µè¿‡ç¨‹ä¸­åº”ä½¿ç”¨ä¸åŒçš„å¡ç‰‡åŒºåˆ†ï¼š

- è§’è‰²ï¼ˆRoleï¼‰ï¼šå°†ç”¨æˆ·æ•…äº‹é‡Œçš„"who"å•ç‹¬æŠ½å‡ºæ¥ï¼Œç”¨æˆ·æ•…äº‹åœ°å›¾æ›´æ¸…æ™°ã€‚è§’è‰²æ˜¯æ•…äº‹çš„å‘èµ·æ–¹ï¼Œå¯ä»¥æ˜¯äººï¼Œä¹Ÿå¯ä»¥æ˜¯å¤–éƒ¨ç³»ç»Ÿã€‚
- ä¸»çº¿ï¼ˆBackboneï¼‰ï¼šé¢†åŸŸæˆ–åœºæ™¯çš„ä¸»çº¿ï¼Œä¸€èˆ¬æ˜¯ä»å·¦å¾€å³çš„æ—¶é—´è½´ã€‚
- æ´»åŠ¨ï¼ˆActivityï¼‰ï¼šè¡¨ç¤ºç”¨æˆ·æ•…äº‹åœ°å›¾çš„ä¸»å¹²ï¼Œç”¨äºç»„ç»‡å…³è”æ€§å¼ºçš„ä»»åŠ¡ã€‚é€šå¸¸ä»¥åŠ¨è¯çŸ­è¯­çš„å½¢å¼ï¼Œå¹¶ä½¿å…¶è¶³ä»¥æ¶µç›–æ‰€æœ‰ç±»ä¼¼ä»»åŠ¡è¦è¡¨è¾¾çš„æ„æ€ã€‚
- ä»»åŠ¡ï¼ˆTaskï¼‰ï¼šè¿™é‡Œé‡ç‚¹è®°å½•ç”¨æˆ·æ•…äº‹é‡Œçš„"what"ã€‚å¦‚æœç”¨æˆ·æ•…äº‹é‡Œçš„"why"å¾ˆå…³é”®ï¼Œå¯¹ç†è§£ä¸šåŠ¡éœ€æ±‚æœ‰é‡å¤§æ„ä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨ä»»åŠ¡é‡Œå†™å‡ºæ¥ã€‚
- å‘½ä»¤ï¼ˆCommandï¼‰ï¼šå‘½ä»¤æ˜¯ä»»åŠ¡çš„ç»†åŒ–ã€‚æ ¹æ®ç³»ç»Ÿå»ºè®¾çš„è§’åº¦ï¼ŒæŒ‰ç…§æ—¶åºå…ˆåé€»è¾‘å¯¹ä»»åŠ¡è¿›è¡Œæ‹†åˆ†ã€ç»†åŒ–ï¼Œè¦æ±‚ä½¿ç”¨â€œåŠ¨è¯+åè¯â€çš„å½¢å¼ã€‚å¯¹äºä¸šåŠ¡é€»è¾‘ç®€å•çš„ä»»åŠ¡ï¼Œå¯ä»¥ä¸è¯†åˆ«å‘½ä»¤ã€‚
- è§„åˆ™ï¼ˆRuleï¼‰ï¼šæ‹†åˆ†ä»»åŠ¡æ—¶ï¼Œå…³é”®å‘½ä»¤å¯¹åº”çš„è§„åˆ™ï¼ˆæ¯”å¦‚å…·ä½“çš„æ ¡éªŒã€åˆ¤æ–­ç­‰é€»è¾‘ï¼‰ä¹Ÿåº”è¯¥è®°å½•ä¸‹æ¥ã€‚

#### é¢†åŸŸå¯¹è±¡è¯†åˆ«æµç¨‹
ä»¥ç”¨æˆ·æ•…äº‹åœ°å›¾ä¸ºåŸºç¡€ï¼Œè¯†åˆ«æˆ–æŠ½è±¡ä¸ä»»åŠ¡æˆ–å‘½ä»¤æœ€ç›¸å…³æˆ–éšå«çš„ä¸šåŠ¡æ¦‚å¿µï¼Œå³é¢†åŸŸå¯¹è±¡ã€‚å°†ç”¨æˆ·æ•…äº‹åœ°å›¾ä¸­çš„å‘½ä»¤åˆ†é…åˆ°å¯¹åº”é¢†åŸŸå¯¹è±¡ï¼Œè¿›ä¸€æ­¥ç»“æ„åŒ–ä¸šåŠ¡éœ€æ±‚ã€‚å…·ä½“æµç¨‹ï¼š

ï¼ˆ1) é€šå¸¸é¢†åŸŸå¯¹è±¡æ˜¯å‘½ä»¤ä¸­çš„åè¯ï¼Œå¯æ ¹æ®å‘½ä»¤â€œåŠ¨è¯+åè¯â€çš„å½¢å¼ç›´æ¥æŠ½å–ã€‚æ ¹æ®å‘½ä»¤è¯†åˆ«é¢†åŸŸåè¯åï¼Œåº”è¿›ä¸€æ­¥åˆ†æå“ªäº›é¢†åŸŸåè¯å±äºé¢†åŸŸå¯¹è±¡ã€å“ªäº›å±äºé¢†åŸŸå¯¹è±¡çš„å±æ€§ã€‚æ¯”å¦‚â€œé”å®šè®¢å•çŠ¶æ€â€ä¸­çš„â€œè®¢å•çŠ¶æ€â€æ˜¯åè¯ï¼Œä½†æ˜¯â€œè®¢å•çŠ¶æ€â€æ˜¯â€œè®¢å•â€çš„ä¸€ä¸ªå±æ€§ï¼Œå› æ­¤è¿™é‡Œè¯†åˆ«çš„é¢†åŸŸå¯¹è±¡åº”è¯¥æ˜¯â€œè®¢å•â€ã€‚

ï¼ˆ2ï¼‰æ£€æŸ¥é¢†åŸŸå¯¹è±¡ã€å‘½ä»¤åœ¨ä¸šåŠ¡æ¦‚å¿µï¼ˆåŒ…æ‹¬ä¸šåŠ¡å±æ€§ã€ä¸šåŠ¡å«ä¹‰ç­‰ï¼‰ä¸Šçš„ä¸€è‡´æ€§ï¼Œé’ˆå¯¹å…·æœ‰ç›¸åŒä¸šåŠ¡æ¦‚å¿µçš„é¢†åŸŸå¯¹è±¡ã€å‘½ä»¤è¦é‡‡ç”¨ç»Ÿä¸€æœ¯è¯­ï¼Œæ¶ˆé™¤äºŒä¹‰æ€§ã€‚

ï¼ˆ3ï¼‰å›´ç»•é¢†åŸŸå¯¹è±¡ï¼Œè´´å‡ºç›¸å…³å‘½ä»¤åŠå…¶ä»–ç›¸å…³äº§å‡ºï¼Œåˆ’åˆ†èŒè´£è¾¹ç•Œã€‚

ï¼ˆ4ï¼‰å¦‚æœåœ¨è®¨è®ºè¿‡ç¨‹ä¸­ï¼Œæœ‰ä»»ä½•å› ä¸ºé—®é¢˜æ¾„æ¸…æˆ–çŸ¥è¯†å¢é•¿å¸¦æ¥çš„å¯¹äºä¹‹å‰å„ç§äº§å‡ºç‰©çš„å…±è¯†æ€§è°ƒæ•´ï¼Œåº”åŠæ—¶è¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–ã€‚

#### åˆ’åˆ†æ¨¡å—æµç¨‹
æ ¹æ®é¢†åŸŸå¯¹è±¡çš„å…³ç³»åˆ’åˆ†æ¨¡å—ã€‚è¯¦ç»†æµç¨‹å¦‚ä¸‹ï¼š

ï¼ˆ1ï¼‰ç”»å‡ºæ‰€æœ‰é¢†åŸŸå¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚èšåˆã€ç»„åˆã€å…³è”ã€ä¾èµ–ç­‰å…³ç³»ã€‚

ï¼ˆ2ï¼‰æ ¹æ®é¢†åŸŸå¯¹è±¡é—´å…³ç³»çš„ç´§å¯†ç¨‹åº¦ï¼Œç»“åˆé¢†åŸŸå¯¹è±¡çš„ä¸šåŠ¡ç›¸å…³æ€§åˆ’åˆ†æ¨¡å—ã€‚

#### é¢†åŸŸå¯¹è±¡ä¹‹é—´çš„å…³ç³»
| å…³ç³»ç±»å‹ | è¯´æ˜                                                                            |
|------|-------------------------------------------------------------------------------|
| å…³è”   | ä¸€ç§ç»“æ„åŒ–å…³ç³»ï¼Œç”¨äºè¡¨ç¤ºä¸€ç±»å¯¹è±¡ä¸å¦ä¸€ç±»å¯¹è±¡ä¹‹é—´æœ‰è”ç³»ã€‚å…³è”å…³ç³»ä¸€èˆ¬è¡¨ç¤ºéèšåˆã€ç»„åˆçš„å…¶å®ƒå…³è”å…³ç³»ï¼Œå¦‚å¸ˆå‚…å’Œå¾’å¼Ÿã€‚                     |
| èšåˆ   | è¡¨ç¤ºæ•´ä½“ä¸éƒ¨åˆ†çš„å…³è”å…³ç³»ï¼Œä½†æ˜¯æˆå‘˜å¯¹è±¡å¯ä»¥è„±ç¦»æ•´ä½“å¯¹è±¡ç‹¬ç«‹å­˜åœ¨ã€‚å¦‚ï¼šæ±½è½¦å’Œå‘åŠ¨æœºã€‚                                     |
| ç»„åˆ   | è¡¨ç¤ºæ•´ä½“ä¸éƒ¨åˆ†çš„å…³è”å…³ç³»ï¼Œä¸”ä¸€æ—¦æ•´ä½“å¯¹è±¡ä¸å­˜åœ¨ï¼Œæˆå‘˜å¯¹è±¡ä¹Ÿä¸å¤å­˜åœ¨ï¼Œå¦‚ï¼šäººçš„å¤´å’Œå˜´å·´ã€‚                                   |
| ä¾èµ–   | è¡¨ç¤ºä½¿ç”¨å…³ç³»ã€‚ä¾èµ–å…³ç³»è¡¨ç¤ºä¸€ä¸ªç±»ä½¿ç”¨äº†å¦ä¸€ä¸ªç±»çš„æŸäº›åŠŸèƒ½ï¼Œä½†å½¼æ­¤ä¹‹é—´å¹¶æ²¡æœ‰è¾ƒå¼ºçš„è€¦åˆæ€§ã€‚è¿™ç§å…³ç³»æ˜¯ä¸€ç§çŸ­æœŸçš„ã€ä¸´æ—¶çš„è¿æ¥ï¼Œå¦‚ï¼šæ•™å¸ˆå’Œä»–ä¸Šè¯¾æ—¶ä½¿ç”¨çš„æŠ•å½±ä»ªã€‚ |
| æ³›åŒ–   | å³ç»§æ‰¿å…³ç³»ã€‚å¦‚æ•™å¸ˆã€å­¦ç”Ÿå‡å¯æ³›åŒ–ä¸ºäººã€‚                                                           


#### å®ä½“åˆ†é…å±æ€§

è®¾è®¡å®ä½“çš„å±æ€§æ—¶ï¼Œå¯å‚è€ƒä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š

- é€šè¿‡å¯¹ä¸šåŠ¡äººå‘˜è¿›è¡Œè®¿è°ˆï¼Œä»ä¸šåŠ¡çŸ¥è¯†ä¸­è·å–å®ä½“çš„å±æ€§ã€‚
- å‚è€ƒç›¸å…³ç³»ç»Ÿæˆ–éœ€æ±‚ï¼Œè·å–å®ä½“å±æ€§ã€‚æ­¤æ–¹æ³•è·å–åˆ°çš„å±æ€§éœ€ä¸ä¸šåŠ¡äººå‘˜ç¡®è®¤ã€‚
- æ ¹æ®å¼€å‘ç»éªŒè¯†åˆ«å‡ºä¸€äº›æŠ€æœ¯æ”¯æ’‘ç±»çš„å®ä½“å±æ€§ï¼Œå¦‚ä¿®æ”¹äººã€ä¿®æ”¹æ—¶é—´ç­‰ã€‚

#### å®ä½“ã€é¢†åŸŸæœåŠ¡åˆ†é…æ–¹æ³•

æ ¹æ®ä¸šåŠ¡å»ºæ¨¡é˜¶æ®µè¯†åˆ«å‡ºæ¥çš„å‘½ä»¤è¯†åˆ«æ–¹æ³•ã€‚å…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š

- å¦‚æœå‘½ä»¤ä»…æ¶‰åŠä¸€ä¸ªå®ä½“ï¼Œå¯è€ƒè™‘å°†è¯¥å‘½ä»¤è½¬åŒ–ä¸ºè¯¥å®ä½“çš„æ–¹æ³•ã€‚ä½†è¯†åˆ«å‡ºçš„å‘½ä»¤ä¸€èˆ¬æ¥è¯´æ˜¯è¶…å‡ºå®ä½“èŒè´£èŒƒå›´çš„ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥å°†æ‰€æœ‰å‘½ä»¤æ˜ å°„ä¸ºå®ä½“æ–¹æ³•ã€‚å®ä½“çš„æ–¹æ³•é€šå¸¸ä»…éœ€æ“ä½œæœ¬å®ä½“çš„å±æ€§ï¼Œä¸åŒ…å«CRUDã€‚
- å¦‚æœå‘½ä»¤æ¶‰åŠæ¨¡å—å†…çš„å¤šä¸ªå®ä½“ï¼Œå¯å…ˆè€ƒè™‘æ‰¾åˆ°æŸä¸ªå®ä½“æ‰¿è½½ï¼Œå¦‚æœè¯¥æ–¹å¼ä¼šç ´åè¯¥å®ä½“çš„â€œé«˜å†…èšã€ä½è€¦åˆâ€æˆ–SOLIDåŸåˆ™ï¼Œåˆ™å¯è€ƒè™‘å°†è¯¥å‘½ä»¤è½¬åŒ–ä¸ºé¢†åŸŸæœåŠ¡çš„æ–¹æ³•ã€‚
- å¦‚æœå‘½ä»¤æ¶‰åŠè·¨æ¨¡å—ã€è·¨å¾®æœåŠ¡çš„å¤šä¸ªå®ä½“ï¼Œåˆ™å°†è¯¥å‘½ä»¤è½¬åŒ–ä¸ºåº”ç”¨æœåŠ¡çš„æ–¹æ³•ã€‚
>ã€å»ºè®®ã€‘ä¸æ¨èä½¿ç”¨é¢†åŸŸæœåŠ¡ï¼Œä¼˜å…ˆè€ƒè™‘å®ä½“è¡Œä¸ºå’Œåº”ç”¨æœåŠ¡ï¼Œé¢†åŸŸæœåŠ¡ä½œä¸ºæœ€åæŠ˜è¡·è€ƒè™‘ã€‚ éœ€æŠ˜è¡·è€ƒè™‘çš„æƒ…å†µï¼šæ¶‰åŠå¤šå®ä½“çš„äº‹åŠ¡ä¸€è‡´æ€§é€»è¾‘ï¼Œä¸”å±äºé‡è¦ä¸šåŠ¡æ¦‚å¿µï¼ˆä¹Ÿå°±æ˜¯ä¸ä¸šåŠ¡èŠéœ€æ±‚ï¼Œç»å¸¸ä¼šæåŠï¼‰ã€‚

> å®é™…è®¾è®¡ä¸­ï¼Œå¹¶ä¸è¿½æ±‚ä¸€å¼€å§‹å°±æŠŠå®ä½“çš„å±æ€§å’Œæ–¹æ³•å®Œå…¨è¯†åˆ«å‡ºæ¥ï¼Œå®ç°å®Œå…¨å……è¡€ã€‚åœ¨ç¨‹åºæ¼”è¿›è¿‡ç¨‹ä¸­ï¼Œå¯è¯†åˆ«å…·æœ‰ä¸šåŠ¡è¯­æ„ã€å¯å¤ç”¨ã€é›†ä¸­åœ¨æŸä¸ªå®ä½“ä¸Šçš„æ“ä½œæˆ–è¡Œä¸ºï¼Œå¯å°†å®ƒä»¬æ²‰æ·€ä¸ºå®ä½“çš„æ–¹æ³•ï¼Œé€æ­¥å……è¡€ã€‚å®ä½“çš„å±æ€§åœ¨ç¨‹åºæ¼”è¿›è¿‡ç¨‹ä¸­ä¹Ÿå¯æŒ‰éœ€è¡¥å……ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæ‰€æœ‰æ²‰æ·€åˆ°å®ä½“ä¸Šçš„æ“ä½œéƒ½æ˜¯æœ‰æ”¶ç›Šçš„ï¼Œèƒ½å¤Ÿåœ¨å®ä½“ä¸­å†…èšä¸šåŠ¡é€»è¾‘ï¼Œæ˜¾æ€§åŒ–åœ°è¡¨è¾¾ä¸šåŠ¡è¯­ä¹‰ã€‚ä¸šåŠ¡çŸ¥è¯†å¾—åˆ°äº†å°Šé‡å’Œè¡¨è¾¾ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„"Knowledge Rich Design"ã€‚


#### å®ä½“å’Œå€¼å¯¹è±¡
**å®ä½“(Entity)**: é¢†åŸŸå¯¹è±¡æ‰¿è½½äº†æ˜æ˜¾çš„ä¸šåŠ¡è¡Œä¸ºï¼ˆæ¯”å¦‚æ ¡éªŒã€å®¡æ‰¹ç­‰ï¼‰å’Œä¸šåŠ¡å±æ€§ï¼Œåˆ™å¯æ˜ å°„ä¸ºå®ä½“ã€‚  
**å€¼å¯¹è±¡(Value Object):** é¢†åŸŸå¯¹è±¡æœ‰ä¸šåŠ¡å±æ€§ï¼Œæ— ä¸šåŠ¡è¡Œä¸ºæˆ–è€…æœ‰å°‘é‡ä¸šåŠ¡è¡Œä¸ºï¼Œä¸”åœ¨æ•´ä¸ªä¸šåŠ¡çš„ç”Ÿå‘½å‘¨æœŸä¸­ä¸å¯å˜ï¼Œåˆ™å¯æ˜ å°„ä¸ºå€¼å¯¹è±¡ã€‚

å¸¸è§è¯†åˆ«ä¸ºå®ä½“çš„æµç¨‹ï¼š 
- æ˜¯å¦å…·å¤‡å”¯ä¸€æ ‡è¯†ï¼šå®ä½“å¿…é¡»å…·å¤‡å”¯ä¸€æ ‡è¯†ï¼Œä½†æ˜¯å…·å¤‡å”¯ä¸€æ ‡è¯†çš„ä¸ä¸€å®šå®ä½“
- åˆ¤æ–­é¢†åŸŸå¯¹è±¡æ˜¯å¦å¯å˜ï¼šå¯å˜çš„è¯†åˆ«ä¸ºå®ä½“ï¼Œä¸å¯å˜çš„è¯†åˆ«ä¸ºå€¼å¯¹è±¡
- åˆ¤æ–­é¢†åŸŸå¯¹è±¡æ˜¯å¦å…·å¤‡ç”Ÿå‘½å‘¨æœŸï¼šå¯ä»¥è¢«åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ï¼Œè€Œå€¼å¯¹è±¡é€šå¸¸åªä½œä¸ºå®ä½“çš„å±æ€§å­˜åœ¨
- çŸ­æ—¶é—´å†…è¯†åˆ«ä¸å‡ºæ¥çš„ï¼Œä¼˜å…ˆè¯†åˆ«ä¸ºå®ä½“ï¼ˆå› ä¸ºå®ä½“è¢«é”™è¯¯è¯†åˆ«ä¸ºå€¼å¯¹è±¡æ˜¯æœ‰ä»£ä»·çš„ï¼šæ€§èƒ½æŸè€—ã€æ— æ³•é€‚åº”éœ€æ±‚è°ƒæ•´ï¼‰

> è‹¥é¢†åŸŸå¯¹è±¡æ‰¿è½½äº†æ˜æ˜¾çš„ä¸šåŠ¡è¡Œä¸ºï¼ˆæ¯”å¦‚æ ¡éªŒã€å®¡æ‰¹ç­‰ï¼‰å’Œä¸šåŠ¡å±æ€§ï¼Œåˆ™å¯æ˜ å°„ä¸ºå®ä½“ï¼›è‹¥é¢†åŸŸå¯¹è±¡æœ‰ä¸šåŠ¡å±æ€§ï¼Œæ— ä¸šåŠ¡è¡Œä¸ºæˆ–è€…æœ‰å°‘é‡ä¸šåŠ¡è¡Œä¸ºï¼Œä¸”åœ¨æ•´ä¸ªä¸šåŠ¡çš„ç”Ÿå‘½å‘¨æœŸä¸­ä¸å¯å˜ï¼Œåˆ™å¯æ˜ å°„ä¸ºå€¼å¯¹è±¡ã€‚è‹¥çŸ­æ—¶é—´å†…æ— æ³•ç¡®å®šæ˜ å°„ä¸ºå®ä½“è¿˜æ˜¯å€¼å¯¹è±¡ï¼Œå¯å…ˆç›´æ¥æ˜ å°„ä¸ºå®ä½“ã€‚

### å¦‚ä½•åŒºåˆ†ä¸šåŠ¡å»ºæ¨¡ä¸­çš„â€œä»»åŠ¡â€å’Œâ€œå‘½ä»¤â€ï¼Ÿ
åœ¨é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰å’Œä¸šåŠ¡å»ºæ¨¡ä¸­ï¼Œä»»åŠ¡ï¼ˆTaskï¼‰å’Œå‘½ä»¤ï¼ˆCommandï¼‰æ˜¯ä¸¤ç§ä¸åŒçš„æ¦‚å¿µï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š

| **ç»´åº¦**       | **ä»»åŠ¡ï¼ˆTaskï¼‰**                     | **å‘½ä»¤ï¼ˆCommandï¼‰**                 |
|---------------|------------------------------------|----------------------------------|
| **å®šä¹‰**       | ä¸€ä¸ªä¸šåŠ¡è¿‡ç¨‹ï¼Œå¯èƒ½åŒ…å«å¤šä¸ªæ­¥éª¤æˆ–å­ä»»åŠ¡ã€‚ | ä¸€ä¸ªæ˜ç¡®çš„åŠ¨ä½œï¼Œè§¦å‘æŸä¸ªä¸šåŠ¡æ“ä½œã€‚       |
| **ç²’åº¦**       | è¾ƒç²—ï¼Œé€šå¸¸æ¶‰åŠå¤šä¸ªæ­¥éª¤æˆ–å†³ç­–ã€‚         | è¾ƒç»†ï¼Œé€šå¸¸å¯¹åº”ä¸€ä¸ªåŸå­æ“ä½œã€‚           |
| **æ‰§è¡Œæ–¹å¼**   | å¯èƒ½æ¶‰åŠå¤šä¸ªå‘½ä»¤ã€äº‹ä»¶æˆ–äººå·¥å¹²é¢„ã€‚     | é€šå¸¸æ˜¯è‡ªåŠ¨æ‰§è¡Œçš„å•ä¸€æ“ä½œã€‚             |
| **ä¸šåŠ¡å«ä¹‰**   | ä»£è¡¨ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡ç›®æ ‡ï¼ˆå¦‚â€œå¤„ç†è®¢å•â€ï¼‰ã€‚ | ä»£è¡¨ä¸€ä¸ªå…·ä½“çš„ä¸šåŠ¡åŠ¨ä½œï¼ˆå¦‚â€œæäº¤è®¢å•â€ï¼‰ã€‚ |
| **ç¤ºä¾‹**       | â€œå®¢æˆ·ä¸‹å•â€ä»»åŠ¡å¯èƒ½åŒ…æ‹¬ï¼š<br>1. åˆ›å»ºè®¢å•<br>2. æ‰£å‡åº“å­˜<br>3. æ”¯ä»˜å¤„ç† | â€œåˆ›å»ºè®¢å•â€å‘½ä»¤ä»…æ‰§è¡Œè®¢å•åˆ›å»ºé€»è¾‘ã€‚ |

#### æ€»ç»“
   - ä»»åŠ¡æ˜¯å®è§‚ä¸šåŠ¡æµç¨‹ï¼Œå‘½ä»¤æ˜¯å…·ä½“æ‰§è¡ŒåŠ¨ä½œã€‚
   - ä»»åŠ¡ç”±å¤šä¸ªå‘½ä»¤ç»„æˆï¼Œå‘½ä»¤æ˜¯æœ€å°æ‰§è¡Œå•å…ƒã€‚
---

### å¦‚ä½•åˆ¤æ–­ä»»åŠ¡çš„æœ€å°åŒ–ï¼Ÿ
ä»»åŠ¡çš„æœ€å°åŒ–ï¼ˆTask Granularityï¼‰æ˜¯æŒ‡**å°†ä»»åŠ¡æ‹†è§£åˆ°ä¸å¯å†åˆ†çš„ä¸šåŠ¡å•å…ƒ**ï¼Œç¡®ä¿æ¯ä¸ªä»»åŠ¡ï¼š
1. **èŒè´£å•ä¸€**ï¼šåªåšä¸€ä»¶äº‹ï¼ˆå¦‚â€œæ‰£å‡åº“å­˜â€è€Œéâ€œå¤„ç†è®¢å•â€ï¼‰ã€‚
2. **å¯ç‹¬ç«‹æ‰§è¡Œ**ï¼šä¸ä¾èµ–å…¶ä»–ä»»åŠ¡çš„ä¸­é—´çŠ¶æ€ã€‚
3. **å¯ç»„åˆ**ï¼šå¤šä¸ªæœ€å°ä»»åŠ¡å¯ä»¥ç»„åˆæˆæ›´å¤§çš„ä¸šåŠ¡æµç¨‹ï¼ˆå¦‚â€œä¸‹å•â€=â€œåˆ›å»ºè®¢å•â€+â€œæ‰£åº“å­˜â€+â€œæ”¯ä»˜â€ï¼‰ã€‚

#### åˆ¤æ–­æ ‡å‡†
1. **èƒ½å¦å†æ‹†è§£ï¼Ÿ**
   - å¦‚æœèƒ½æ‹†æˆæ›´å°çš„æ­¥éª¤ï¼Œåˆ™å½“å‰ä»»åŠ¡ä¸æ˜¯æœ€å°åŒ–ã€‚
   - ä¾‹å¦‚ï¼šâ€œå¤„ç†è®¢å•â€å¯æ‹†è§£â†’éæœ€å°ï¼›â€œæ‰£å‡åº“å­˜â€ä¸å¯æ‹†è§£â†’æœ€å°ã€‚

2. **æ˜¯å¦ä¾èµ–å…¶ä»–ä»»åŠ¡çš„çŠ¶æ€ï¼Ÿ**
   - æœ€å°ä»»åŠ¡åº”èƒ½ç‹¬ç«‹æ‰§è¡Œï¼Œä¸ä¾èµ–å…¶ä»–ä»»åŠ¡çš„ä¸­é—´ç»“æœã€‚
   - ä¾‹å¦‚ï¼šâ€œæ”¯ä»˜è®¢å•â€ä¾èµ–â€œè®¢å•å·²åˆ›å»ºâ€â†’éœ€ç»„åˆä¸ºæ›´é«˜å±‚ä»»åŠ¡ã€‚

3. **ä¸šåŠ¡æ˜¯å¦è®¤å¯å…¶åŸå­æ€§ï¼Ÿ**
   - ä»ä¸šåŠ¡è§†è§’çœ‹ï¼Œè¯¥æ­¥éª¤æ˜¯å¦ä¸å¯å†åˆ†ï¼Ÿ
   - ä¾‹å¦‚ï¼šè´¢åŠ¡ç³»ç»Ÿä¸­çš„â€œè®°è´¦â€æ˜¯æœ€å°ä»»åŠ¡ï¼Œè€Œâ€œç”Ÿæˆè´¢æŠ¥â€ä¸æ˜¯ï¼ˆå¯æ‹†è§£ä¸ºå¤šä¸ªè®°è´¦æ“ä½œï¼‰ã€‚

#### ç¤ºä¾‹
- **éæœ€å°ä»»åŠ¡**ï¼š`å®Œæˆç”µå•†è®¢å•`ï¼ˆå¯æ‹†è§£ä¸ºåˆ›å»ºè®¢å•ã€æ‰£åº“å­˜ã€æ”¯ä»˜ã€å‘è´§ï¼‰ã€‚
- **æœ€å°ä»»åŠ¡**ï¼š`æ‰£å‡åº“å­˜`ï¼ˆä¸šåŠ¡ä¸Šä¸å¯å†åˆ†ï¼Œä»£ç ä¸Šå¯¹åº”ä¸€ä¸ªäº‹åŠ¡ï¼‰ã€‚

#### æ€»ç»“
   - æ‹†è§£åˆ°ä¸šåŠ¡è®¤å¯çš„åŸå­æ“ä½œï¼Œç¡®ä¿å•ä¸€èŒè´£å’Œç‹¬ç«‹æ‰§è¡Œèƒ½åŠ›ã€‚
   - é€šè¿‡â€œèƒ½å¦å†æ‹†åˆ†â€å’Œâ€œæ˜¯å¦ä¾èµ–å¤–éƒ¨çŠ¶æ€â€åˆ¤æ–­ã€‚

**å…³é”®åŸåˆ™**ï¼š
> **â€œæœ€å°ä»»åŠ¡åº”æ˜¯ä¸šåŠ¡ä¸Šçš„åŸå­æ“ä½œï¼ŒæŠ€æœ¯ä¸Šçš„äº‹åŠ¡è¾¹ç•Œã€‚â€**  
> ä¾‹å¦‚ï¼š
> - æ•°æ®åº“äº‹åŠ¡è¾¹ç•Œï¼ˆå¦‚â€œæ‰£åº“å­˜â€éœ€åœ¨ä¸€ä¸ªäº‹åŠ¡å†…å®Œæˆï¼‰ã€‚
> - ä¸šåŠ¡è§„åˆ™è¾¹ç•Œï¼ˆå¦‚â€œæ”¯ä»˜â€å¿…é¡»å®Œæ•´æ‰§è¡Œï¼Œä¸èƒ½åŠé€”è€ŒåºŸï¼‰ã€‚

---

### ä¸ºä»€ä¹ˆè¦æœ€å°åŒ–è§’è‰²ï¼Ÿ
åœ¨ä¸šåŠ¡å»ºæ¨¡å’Œç³»ç»Ÿè®¾è®¡ä¸­ï¼Œ**æœ€å°åŒ–è§’è‰²ï¼ˆRole Minimizationï¼‰**çš„æ ¸å¿ƒç›®æ ‡æ˜¯ï¼š
1. **é™ä½å¤æ‚åº¦**ï¼šé¿å…è§’è‰²èŒè´£è¿‡å¤šï¼Œå¯¼è‡´æƒé™æ··ä¹±æˆ–åŠŸèƒ½è€¦åˆã€‚
2. **æé«˜çµæ´»æ€§**ï¼šç»†ç²’åº¦è§’è‰²æ›´å®¹æ˜“ç»„åˆå¤ç”¨ï¼ˆå¦‚â€œå®¡æ‰¹äººâ€+â€œæäº¤äººâ€=å®Œæ•´æµç¨‹ï¼‰ã€‚
3. **å¢å¼ºå®‰å…¨æ€§**ï¼šéµå¾ªæœ€å°æƒé™åŸåˆ™ï¼ˆPrinciple of Least Privilegeï¼‰ï¼Œå‡å°‘è¶Šæƒé£é™©ã€‚

#### å…¸å‹é—®é¢˜ï¼ˆæœªæœ€å°åŒ–è§’è‰²ï¼‰
- **ä¸‡èƒ½è§’è‰²**ï¼šå¦‚â€œç³»ç»Ÿç®¡ç†å‘˜â€æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼Œéš¾ä»¥å®¡è®¡å’Œç®¡æ§ã€‚
- **èŒè´£æ··æ‚**ï¼šå¦‚â€œè´¢åŠ¡+HRâ€è§’è‰²ï¼Œè¿åå•ä¸€èŒè´£åŸåˆ™ã€‚

---

### å¦‚ä½•åˆ¤æ–­è§’è‰²æ˜¯å¦æœ€å°åŒ–ï¼Ÿ
#### 1. èŒè´£å•ä¸€æ€§æ£€æŸ¥
- **é—®é¢˜**ï¼šè¯¥è§’è‰²æ˜¯å¦åªåšä¸€ä»¶äº‹ï¼Ÿ
- **ç¤ºä¾‹**ï¼š  
  âœ… **æœ€å°åŒ–è§’è‰²**ï¼š`è®¢å•å®¡æ‰¹äºº`ï¼ˆä»…å®¡æ‰¹ï¼‰ã€`æ•°æ®æŸ¥çœ‹å‘˜`ï¼ˆä»…è¯»æ•°æ®ï¼‰ã€‚  
  âŒ **éæœ€å°åŒ–è§’è‰²**ï¼š`è®¢å•ç®¡ç†å‘˜`ï¼ˆåŒ…å«åˆ›å»ºã€å®¡æ‰¹ã€åˆ é™¤ç­‰æƒé™ï¼‰ã€‚

#### 2. æƒé™å¯ç»„åˆæ€§
- **é—®é¢˜**ï¼šè¯¥è§’è‰²èƒ½å¦æ‹†åˆ†ä¸ºæ›´å°çš„ã€å¯å¤ç”¨çš„å­è§’è‰²ï¼Ÿ
- **ç¤ºä¾‹**ï¼š
   - åŸè§’è‰²ï¼š`é¡¹ç›®ç®¡ç†å‘˜`ï¼ˆç®¡ç†æˆå‘˜+å®¡æ‰¹ä»»åŠ¡+åˆ é™¤é¡¹ç›®ï¼‰ã€‚
   - æ‹†è§£åï¼š`æˆå‘˜ç®¡ç†å‘˜` + `ä»»åŠ¡å®¡æ‰¹äºº` + `é¡¹ç›®åˆ é™¤äºº`ã€‚

#### 3. ä¸šåŠ¡åœºæ™¯éªŒè¯
- **é—®é¢˜**ï¼šæ˜¯å¦å­˜åœ¨ä¸šåŠ¡åœºæ™¯åªéœ€è¦è¯¥è§’è‰²çš„éƒ¨åˆ†æƒé™ï¼Ÿ
- **ç¤ºä¾‹**ï¼š
   - æŸäº›ç”¨æˆ·åªéœ€â€œæäº¤è®¢å•â€ä½†æ— éœ€â€œå®¡æ‰¹è®¢å•â€â†’ éœ€æ‹†è§£ä¸º`æäº¤äºº`å’Œ`å®¡æ‰¹äºº`è§’è‰²ã€‚

#### 4. å˜æ›´å½±å“åˆ†æ
- **é—®é¢˜**ï¼šä¿®æ”¹è¯¥è§’è‰²çš„æƒé™æ˜¯å¦ä¼šå½±å“æ— å…³åŠŸèƒ½ï¼Ÿ
- **ç¤ºä¾‹**ï¼š
   - è‹¥è°ƒæ•´â€œè®¢å•å®¡æ‰¹äººâ€çš„æƒé™ä¼šå½±å“â€œè®¢å•åˆ›å»ºâ€â†’ è§’è‰²æœªæœ€å°åŒ–ã€‚

**æ ¸å¿ƒåŸåˆ™**ï¼š
> **â€œä¸€ä¸ªè§’è‰²åº”è¯¥å°åˆ°ä¸èƒ½å†å°ï¼Œä½†åˆèƒ½å®Œæ•´æ”¯æŒä¸€ä¸ªä¸šåŠ¡æ“ä½œã€‚â€**  
> ä¾‹å¦‚ï¼š`å®¡æ‰¹äºº`è§’è‰²åªéœ€â€œåŒæ„/é©³å›â€æƒé™ï¼Œæ— éœ€å…³å¿ƒâ€œè°æäº¤çš„è®¢å•â€ã€‚

---

### å¸¸é—®åˆ°çš„ç‚¹
1. å»é™¤è°ƒç”¨æŸæŸç³»ç»Ÿçš„æè¿°ï¼Œå¦‚è°ƒç”¨é€šçŸ¥ç³»ç»Ÿï¼Œæ”¹ä¸ºå‘é€é€šçŸ¥ã€‚
2. å¦‚æœçŠ¶æ€æ”¹å˜å…³è”çš„æ“ä½œæ¯”è¾ƒå¤šï¼Œå¯æ‹†ä¸ºä¸ºä¸¤ä¸ªä»»åŠ¡ã€‚å¦‚æœå½±å“ä¸å¤ªå¤§ï¼Œæ”¹ä¸ºè§„åˆ™æè¿°ã€‚
3. é¢†åŸŸå¯¹è±¡å¤šå¯¹å¤šçš„å…³ç³»ã€‚ç­çº§å’Œè€å¸ˆï¼Œæ˜¯å¤šå¯¹å¤šã€‚å¼•å…¥ä»»è¯¾è€å¸ˆå’Œè¯¾ç¨‹ï¼Œè§£è—•ä¸ºä¸€å¯¹å¤šã€å¤šå¯¹ä¸€çš„å…³ç³»ã€‚

## æŠ€æœ¯å»ºæ¨¡
æŠ€æœ¯å»ºæ¨¡çš„ç›®æ ‡æ˜¯å°†ä¸šåŠ¡å»ºæ¨¡çš„æˆæœè½¬åŒ–ä¸ºæŒ‡å¯¼é¡¹ç›®å®æ–½è½åœ°çš„ç³»ç»Ÿè®¾è®¡ã€‚

### æ¦‚å¿µå®šä¹‰
#### æŠ€æœ¯å»ºæ¨¡çš„æµç¨‹
ç®€å•åº”ç”¨æ¶æ„ï¼š
1. åˆ’åˆ†å¾®æœåŠ¡ï¼šåˆå¹¶æ¨¡å—ã€è®¾è®¡å¾®æœåŠ¡é—´æ•°æ®è½¬æ¢å’Œé€šä¿¡æ–¹å¼ï¼ˆå¯é€‰ï¼‰
2. è¯†åˆ«å®ä½“ï¼šæ˜ å°„é¢†åŸŸå¯¹è±¡åˆ°å®ä½“
3. åˆ†é…èŒè´£ï¼šè®¾è®¡å®ä½“çš„å±æ€§åŠæ–¹æ³•
4. ORMè¡¨è®¾è®¡ï¼šè®¾è®¡å®ä½“å¯¹åº”çš„æ•°æ®åº“è¡¨

å¤æ‚åº”ç”¨æ¶æ„ï¼š
1. åˆ’åˆ†å¾®æœåŠ¡ï¼šåˆå¹¶æ¨¡å—ã€è®¾è®¡å¾®æœåŠ¡é—´æ•°æ®è½¬æ¢å’Œé€šä¿¡æ–¹å¼
2. è¯†åˆ«å®ä½“ï¼šæ˜ å°„é¢†åŸŸå¯¹è±¡åˆ°å®ä½“ã€å€¼å¯¹è±¡
3. åˆ†é…èŒè´£ï¼šè®¾è®¡å®ä½“çš„å±æ€§åŠæ–¹æ³•ã€è®¾è®¡é¢†åŸŸæœåŠ¡
4. ORMè¡¨è®¾è®¡ï¼šè®¾è®¡å®ä½“å’Œå€¼å¯¹è±¡å¯¹åº”çš„æ•°æ®åº“è¡¨

#### å¾®æœåŠ¡é—´æ•°æ®è½¬æ¢å’Œé€šä¿¡æ–¹å¼çš„è®¾è®¡åŸåˆ™
è®¾è®¡å¾®æœåŠ¡é—´æ•°æ®è½¬æ¢å’Œé€šä¿¡æ–¹å¼æ—¶ï¼Œå¯å‚è€ƒä»¥ä¸‹åŸåˆ™ï¼š
- å¦‚æœå¾®æœåŠ¡ä¸šåŠ¡å¤æ‚å¹¶æ¼”è¿›è¿…é€Ÿï¼Œéœ€è¦å®ç°å¾®æœåŠ¡é—´çš„è§£è€¦ï¼Œåˆ™é‡‡ç”¨é˜²è…å±‚ã€‚
- å¦‚æœå¾®æœåŠ¡å¯¹æ€§èƒ½æœ‰ä¸¥è‹›è¦æ±‚ï¼Œä¸”åè°ƒå¤šä¸ªå¾®æœåŠ¡åŒæ­¥ä¿®æ”¹çš„ä»£ä»·å¯ä»¥æ¥å—ï¼Œå¯è€ƒè™‘å…±äº«å†…æ ¸ã€‚ä½†å…±äº«å†…æ ¸å¯¼è‡´å¾®æœåŠ¡é—´é«˜åº¦è€¦åˆï¼Œå®è·µä¸­ä¸æ¨èé‡‡ç”¨æ­¤æ–¹å¼ã€‚

### äº‘å¼€å‘èŒƒå¼å°è¯¾å ‚

### çŸ­æ—¶é—´å†…æ— æ³•ç¡®å®šæ˜¯å®ä½“è¿˜æ˜¯å€¼å¯¹è±¡ï¼Œå…ˆæ˜ å°„ä¸ºå®ä½“ã€‚ä¸¾ä¾‹è¯´æ˜
æ¯”å¦‚é™„ä»¶çš„å­˜å‚¨ï¼Œæœ‰äº›åœºæ™¯é™„ä»¶æ˜¯æœ‰ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥ä½œä¸ºå®ä½“ã€‚

### ã€éå¸¸é«˜é¢‘ã€‘é¢†åŸŸå¯¹è±¡å…³ç³»çš„å¤„ç†ï¼ŒæŠ€æœ¯å»ºæ¨¡æˆ–ä¸šåŠ¡å»ºæ¨¡ä¸€å®šä¼šé—®

### é¢†åŸŸæœåŠ¡çš„ä¾‹å­ï¼Œä»¥åŠä¸æ¨èä½¿ç”¨é¢†åŸŸæœåŠ¡çš„åŸå› 

### æ³¨æ„ç‚¹
æ³¨æ„å‡†å¤‡ä¾‹å­
4ï½7ï¼šé«˜é¢‘
10ï¼šæ³¨æ„è®ºæ–‡å®ä½“->è¡¨çš„æ˜ å°„è¡¨è¿°ï¼Œå®ä½“->PO->è¡¨
èµ‹èƒ½ä¾‹å­ï¼šé™„ä»¶ç±»å‹åˆ¤æ–­ï¼ŒåŠ å¯†

## ä»£ç è½åœ°
### æ•°æ®æ ¡éªŒ
é€šç”¨æŠ€æœ¯æ ¡éªŒåœ¨é€‚é…å™¨å±‚ï¼Œä¸šåŠ¡æ»¡è¶³æ€§æ ¡éªŒåœ¨åº”ç”¨å±‚ï¼Œå¼ºä¸šåŠ¡å±æ€§æ ¡éªŒæ²‰æ·€åˆ°å®ä½“ã€‚

### å¼‚å¸¸å¤„ç†
å“ªäº›å±‚å¯ä»¥æŠ›å‡ºå¼‚å¸¸

### ä»£ç æ£€è§†çš„é—®é¢˜æ”¶é›†
1. ç»„é‡Œæ–°äººï¼ŒAssembleä¸æ­¢åšäº†è½¬æ¢ï¼Œè¿˜è°ƒç”¨repositoryçš„æŸ¥è¯¢ã€å­˜å‚¨

### æ¶æ„å®ˆæŠ¤é‡åˆ°çš„é—®é¢˜
å†å²ä»£ç æˆ–è€…æ­¤å‰æœªå¼€å¯æ¶æ„å®ˆæŠ¤çš„åº”ç”¨ï¼Œå¼€å¯æ¶æ„å®ˆæŠ¤

### æ¶æ„å®ˆæŠ¤çš„è‡ªå®šä¹‰ä¾‹å­
Assembleçš„è½¬æ¢ï¼Œä¸å…è®¸è°ƒç”¨repository

### å¤šçº¿ç¨‹æ‹’ç»ç­–ç•¥

åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œå½“çº¿ç¨‹æ± æˆ–ä»»åŠ¡é˜Ÿåˆ—è¾¾åˆ°å…¶å®¹é‡é™åˆ¶æ—¶ï¼Œéœ€è¦é‡‡ç”¨æ‹’ç»ç­–ç•¥æ¥å¤„ç†æ–°æäº¤çš„ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯å¸¸è§çš„å‡ ç§æ‹’ç»ç­–ç•¥ï¼š

#### 1. AbortPolicyï¼ˆä¸­æ­¢ç­–ç•¥ï¼‰
- **é»˜è®¤ç­–ç•¥**
- ç›´æ¥æŠ›å‡º `RejectedExecutionException` å¼‚å¸¸
- è°ƒç”¨è€…å¯ä»¥æ•è·è¿™ä¸ªå¼‚å¸¸å¹¶å¤„ç†

#### 2. CallerRunsPolicyï¼ˆè°ƒç”¨è€…è¿è¡Œç­–ç•¥ï¼‰
- è®©æäº¤ä»»åŠ¡çš„çº¿ç¨‹è‡ªå·±æ‰§è¡Œè¯¥ä»»åŠ¡
- è¿™ç§ç­–ç•¥ä¼šé™ä½æ–°ä»»åŠ¡çš„æäº¤é€Ÿåº¦ï¼Œèµ·åˆ°ç®€å•çš„åé¦ˆæ§åˆ¶ä½œç”¨

#### 3. DiscardPolicyï¼ˆä¸¢å¼ƒç­–ç•¥ï¼‰
- ç›´æ¥é™é»˜ä¸¢å¼ƒæ— æ³•å¤„ç†çš„ä»»åŠ¡
- ä¸æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œä¹Ÿä¸æ‰§è¡Œä»»ä½•æ“ä½œ

#### 4. DiscardOldestPolicyï¼ˆä¸¢å¼ƒæœ€è€ç­–ç•¥ï¼‰
- ä¸¢å¼ƒé˜Ÿåˆ—ä¸­æœ€è€çš„ä»»åŠ¡ï¼ˆå³æœ€æ—©è¿›å…¥é˜Ÿåˆ—çš„ä»»åŠ¡ï¼‰
- ç„¶åå°è¯•é‡æ–°æäº¤å½“å‰ä»»åŠ¡

#### 5. è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥
- å®ç° `RejectedExecutionHandler` æ¥å£
- æ ¹æ®ä¸šåŠ¡éœ€æ±‚è‡ªå®šä¹‰æ‹’ç»é€»è¾‘

#### ä½¿ç”¨ç¤ºä¾‹ï¼ˆJavaçº¿ç¨‹æ± ï¼‰

```java
ThreadPoolExecutor executor = new ThreadPoolExecutor(
    corePoolSize,
    maximumPoolSize,
    keepAliveTime,
    TimeUnit.MILLISECONDS,
    new LinkedBlockingQueue<Runnable>(capacity),
    new ThreadPoolExecutor.AbortPolicy() // è®¾ç½®æ‹’ç»ç­–ç•¥
);
```

é€‰æ‹©å“ªç§æ‹’ç»ç­–ç•¥å–å†³äºå…·ä½“çš„åº”ç”¨åœºæ™¯å’Œå¯¹ä»»åŠ¡ä¸¢å¤±çš„å®¹å¿ç¨‹åº¦ã€‚

### å¦‚ä½•å¤„ç†æ¨¡å—é—´äº’è°ƒé—®é¢˜
è‹¥å‡ºç°module1çš„serviceè°ƒç”¨module2çš„serviceï¼Œä½†ä¸€èˆ¬æƒ…å†µdddä¸‹module1æ˜¯ä¸å…è®¸è°ƒç”¨module2ã€‚ä»¥ä¸‹æ˜¯ç³»ç»Ÿæ€§è§£å†³æ–¹æ¡ˆå’Œæœ€ä½³å®è·µï¼š

---

#### ä¸€ã€é—®é¢˜è¯Šæ–­ä¸åº”å¯¹ç­–ç•¥
##### åœºæ™¯åˆ†æ
```mermaid
flowchart LR
    A[module1.ServiceA] -->|ç›´æ¥è°ƒç”¨| B[module2.ServiceB]
```
**è¿åçš„åŸåˆ™**ï¼š
1. ç ´åæ¨¡å—è‡ªæ²»æ€§
2. äº§ç”ŸåŒå‘ä¾èµ–é£é™©
3. å¯¼è‡´åˆ†å¸ƒå¼äº‹åŠ¡å¤æ‚åº¦

---

#### äºŒã€æ ‡å‡†è§£å†³æ–¹æ¡ˆ

##### æ–¹æ¡ˆ1ï¼šé€šè¿‡é¢†åŸŸäº‹ä»¶è§£è€¦ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰
```java
// module1 å‘å¸ƒäº‹ä»¶ï¼ˆæ— éœ€çŸ¥é“module2ï¼‰
public class OrderService {
    public void confirmOrder(Order order) {
        order.confirm();
        eventPublisher.publish(new OrderConfirmedEvent(order.getId()));
    }
}

// module2 è®¢é˜…äº‹ä»¶
public class InventoryEventHandler {
    @EventListener
    public void handle(OrderConfirmedEvent event) {
        inventoryService.adjustStock(event.getOrderId()); // å†…éƒ¨å¤„ç†
    }
}
```
**ä¼˜åŠ¿**ï¼š
- å®Œå…¨è§£è€¦ï¼Œmodule1æ— éœ€æ„ŸçŸ¥module2
- å¤©ç„¶æ”¯æŒåˆ†å¸ƒå¼åœºæ™¯

**é€‚ç”¨åœºæ™¯**ï¼šè®¢å•-åº“å­˜ã€æ”¯ä»˜-é€šçŸ¥ç­‰å¼‚æ­¥æµç¨‹

##### æ–¹æ¡ˆ2ï¼šé€šè¿‡é˜²è…å±‚ï¼ˆACLï¼‰éš”ç¦»
```java
// module1 å®šä¹‰é˜²è…æ¥å£ï¼ˆé¢†åŸŸå±‚ï¼‰
public interface InventoryService {
    boolean reserveStock(OrderId orderId, List<Item> items);
}

// module1 åŸºç¡€è®¾æ–½å±‚å®ç°ï¼ˆè°ƒç”¨module2çš„APIï¼‰
public class InventoryServiceHttpClient implements InventoryService {
    private final InventoryApiClient client; // Feign/Retrofit

    @Override
    public boolean reserveStock(OrderId orderId, List<Item> items) {
        ReserveRequest request = convertToRequest(orderId, items);
        return client.reserve(request); // HTTPè°ƒç”¨module2
    }
}
```
**ä¼˜åŠ¿**ï¼š
- ä¸šåŠ¡é€»è¾‘ä¸ä¾èµ–å…·ä½“å®ç°
- å¯æ›¿æ¢ä¸ºå…¶ä»–å®ç°ï¼ˆå¦‚Mockæµ‹è¯•ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦å®æ—¶å“åº”çš„å¼ºä¸€è‡´æ€§æ“ä½œ

##### æ–¹æ¡ˆ3ï¼šSagaæ¨¡å¼ï¼ˆé•¿äº‹åŠ¡ç®¡ç†ï¼‰
```java
// åœ¨module1å¯åŠ¨Saga
public class OrderSaga {
    private final SagaCoordinator coordinator;

    public void createOrder(Order order) {
        coordinator.begin()
            .step("reserve_stock", 
                () -> inventoryProxy.reserve(order), 
                () -> inventoryProxy.cancel(order))
            .step("process_payment",
                () -> paymentProxy.charge(order),
                () -> paymentProxy.refund(order))
            .end();
    }
}
```
**ä¼˜åŠ¿**ï¼š
- ç»´æŠ¤è·¨æ¨¡å—äº‹åŠ¡ä¸€è‡´æ€§
- æ˜¾å¼å®šä¹‰è¡¥å¿æœºåˆ¶

**é€‚ç”¨åœºæ™¯**ï¼šè·¨å¤šæœåŠ¡çš„è®¢å•å±¥çº¦ã€èµ„é‡‘è½¬è´¦ç­‰

---

#### ä¸‰ã€æ¶æ„éªŒè¯è§„åˆ™
ä½¿ç”¨ArchUnitç¦æ­¢ç›´æ¥è°ƒç”¨ï¼š
```java
@ArchTest
public static final ArchRule no_cross_module_direct_call = 
    noClasses()
        .that().resideInAPackage("..module1..")
        .should().dependOnClassesThat()
        .resideInAPackage("..module2..");
```

å½“å‡ºç°è¿è§„æ—¶ï¼Œæµ‹è¯•ä¼šæŠ¥é”™ï¼š
```
Architecture Violation: Method <module1.OrderService.placeOrder()> 
calls method <module2.InventoryService.reserve()> in (OrderService.java:25)
```

---

#### å››ã€å†³ç­–æ ‘ï¼šé€‰æ‹©åˆé€‚æ–¹æ¡ˆ
```mermaid
graph TD
    A[éœ€è¦å®æ—¶å“åº”?] -->|æ˜¯| B{å¼ºä¸€è‡´æ€§è¦æ±‚?}
    A -->|å¦| C[ä½¿ç”¨é¢†åŸŸäº‹ä»¶]
    B -->|æ˜¯| D[é˜²è…å±‚+åˆ†å¸ƒå¼é”]
    B -->|å¦| E[é˜²è…å±‚+é‡è¯•æœºåˆ¶]
    D --> F[è€ƒè™‘Sagaè¡¥å¿]
```

---

#### äº”ã€é”™è¯¯å¤„ç†è§„èŒƒ
##### 1. åŒæ­¥è°ƒç”¨ï¼ˆé˜²è…å±‚ï¼‰çš„å¼‚å¸¸å¤„ç†
```java
public class InventoryServiceHttpClient implements InventoryService {
    @Override
    public boolean reserveStock(OrderId orderId, List<Item> items) {
        try {
            return client.reserve(convertToRequest(orderId, items));
        } catch (FeignException e) {
            throw new InventoryUnavailableException(e); // è½¬æ¢ä¸ºé¢†åŸŸå¼‚å¸¸
        }
    }
}
```

##### 2. å¼‚æ­¥äº‹ä»¶ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰çš„è¡¥å¿
```java
public class OrderConfirmedEventHandler {
    @EventListener
    @TransactionalEventListener(phase = AFTER_COMMIT)
    public void handle(OrderConfirmedEvent event) {
        try {
            inventoryService.adjustStock(event.getOrderId());
        } catch (Exception e) {
            eventPublisher.publish(new StockAdjustmentFailedEvent(event)); // è§¦å‘è¡¥å¿æµç¨‹
        }
    }
}
```

---

#### å…­ã€æ¼”è¿›å»ºè®®
1. **åˆæœŸ**ï¼šä½¿ç”¨é˜²è…å±‚å¿«é€Ÿå®ç°
2. **ä¸­æœŸ**ï¼šé€æ­¥æ›¿æ¢ä¸ºé¢†åŸŸäº‹ä»¶
3. **å¤æ‚åœºæ™¯**ï¼šå¼•å…¥Sagaæ¨¡å¼
4. **ç›‘æ§**ï¼šé€šè¿‡Metricsè®°å½•è·¨æ¨¡å—è°ƒç”¨ï¼š
   ```java
   @Timed("module1.inventory.reserve")
   public boolean reserveStock(OrderId orderId) {
       // ...
   }
   ```

---

é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œå¯åœ¨ä¿æŒDDDæ¨¡å—åŒ–è®¾è®¡çš„åŒæ—¶ï¼Œå®‰å…¨åœ°å®ç°è·¨æ¨¡å—åä½œã€‚å…³é”®ç‚¹æ˜¯ï¼š**æ°¸è¿œä¸è¦è®©ä½ çš„é¢†åŸŸå±‚ç›´æ¥ä¾èµ–å¦ä¸€ä¸ªé™ç•Œä¸Šä¸‹æ–‡çš„å®ç°ç»†èŠ‚**ã€‚

### è‡ªå®šä¹‰æ¶æ„å®ˆæŠ¤
å¦‚ä½•å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•è§„åˆ™ï¼Œåªå…è®¸module1å’Œmodule2ä¾èµ–commonï¼Œä¸å…è®¸commonä¾èµ–module1å’Œmodule2ï¼Œä»¥åŠåªå…è®¸module1ä¸‹çš„serviceä¾èµ–executorï¼Œä¸å…è®¸executorä¾èµ–åŒåŒ…ä¸‹çš„serviceã€‚ä»¥ä¸‹æ˜¯åŸºäº ArchUnit çš„å•å…ƒæµ‹è¯•è§„åˆ™å®ç°ï¼Œå¯ä¸¥æ ¼çº¦æŸæ‚¨æè¿°çš„æ¨¡å—ä¾èµ–å…³ç³»ï¼š

---

#### ä¸€ã€æµ‹è¯•ç¯å¢ƒå‡†å¤‡ï¼ˆMaven é…ç½®ï¼‰
```xml
<!-- pom.xml -->
<dependency>
    <groupId>com.tngtech.archunit</groupId>
    <artifactId>archunit</artifactId>
    <version>1.0.1</version>
    <scope>test</scope>
</dependency>
```

---

#### äºŒã€å®Œæ•´çš„æµ‹è¯•ç±»å®ç°
```java
import com.tngtech.archunit.core.domain.JavaClasses;
import com.tngtech.archunit.core.importer.ClassFileImporter;
import com.tngtech.archunit.lang.ArchRule;
import org.junit.Test;

import static com.tngtech.archunit.lang.syntax.ArchRuleDefinition.*;

public class ModuleDependencyTest {

    private final JavaClasses classes = new ClassFileImporter()
            .importPackages("com.yourcompany");

    // è§„åˆ™1ï¼šä»…å…è®¸module1/module2ä¾èµ–commonï¼Œç¦æ­¢åå‘ä¾èµ–
    @Test
    public void common_module_dependency_rule() {
        ArchRule rule = noClasses()
                .that().resideInAPackage("..common..")
                .should().dependOnClassesThat()
                .resideInAnyPackage(
                    "..module1..", 
                    "..module2.."
                );

        rule.check(classes);
    }

    // è§„åˆ™2ï¼šmodule1å†…ä»…å…è®¸serviceä¾èµ–executorï¼Œç¦æ­¢åå‘ä¾èµ–
    @Test
    public void module1_internal_dependency_rule() {
        ArchRule rule = noClasses()
                .that().resideInAPackage("..module1..executor..")
                .should().dependOnClassesThat()
                .resideInAPackage("..module1..service..");

        rule.check(classes);
    }

    // å¢å¼ºè§„åˆ™ï¼šç¦æ­¢commonåŒ…è¢«å¤–éƒ¨éæŒ‡å®šæ¨¡å—ä¾èµ–
    @Test
    public void common_access_control_rule() {
        ArchRule rule = noClasses()
                .that().resideOutsideOfPackages(
                    "..module1..", 
                    "..module2..",
                    "..common.."
                )
                .should().dependOnClassesThat()
                .resideInAPackage("..common..");

        rule.check(classes);
    }
}
```

---

#### ä¸‰ã€è§„åˆ™è¯¦è§£

##### 1. **CommonåŒ…ä¾èµ–çº¦æŸ**
```java
noClasses()
    .that().resideInAPackage("..common..")  // commonåŒ…ä¸‹çš„ç±»
    .should().dependOnClassesThat()         // ä¸èƒ½ä¾èµ–
    .resideInAnyPackage("..module1..", "..module2..");  // module1/module2çš„ç±»
```
**æ•ˆæœ**ï¼š  
âœ… å…è®¸ï¼š
- `module1` â†’ `common`
- `module2` â†’ `common`

âŒ ç¦æ­¢ï¼š
- `common` â†’ `module1`
- `common` â†’ `module2`
- å…¶ä»–æ¨¡å—ï¼ˆå¦‚`module3`ï¼‰â†’ `common`

##### 2. **Module1å†…éƒ¨Service-Executorçº¦æŸ**
```java
noClasses()
    .that().resideInAPackage("..module1..executor..")  // executoråŒ…ä¸‹çš„ç±»
    .should().dependOnClassesThat()                    // ä¸èƒ½ä¾èµ–
    .resideInAPackage("..module1..service..");         // serviceåŒ…çš„ç±»
```
**æ•ˆæœ**ï¼š  
âœ… å…è®¸ï¼š
- `module1.service` â†’ `module1.executor`

âŒ ç¦æ­¢ï¼š
- `module1.executor` â†’ `module1.service`
- `module1.executor` â†’ `module1.repository`ï¼ˆå¯é€šè¿‡é¢å¤–è§„åˆ™çº¦æŸï¼‰

---

#### å››ã€æ‰§è¡Œæ•ˆæœéªŒè¯

##### å½“å‡ºç°è¿è§„æ—¶ï¼Œæµ‹è¯•ä¼šæŠ¥é”™ï¼š
```
java.lang.AssertionError: Architecture Violation [Priority: MEDIUM]...
Rule 'no classes that reside in a package '..common..' should depend on classes that reside in any package ['..module1..', '..module2..']' was violated:
Method <com.yourcompany.common.CommonUtil.doSomething()> calls method <com.yourcompany.module1.Service.process()> in (CommonUtil.java:10)
```

---

#### äº”ã€è¿›é˜¶å¢å¼ºæ–¹æ¡ˆ

##### 1. ä½¿ç”¨åˆ†å±‚æ¶æ„æ£€æµ‹ï¼ˆæ›´ä¸¥æ ¼ï¼‰
```java
@ArchTest
public static final ArchRule layer_dependencies = layeredArchitecture()
    .layer("Common").definedBy("..common..")
    .layer("Module1").definedBy("..module1..")
    .layer("Module2").definedBy("..module2..")

    .whereLayer("Common").mayOnlyBeAccessedByLayers("Module1", "Module2")
    .whereLayer("Module1").mayNotBeAccessedByAnyLayer()
    .whereLayer("Module2").mayNotBeAccessedByAnyLayer();
```

##### 2. ç¦æ­¢ExecutoråŒ…å¤–æ³„ï¼ˆå¯é€‰ï¼‰
```java
@ArchTest
public static final ArchRule executor_visibility = classes()
    .that().resideInAPackage("..executor..")
    .should().onlyBeAccessed().byClassesThat()
    .resideInAPackage("..service..");
```

---

#### å…­ã€CIé›†æˆå»ºè®®

åœ¨`pom.xml`ä¸­é…ç½®æ„å»ºå¤±è´¥ï¼š
```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <configuration>
        <includes>
            <include>**/*ArchTest*</include>
        </includes>
    </configuration>
</plugin>
```

---

é€šè¿‡ä»¥ä¸Šè§„åˆ™ï¼Œæ‚¨çš„æ¶æ„çº¦æŸå°†å¾—åˆ°è‡ªåŠ¨åŒ–ä¿éšœï¼Œæ¯æ¬¡ä»£ç æäº¤éƒ½ä¼šè§¦å‘ä¾èµ–å…³ç³»æ ¡éªŒï¼Œæœ‰æ•ˆé˜²æ­¢æ¶æ„é€€åŒ–ã€‚

# ç³»ç»Ÿæ¶æ„è®¾è®¡
## å¾®æœåŠ¡éƒ¨ç½²
### å¾®æœåŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ
å¾®æœåŠ¡ï¼ˆMicroservicesï¼‰æ˜¯ä¸€ç§**è½¯ä»¶æ¶æ„é£æ ¼**ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯å°†ä¸€ä¸ªå¤§å‹çš„å•ä½“åº”ç”¨ï¼ˆMonolithic Applicationï¼‰æ‹†åˆ†ä¸ºä¸€ç»„**å°å‹ã€ç‹¬ç«‹ã€æ¾è€¦åˆ**çš„æœåŠ¡ã€‚æ¯ä¸ªæœåŠ¡ä¸“æ³¨äºå®Œæˆ**å•ä¸€ä¸šåŠ¡åŠŸèƒ½**ï¼Œå¹¶é€šè¿‡è½»é‡çº§çš„é€šä¿¡æœºåˆ¶ï¼ˆå¦‚ HTTP/RESTã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼‰ååŒå·¥ä½œï¼Œå…±åŒå®ç°å®Œæ•´çš„ç³»ç»ŸåŠŸèƒ½ã€‚

---

#### å¾®æœåŠ¡ä¸å•ä½“æ¶æ„å¯¹æ¯”
| **ç»´åº¦**         | **å•ä½“æ¶æ„**               | **å¾®æœåŠ¡æ¶æ„**               |
|------------------|--------------------------|---------------------------|
| **å¼€å‘é€Ÿåº¦**      | åˆæœŸå¿«ï¼ŒåæœŸæ…¢           | åˆæœŸå¤æ‚ï¼Œé•¿æœŸè¿­ä»£å¿«       |
| **éƒ¨ç½²**          | æ•´ä½“éƒ¨ç½²ï¼Œé£é™©é«˜         | ç‹¬ç«‹éƒ¨ç½²ï¼Œé£é™©åˆ†æ•£         |
| **æŠ€æœ¯æ ˆ**        | å•ä¸€æŠ€æœ¯                 | æ··åˆæŠ€æœ¯ï¼ˆæŒ‰éœ€é€‰æ‹©ï¼‰       |
| **æ‰©å±•æ€§**        | å‚ç›´æ‰©å±•ï¼ˆæå‡å•æœºæ€§èƒ½ï¼‰ | æ°´å¹³æ‰©å±•ï¼ˆå¢åŠ æœåŠ¡å®ä¾‹ï¼‰   |
| **æ•…éšœå½±å“**      | å…¨å±€ç˜«ç—ª                 | å±€éƒ¨æ•…éšœï¼Œå¯é™çº§å¤„ç†       |

---

#### æ€»ç»“
å¾®æœåŠ¡ä¸æ˜¯â€œé“¶å¼¹â€ï¼Œé€‚åˆä¸­å¤§å‹å¤æ‚ç³»ç»Ÿï¼Œä½†å¯¹å›¢é˜ŸæŠ€æœ¯èƒ½åŠ›å’Œè¿ç»´è¦æ±‚è¾ƒé«˜ã€‚é‡‡ç”¨å‰éœ€æƒè¡¡ä¸šåŠ¡éœ€æ±‚ã€å›¢é˜Ÿè§„æ¨¡å’ŒåŸºç¡€è®¾æ–½æ¡ä»¶ã€‚
>â€œé“¶å¼¹â€æ˜¯ä¸€ä¸ªæ¯”å–»ï¼ŒæŒ‡èƒ½å¿«é€Ÿã€å½»åº•è§£å†³å¤æ‚é—®é¢˜çš„ç¥å¥‡æ–¹æ³•ï¼Œæºè‡ªè¥¿æ–¹æ°‘é—´ä¼ è¯´â€”â€”ä¼ è¯´ä¸­åªæœ‰ç”¨é“¶è´¨å­å¼¹æ‰èƒ½æ€æ­»ç‹¼äººã€å¸è¡€é¬¼ç­‰è¶…è‡ªç„¶ç”Ÿç‰©ã€‚åœ¨æŠ€æœ¯æˆ–å·¥ç¨‹é¢†åŸŸï¼Œâ€œé“¶å¼¹â€å¸¸è¢«ç”¨æ¥å½¢å®¹é‚£äº›è¢«è®¤ä¸ºå¯ä»¥â€œä¸€åŠ³æ°¸é€¸â€è§£å†³æ‰€æœ‰éš¾é¢˜çš„æŠ€æœ¯ã€å·¥å…·æˆ–æ–¹æ³•ã€‚


### æœåŠ¡å•å…ƒã€å‘å¸ƒå•å…ƒã€å¾®æœåŠ¡æœ‰ä»€ä¹ˆåŒºåˆ«
- æœåŠ¡å•å…ƒï¼šæ˜¯**ä¸šåŠ¡é€»è¾‘**ä¸Šçš„åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼Œä»£è¡¨ç³»ç»Ÿä¸­ä¸€ä¸ªé«˜å†…èšã€ä½è€¦åˆçš„ä¸šåŠ¡èƒ½åŠ›ã€‚å®ƒå¼ºè°ƒèŒè´£çš„ç‹¬ç«‹æ€§ï¼Œä½†ä¸ä¸€å®šå¯¹åº”ç‹¬ç«‹çš„éƒ¨ç½²å®ä½“ã€‚
- å‘å¸ƒå•å…ƒï¼šæ˜¯**è¿ç»´å±‚é¢**å¯ç‹¬ç«‹éƒ¨ç½²çš„æœ€å°å®ä½“ï¼ŒæŒ‡ä¸€æ¬¡éƒ¨ç½²æ“ä½œä¸­æ›´æ–°çš„ä»£ç æˆ–èµ„æºé›†åˆã€‚å®ƒæ˜¯è¿ç»´å±‚é¢çš„æ¦‚å¿µï¼Œå…³æ³¨éƒ¨ç½²çš„åŸå­æ€§ã€‚
- å¾®æœåŠ¡ï¼šæ˜¯**åŒæ—¶æ»¡è¶³æœåŠ¡å•å…ƒå’Œå‘å¸ƒå•å…ƒæ ‡å‡†çš„æ¶æ„å®ç°**ï¼Œå³ï¼šä¸šåŠ¡ä¸Šï¼šç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—ï¼ˆæœåŠ¡å•å…ƒï¼‰ã€‚æŠ€æœ¯ä¸Šï¼šç‹¬ç«‹è¿›ç¨‹ã€å¯å•ç‹¬éƒ¨ç½²ï¼ˆå‘å¸ƒå•å…ƒï¼‰ã€‚

---

#### ä¸‰è€…çš„å…³ç³»å¯¹æ¯”
| **ç»´åº¦**       | **æœåŠ¡å•å…ƒ**               | **å‘å¸ƒå•å…ƒ**               | **å¾®æœåŠ¡**                 |
|----------------|--------------------------|--------------------------|--------------------------|
| **æ ¸å¿ƒå…³æ³¨ç‚¹** | ä¸šåŠ¡é€»è¾‘åˆ’åˆ†              | éƒ¨ç½²å’Œäº¤ä»˜               | ä¸šåŠ¡+éƒ¨ç½²çš„å®Œæ•´ç‹¬ç«‹æ€§     |
| **ç‰©ç†å½¢æ€**   | ä»£ç /æ¨¡å—/ç»„ä»¶            | å¯æ‰§è¡ŒåŒ…/å®¹å™¨/é•œåƒ       | ç‹¬ç«‹è¿›ç¨‹ï¼ˆå®¹å™¨/è™šæ‹Ÿæœºï¼‰   |
| **é€šä¿¡æ–¹å¼**   | æœ¬åœ°è°ƒç”¨æˆ–è¿œç¨‹é€šä¿¡        | æ— ç›´æ¥å…³ç³»               | å¿…é¡»è¿œç¨‹é€šä¿¡ï¼ˆHTTPç­‰ï¼‰    |
| **å…¸å‹ç¤ºä¾‹**   | å•ä½“ä¸­çš„`OrderService`ç±» | å•ä½“åº”ç”¨çš„WARåŒ…          | ç‹¬ç«‹çš„â€œè®¢å•æœåŠ¡â€å®¹å™¨      |

---

#### å¸¸è§è¯¯åŒºæ¾„æ¸…
1. **â€œå¾®æœåŠ¡ä¸€å®šæ˜¯å‘å¸ƒå•å…ƒï¼Œä½†å‘å¸ƒå•å…ƒä¸ä¸€å®šæ˜¯å¾®æœåŠ¡â€**
    - âœ… æ­£ç¡®ï¼šå¾®æœåŠ¡å¿…é¡»ç‹¬ç«‹éƒ¨ç½²ï¼ˆå‘å¸ƒå•å…ƒï¼‰ï¼Œä½†å‘å¸ƒå•å…ƒå¯èƒ½æ˜¯ä¸€ä¸ªå•ä½“åº”ç”¨çš„æ•´ä½“éƒ¨ç½²ã€‚

2. **â€œæœåŠ¡å•å…ƒå¯ä»¥è·¨å¾®æœåŠ¡å­˜åœ¨â€**
    - âŒ é”™è¯¯ï¼šå¾®æœåŠ¡å†…éƒ¨å¯ä»¥åŒ…å«å¤šä¸ªæœåŠ¡å•å…ƒï¼ˆæ¨¡å—ï¼‰ï¼Œä½†ä¸€ä¸ªæœåŠ¡å•å…ƒä¸èƒ½è·¨å¾®æœåŠ¡ï¼Œå¦åˆ™è¿èƒŒå¾®æœåŠ¡çš„è‡ªæ²»æ€§åŸåˆ™ã€‚

3. **â€œæ‰€æœ‰æœåŠ¡å•å…ƒéƒ½éœ€è¦æ‹†æˆå¾®æœåŠ¡â€**
    - âŒ é”™è¯¯ï¼šåªæœ‰éœ€è¦ç‹¬ç«‹æ‰©å±•ã€è¿­ä»£æˆ–æŠ€æœ¯å¼‚æ„çš„æœåŠ¡å•å…ƒæ‰é€‚åˆæ‹†ä¸ºå¾®æœåŠ¡ï¼Œå¦åˆ™ä¼šå¯¼è‡´è¿‡åº¦æ‹†åˆ†ï¼ˆNanoserivceåæ¨¡å¼ï¼‰ã€‚

---

#### æ€»ç»“
- **æœåŠ¡å•å…ƒ** = **â€œåšä»€ä¹ˆâ€**ï¼ˆä¸šåŠ¡é€»è¾‘åˆ’åˆ†ï¼‰
- **å‘å¸ƒå•å…ƒ** = **â€œæ€ä¹ˆäº¤ä»˜â€**ï¼ˆéƒ¨ç½²åŸå­æ€§ï¼‰
- **å¾®æœåŠ¡** = **â€œç‹¬ç«‹çš„å…¨æ ˆä¸šåŠ¡å•å…ƒâ€**ï¼ˆä¸šåŠ¡+éƒ¨ç½²çš„åŒé‡ç‹¬ç«‹ï¼‰

ç†è§£è¿™ä¸‰è€…çš„åŒºåˆ«ï¼Œèƒ½å¸®åŠ©ä½ åœ¨æ¶æ„è®¾è®¡ä¸­æ›´ç²¾å‡†åœ°å®šä¹‰æœåŠ¡è¾¹ç•Œï¼Œé¿å…â€œä¸ºå¾®æœåŠ¡è€Œå¾®æœåŠ¡â€çš„é™·é˜±ã€‚

### å¾®æœåŠ¡åˆ’åˆ†çš„åŸåˆ™
1. åº”æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œå¾®æœåŠ¡æ‹†åˆ†ï¼Œé¿å…ä¸å¿…è¦çš„æ‹†åˆ†å’Œåˆå¹¶ï¼Œç¡®ä¿å…¶ç›¸äº’ç‹¬ç«‹ã€é«˜å†…èšä½è€¦åˆã€‚
2. ä¸ä»…è¦è€ƒè™‘åˆ°ä¸šåŠ¡èŒè´£çš„åˆ’åˆ†ï¼Œè¿˜éœ€è¦æ…é‡è€ƒè™‘å¾®æœåŠ¡æ‹†åˆ†åå¯èƒ½å¸¦æ¥çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ä»¥åŠç½‘ç»œè°ƒç”¨å¸¦æ¥çš„æ€§èƒ½æŸè€—é—®é¢˜ã€‚
3. å¾®æœåŠ¡æ•°é‡åº”å°½å¯èƒ½å°‘ï¼Œå¦‚éå¿…è¦ï¼Œä¸è¦å¢åŠ å¾®æœåŠ¡ã€‚
4. åº”æ³¨æ„é¿å…å¾®æœåŠ¡ä¹‹é—´å‡ºç°ç¯çŠ¶ä¾èµ–å…³ç³»ã€‚
5. å¾®æœåŠ¡çš„åˆ’åˆ†ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œè€Œæ˜¯åº”è¯¥éšç€ä¸šåŠ¡éœ€æ±‚æ¸è¿›å¼æ¼”è¿›ï¼ŒåŒæ—¶åº”å®šæœŸå›æ£€åˆ’åˆ†çš„åˆç†æ€§ã€‚

### å¾®æœåŠ¡åˆ’åˆ†çš„æ–¹æ³•
1. é¦–å…ˆè€ƒè™‘æ¨¡å—é—´è°ƒç”¨å…³ç³»
   - å¦‚æœä¸¤ä¸ªæ¨¡å—ä¹‹é—´å­˜åœ¨é«˜é¢‘çš„ç›¸äº’è°ƒç”¨ï¼Œå¯åˆ’åˆ†è‡³åŒä¸€å¾®æœåŠ¡ï¼Œä»¥å‡å°‘è°ƒç”¨çš„é€šä¿¡æŸè€—ã€‚
2. å…¶æ¬¡è€ƒè™‘â€œé«˜é¢‘-é‡è¦â€å››è±¡é™åŸåˆ™
   - å°†â€œé«˜é¢‘é‡è¦â€ï¼ˆå³è®¿é—®é‡å¤§ä¸”é‡è¦ï¼‰è±¡é™çš„æ‰€æœ‰æ¨¡å—åˆ’åˆ†ä¸ºä¸€ä¸ªæˆ–å°‘æ•°ï¼ˆæ§åˆ¶æ•°é‡ï¼‰å‡ ä¸ªå¾®æœåŠ¡ã€‚
   - åœ¨ä¿éšœéåŠŸèƒ½æ€§éœ€æ±‚çš„å‰æä¸‹ï¼Œç»è¿‡å®¡æ…è€ƒé‡å¯å°†â€œé‡è¦ä¸é«˜é¢‘â€ï¼ˆå³è®¿é—®é‡ä¸å¤§ä½†é‡è¦ï¼‰å’Œâ€œé«˜é¢‘ä¸é‡è¦â€ï¼ˆå³è®¿é—®é‡å¤§ä½†ä¸é‡è¦ï¼‰ä¸¤ä¸ªè±¡é™çš„æ‰€æœ‰æ¨¡å—åˆ’åˆ†è‡³ä¸€ä¸ªå¾®æœåŠ¡ã€‚
   - å¯å°†â€œä¸é«˜é¢‘ä¸é‡è¦â€ï¼ˆå³è®¿é—®é‡ä¸å¤§ä¸”ä¸é‡è¦ï¼‰è±¡é™çš„æ¨¡å—åˆ’åˆ†è‡³ä¸šåŠ¡ç›¸å…³æ€§å¼ºçš„å¾®æœåŠ¡ï¼ˆç”±å…¶ä»–è±¡é™åˆ’åˆ†å¾—åˆ°ï¼‰ä¸­ï¼Œè‹¥è¯¥è±¡é™çš„æ¨¡å—è¾ƒå¤šï¼Œä¹Ÿå¯å°†è¯¥è±¡é™çš„æ¨¡å—åˆ’åˆ†è‡³ä¸€ä¸ªå¾®æœåŠ¡ã€‚
3. æœ€åéµå¾ªâ€œæ•°é‡å°½å¯èƒ½å°‘â€åŸåˆ™
   - åœ¨å®è·µä¸­ï¼Œå¦‚æœä¸€ç»„æ¨¡å—â€œåˆ’åˆ†è‡³ä¸€ä¸ªå¾®æœåŠ¡â€å’Œâ€œåˆ’è‡³ä¸¤ä¸ªå¾®æœåŠ¡â€éƒ½æœ‰ä¸€å®šä¾æ®ï¼Œåˆ™å»ºè®®åˆ’åˆ†è‡³ä¸€ä¸ªå¾®æœåŠ¡ã€‚

### è¿‡åº¦å¾®æœåŠ¡åŒ–
é—®é¢˜å®šä¹‰ï¼š  
è¿‡åº¦å¾®æœåŠ¡åŒ–ä¼šå¯¼è‡´åº”ç”¨è®¿é—®å±‚æ¬¡å¤šã€è°ƒç”¨é“¾è·¯å¤æ‚ã€äº¤æ˜“å“åº”æ—¶é—´è¿‡é•¿ï¼Œå¢åŠ ä¸šåŠ¡è¶…æ—¶ã€ä¸å¯ç”¨çš„æ¦‚ç‡ã€‚åŒæ—¶ï¼Œå­ç³»ç»Ÿæ‹†åˆ†å¾®æœåŠ¡è¿‡å¤šã€è¿‡ç»†ï¼Œä¹Ÿä¼šå¯¼è‡´èµ„æºä½¿ç”¨ç‡è¾ƒä½ã€‚ä¸ºæé«˜å„ç ”å‘å›¢é˜Ÿå¯¹è¿‡åº¦å¾®æœåŠ¡åŒ–é—®é¢˜çš„é‡è§†ï¼Œæœ‰æ•ˆé™ä½æ­¤ç±»é£é™©ï¼Œç°å¯åŠ¨è¿‡åº¦å¾®æœåŠ¡åŒ–é—®é¢˜å¸¸æ€åŒ–æ²»ç†å·¥ä½œã€‚

ç»Ÿè®¡å£å¾„ï¼š  
æœåŠ¡å•å…ƒæ»¡è¶³ä¸‹è¿°ä¸¤ç§ç‰¹å¾ä¹‹ä¸€ï¼Œå³ä¼šè¢«è¯†åˆ«ä¸ºé—®é¢˜æœåŠ¡å•å…ƒï¼ˆæ•°æ®æºä¸º30å¤©å†…çš„åŒ—æ–—é“¾è·¯è°ƒç”¨æƒ…å†µï¼‰ï¼š  
ï¼ˆ1ï¼‰æœåŠ¡å•å…ƒçš„åŒ—æ–—é“¾è·¯ç‰¹å¾ä¸ºä»…è¢«ä¸€ä¸ªè°ƒç”¨æ–¹è°ƒç”¨ï¼Œä¸”æœªè°ƒç”¨å…¶ä»–æœåŠ¡å•å…ƒã€‚  
ï¼ˆ2ï¼‰æœåŠ¡å•å…ƒçš„åŒ—æ–—é“¾è·¯ç‰¹å¾ä¸ºä»…è¢«ä¸¤ä¸ªè°ƒç”¨æ–¹è°ƒç”¨ï¼Œä¸”æœªè°ƒç”¨å…¶ä»–æœåŠ¡å•å…ƒã€‚

### å¾®æœåŠ¡æ‹†åˆ†ä¸åˆç†
é—®é¢˜å®šä¹‰ï¼š  
ä¸¤ä¸ªæˆ–å¤šä¸ªæœåŠ¡å•å…ƒé—´çš„è°ƒç”¨é“¾è·¯å½¢æˆæœ‰å‘ç¯ï¼Œæ˜“æ‰©å¤§ç”Ÿäº§äº‹ä»¶çš„å½±å“èŒƒå›´ã€æé«˜æŠ•äº§å¼‚å¸¸æ¦‚ç‡ã€‚

ç»Ÿè®¡å£å¾„ï¼š  
è‹¥ç³»ç»Ÿæˆ–å­ç³»ç»Ÿä¸‹å¾®æœåŠ¡å­˜åœ¨ç¯çŠ¶ä¾èµ–é—®é¢˜ï¼Œåˆ™è¯¥ç³»ç»Ÿæˆ–å­ç³»ç»Ÿå­˜åœ¨ç¯çŠ¶ä¾èµ–é—®é¢˜ã€‚

### ç°åº¦å‘å¸ƒæ—¶ï¼Œæ¶‰åŠåˆ°å®šæ—¶ä»»åŠ¡ä¿®æ”¹ï¼Œéœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ
æ¡†æ¶ç‰ˆæœ¬ä¸º1.8.0åŠä»¥ä¸Šï¼Œ@FrameworkScheduledæ³¨è§£æ–°å¢executeWhenIsolatedå±æ€§ï¼Œæ”¯æŒåœ¨å®ä¾‹éš”ç¦»åä¸æ‰§è¡Œï¼Œé»˜è®¤trueï¼Œè®¾ç½®ä¸ºfalseåˆ™éš”ç¦»ä¸æ‰§è¡Œã€‚

### ç¯çŠ¶ä¾èµ–ä¸¾ä¾‹
æ¯”å¦‚
- æŸœé¢å‡ºå£ä¿¡ç”¨è¯ç™»è®° -> ç½‘é“¶å‡ºå£ä¿¡ç”¨è¯äº¤å•æ˜ç»† -> æŸ¥è¯¢ä¿¡ç”¨è¯é€šçŸ¥é€šçŸ¥

- GRSæ˜ç»† -> æŸœé¢æ˜ç»† -> ä¼é“¶æ˜ç»† -> GRSä¿¡è´·ç¼–å·ä¿¡æ¯

### å¾®æœåŠ¡ç¯çŠ¶ä¾èµ–å¼•å‘çš„é—®é¢˜
å¾®æœåŠ¡æ¶æ„ä¸­å‡ºç°\*\*ç¯çŠ¶ä¾èµ–ï¼ˆcircular dependencyï¼‰\*\*ä¼šå¯¼è‡´ä¸€ç³»åˆ—ä¸¥é‡é—®é¢˜ï¼Œå…·ä½“åŒ…æ‹¬ï¼š

---

#### âŒ 1. å¯åŠ¨é¡ºåºæ··ä¹±æˆ–æ­»é”

* æœåŠ¡ A ä¾èµ–æœåŠ¡ Bï¼ŒB åˆä¾èµ– Aï¼›
* å¯åŠ¨æ—¶å¯èƒ½è¿›å…¥â€œä½ ç­‰æˆ‘ã€æˆ‘ç­‰ä½ â€çš„æ­»é”çŠ¶æ€ï¼›
* å³ä½¿é…ç½®æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œä¹Ÿå¯èƒ½å› å»¶è¿Ÿæˆ–ä¸ä¸€è‡´å¯¼è‡´å¯åŠ¨å¤±è´¥æˆ–å¼‚å¸¸ã€‚

---

#### âŒ 2. æœåŠ¡è€¦åˆä¸¥é‡ï¼Œæ— æ³•ç‹¬ç«‹éƒ¨ç½²

* æ¯ä¸ªæœåŠ¡éƒ½è¢«å…¶ä»–æœåŠ¡åå‘ä¾èµ–ï¼›
* æ— æ³•å•ç‹¬å¼€å‘ã€æµ‹è¯•ã€ä¸Šçº¿æŸä¸ªæœåŠ¡ï¼›
* ä¸€æ”¹ä¸€ä¸ªæœåŠ¡ï¼Œå…¶ä»–å‡ ä¸ªæœåŠ¡ä¹Ÿè¦æ”¹ï¼Œä¸§å¤±å¾®æœåŠ¡çš„çµæ´»æ€§ã€‚

---

#### âŒ 3. å¼•å‘è¿é”æ•…éšœï¼Œç³»ç»Ÿç¨³å®šæ€§å·®

* ä¸€ä¸ªæœåŠ¡æŒ‚æ‰ï¼Œå¯èƒ½å¯¼è‡´å¤šä¸ªæœåŠ¡è¿é”å¼‚å¸¸ï¼›
* ç¯å½¢ä¾èµ–æ‰©å¤§äº†æ•…éšœä¼ æ’­è·¯å¾„ï¼›
* éš¾ä»¥å®ç°é™çº§ã€é™æµã€ç†”æ–­ç­‰å®¹é”™æœºåˆ¶ã€‚

---

#### âŒ 4. è°ƒç”¨é“¾éš¾ä»¥è¿½è¸ªä¸æ²»ç†

* æœåŠ¡ä¹‹é—´è°ƒç”¨è·¯å¾„é”™ç»¼å¤æ‚ï¼›
* å½±å“æ—¥å¿—è¿½è¸ªã€é“¾è·¯è¿½è¸ªï¼ˆå¦‚ Zipkinã€Jaegerï¼‰ï¼›
* ä¹Ÿå¢åŠ äº†è¿ç»´æ’éšœçš„å¤æ‚åº¦ã€‚

---

#### ğŸ“Œ æ€»ç»“ï¼š

> **â€œå¾®æœåŠ¡ä¸€æ—¦å½¢æˆä¾èµ–ç¯ï¼Œä¼šè®©å¾®æœåŠ¡å˜å¾—åƒâ€œå¤šç‚¹è€¦åˆçš„å•ä½“â€ï¼Œè½»åˆ™éƒ¨ç½²å—é™ï¼Œé‡åˆ™å…¨å±€å´©æºƒã€‚â€**


### å¦‚ä½•è§£å†³ç¯çŠ¶ä¾èµ–

---

#### âœ… 1. å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰æ‰“ç ´åŒæ­¥ä¾èµ–

**å…³é”®è¯ï¼šå¼‚æ­¥è§£è€¦ã€äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆEDAï¼‰**

* æ›¿ä»£æœåŠ¡ä¹‹é—´çš„ç›´æ¥è°ƒç”¨ï¼›
* å‘å¸ƒ/è®¢é˜…æœºåˆ¶æ‰“æ–­è°ƒç”¨é“¾ï¼Œé¿å…å¾ªç¯ä¾èµ–ï¼›
* æé«˜ç³»ç»Ÿå¼¹æ€§ï¼Œæ”¯æŒå‰Šå³°å’Œè§£è€¦ã€‚

ğŸ“Œ é€‚ç”¨ï¼šæœåŠ¡ Aã€Bã€C äº’ç›¸é€šçŸ¥å¤„ç†ç»“æœæˆ–çŠ¶æ€æ›´æ–°çš„åœºæ™¯ã€‚

---

#### âœ… 2. é‡æ„æœåŠ¡è¾¹ç•Œï¼ˆåŸºäº DDD çš„é™ç•Œä¸Šä¸‹æ–‡ï¼‰

**å…³é”®è¯ï¼šé¢†åŸŸèŒè´£æ¸…æ™°ã€æœåŠ¡è¾¹ç•Œæ”¶æ•›**

* ä½¿ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰åˆ†æä¸šåŠ¡ï¼›
* å°†å¤šä¸ªäº’ç›¸ä¾èµ–çš„æœåŠ¡æ‹†åˆ†å‡ºæ ¸å¿ƒèŒè´£ã€å…±äº«èŒè´£ï¼›
* å‡å°‘äº¤å‰è®¿é—®å’Œé€»è¾‘é‡å ã€‚

ğŸ“Œ é€‚ç”¨ï¼šæœåŠ¡èŒè´£æ¨¡ç³Šã€è€¦åˆä¸¥é‡çš„è€æ—§ç³»ç»Ÿæˆ–å¤æ‚ä¸šåŠ¡ç³»ç»Ÿã€‚

---

#### âœ… 3. å¼•å…¥ä¸­ä»‹æœåŠ¡ï¼ˆåè°ƒå™¨/Mediatorï¼‰

**å…³é”®è¯ï¼šæµç¨‹ç¼–æ’ã€åè°ƒå™¨æ¨¡å¼**

* æŠŠå¤šä¸ªæœåŠ¡ä¹‹é—´çš„å¤æ‚è°ƒç”¨é€»è¾‘é›†ä¸­åˆ°åè°ƒæœåŠ¡ï¼›
* å‚ä¸æœåŠ¡åªæš´éœ²èƒ½åŠ›æ¥å£ï¼Œä¸šåŠ¡æµç¨‹äº¤ç»™åè°ƒå™¨ç»Ÿä¸€å¤„ç†ï¼›
* é¿å…â€œä½ è°ƒæˆ‘æˆ‘è°ƒä½ â€çš„æ··ä¹±è°ƒç”¨é“¾ã€‚

ğŸ“Œ é€‚ç”¨ï¼šè®¢å•å¤„ç†ã€å®¡æ‰¹æµã€ä¿¡è´·æµç¨‹ç­‰éœ€è¦ç¼–æ’çš„ä¸šåŠ¡ã€‚

---

#### âœ… 4. æŠ½å–å…¬å…±æœåŠ¡ï¼ˆå…±æ€§é€»è¾‘ä¸‹æ²‰ï¼‰

**å…³é”®è¯ï¼šå»é‡é€»è¾‘ã€å…±äº«ç»„ä»¶**

* å°†å¤šä¸ªæœåŠ¡éƒ½ä¾èµ–çš„é€šç”¨åŠŸèƒ½ï¼ˆå¦‚å®¢æˆ·ä¿¡æ¯ã€é€šçŸ¥æ¨é€ï¼‰æŠ½å‡ºæ¥ï¼›
* æä¾›åªè¯»æ¥å£æˆ–æœ€å°ä¸šåŠ¡èƒ½åŠ›ï¼Œä¾›å„æœåŠ¡å•å‘è°ƒç”¨ï¼›
* å‡å°‘äº’ç›¸è®¿é—®ã€é€»è¾‘äº¤å‰ã€‚

ğŸ“Œ é€‚ç”¨ï¼šå¤šä¸ªæœåŠ¡ä¾èµ–ç›¸ä¼¼åŸºç¡€æ¨¡å—çš„æƒ…å†µï¼ˆå®¢æˆ·ä¸­å¿ƒã€é€šçŸ¥ä¸­å¿ƒç­‰ï¼‰ã€‚

---

#### ğŸ”š æ€»ç»“å£è¯€ï¼š

> **MQ è§£è€¦ã€DDD æ‹†ç•Œã€ä¸­ä»‹åè°ƒã€å…¬å…±ä¸‹æ²‰ã€‚**

éœ€è¦æˆ‘ç»“åˆä½ çš„ä¸šåŠ¡ï¼ˆå¦‚èèµ„ã€æˆä¿¡ã€æŠ¥æ–‡å¤„ç†ï¼‰åšä¸ªè½åœ°ç¤ºä¾‹å›¾å—ï¼Ÿ

### è®¾è®¡é˜¶æ®µ
#### ä»€ä¹ˆæ—¶å€™éœ€è¦æ‹†åˆ†å¾®æœåŠ¡
æ–°å»ºç³»ç»Ÿï¼šä¾æ®äº‘å¼€å‘èŒƒå¼è§„èŒƒ
å­˜é‡ç³»ç»Ÿï¼š
1. è·¨å®¤ç»„ã€è·¨å›¢é˜Ÿï¼Œç»´æŠ¤ä¸€ä¸ªå¾®æœåŠ¡ï¼Œå¹¶è¡Œå¼€å‘å›°éš¾
2. æ¨¡å—å†…APIæµé‡ï¼Œåœ¨æ ¸å¿ƒé“¾è·¯ä¸­çš„åœ°ä½è¶Šæ¥è¶Šé‡è¦ï¼Œå°†è¿™äº›APIè¿›è¡Œåˆ†æ‹†

åŒæ—¶ä¹Ÿéœ€è€ƒè™‘çš„é—®é¢˜ï¼šæ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€é€šè®¯æˆæœ¬ã€å®‰å…¨é—®é¢˜ã€è¿ç»´æˆæœ¬

#### æ‹†åˆ†è·¯å¾„æ˜¯æ€ä¹ˆæ ·çš„
æ–°å»ºç³»ç»Ÿï¼šä¾æ®äº‘å¼€å‘èŒƒå¼è§„èŒƒï¼Œå¦‚é‡è¦é«˜é¢‘å››è±¡é™
å­˜é‡ç³»ç»Ÿï¼š
1. å¢é‡æ‹†åˆ†ï¼šå°æ‰¹é‡å¢é‡æ‹†åˆ†ï¼Œéš¾åº¦å°ã€æ›´å®¹æ˜“æ“ä½œé£é™©
2. æ‹†åˆ†é¡ºåºï¼šå…ˆä»£ç åæ•°æ®ã€å…ˆæ•°æ®åä»£ç ï¼Œç»“åˆå®é™…æƒ…å†µ
3. æ‹†åˆ†æ–¹æ³•ï¼šåŸæœ‰å¾®æœåŠ¡å……è¡€/æ¨¡å—åŒ–åˆ’åˆ†ï¼Œæˆ–æ–°å¾®æœåŠ¡ä¸Šé‡æ„ä»£ç 
4. æµé‡è¿ç§»ï¼šä¸¤å¥—å¾®æœåŠ¡å¹¶è¡Œï¼Œåšå¼€å…³ï¼Œæ‹¦æˆªåˆ†å‘

#### å¦‚ä½•è¯„ä¼°å¾®æœåŠ¡æ‹†åˆ†çš„åˆç†æ€§
1. å¾®æœåŠ¡æ˜¯å¦é«˜åº¦è‡ªæ²»ï¼Œæ˜¯å¦é«˜å†…èšã€ä½è€¦åˆ
2. å¾®æœåŠ¡æ˜¯å¦å­˜åœ¨å¾ªç¯ä¾èµ–
3. å¾®æœåŠ¡æ‹†åˆ†çš„ç›®çš„æ˜¯å¦è¾¾åˆ°ï¼ˆç”Ÿäº§äº‹ä»¶æ•°ã€è·¨å®¤ç»„APIé™ä½ï¼‰
4. å¾®æœåŠ¡æ‹†åˆ†åæ˜¯å¦å¼•èµ·å…¶ä»–é—®é¢˜ï¼ˆå¦‚ä¸Šæ–‡æåˆ°æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€é€šè®¯æˆæœ¬ã€å®‰å…¨é—®é¢˜ã€è¿ç»´æˆæœ¬ï¼‰

### è½åœ°é˜¶æ®µ
#### æ•°æ®ä¸€è‡´æ€§æ€ä¹ˆä¿è¯
1. è®¾è®¡é˜¶æ®µå°½é‡é¿å…æ•°æ®ä¸€è‡´æ€§é—®é¢˜
2. ç¡®è®¤æ˜¯å®æ—¶ä¸€è‡´æ€§ï¼Œè¿˜æ˜¯æœ€ç»ˆä¸€è‡´æ€§é—®é¢˜ã€‚æœ€ç»ˆä¸€è‡´æ€§å¯ä»¥åˆ©ç”¨Kafkaç­‰ä¸­é—´ä»¶æ¥æ§åˆ¶ã€‚
3. å®æ—¶ä¸€è‡´æ€§ï¼Œä¸æ¨èäºŒé˜¶æ®µæäº¤ä¼šäº§ç”Ÿé˜»å¡ï¼Œå»ºè®®TCCæ¨¡å¼ï¼ˆTry-Confirm-Cancelï¼‰ã€Sagaæ¨¡å¼ã€‚

#### å­˜é‡ç³»ç»Ÿå¯¹è°ƒç”¨æ–¹ã€æœåŠ¡æ–¹æ€ä¹ˆåšå±è”½ï¼Ÿä¸Šä¸‹æ¸¸ä¾èµ–æ¢³ç†ï¼Ÿ
1. ä¸Šä¸‹æ¸¸ç³»ç»Ÿä¸ºä¸åŒäº§å“ï¼šé€šè¿‡ç½‘å…³å¯¹åè®®ã€è·¯ç”±å±è”½
2. ä¸Šä¸‹æ¸¸ç³»ç»Ÿä¸ºåŒä¸€äº§å“ï¼šç‰ˆæœ¬å·ã€æœåŠ¡æ³¨å†Œå‘ç°
#### ä¸Šä¸‹æ¸¸æ¢³ç†
1. è®¤è¯ç™»è®°ï¼Œå¦‚APIåº”ç”¨å¸‚åœºè®¢é˜…æœåŠ¡ç™»é™†
2. å…¨é“¾è·¯ï¼Œæ—¥å¿—æ¸…æ´—
3. æ•°æ®ä¸­å¿ƒç½‘ç»œæŠ“åŒ…

#### å…¬å…±èƒ½åŠ›åº”è¯¥ä»¥SDKï¼Œè¿˜æ˜¯æœåŠ¡æš´éœ²ï¼Ÿ
æ ¹æ®å®é™…åœºæ™¯ï¼Œ
1. å¦‚æœ‰æ€§èƒ½è¦æ±‚å¯ä»¥ä½¿ç”¨SDKï¼Œä½†ä¾èµ–çš„äº§å“å¤šæ—¶å‡çº§å›°éš¾ã€‚
2. å¦‚æ²¡æœ‰æ€§èƒ½è¦æ±‚ï¼Œæ²¡æœ‰ç›¸å…³ä¾èµ–ã€ä¹Ÿç¬¦åˆå¾®æœåŠ¡çš„é«˜åº¦è‡ªæ²»ï¼Œå¯ä»¥æš´éœ²å¾®æœåŠ¡ã€‚

#### å®é™…é¡¹ç›®ä¸­å¾®æœåŠ¡ä¹‹é—´çš„åä½œæ–¹å¼æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ
1. å¯¹æ€§èƒ½å’Œå¤„ç†å¸‚åœºæ²¡æœ‰ç‰¹åˆ«å¤§çš„è¦æ±‚ï¼Œèµ°HTTP+ZA21ã€ZZ1+ZA24æ ‡å‡†è§„èŒƒæŠ¥æ–‡
2. å¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„è¦æ±‚ï¼Œå¯ä»¥èµ°Absocketï¼ˆA Better Socketï¼‰ã€JIBCï¼ˆJava Inter-Blockchain Communicationï¼‰
3. å¤„ç†èµ·æ¥æ¯”è¾ƒè€—æ—¶ï¼Œå¯ä»¥å¼•å…¥å¼‚æ­¥æˆ–Kafkaå‰Šå³°å¹³è°·

#### ç»“åˆå…·ä½“åœºæ™¯ï¼Œå¦‚ä½•è¿›è¡Œå®¹é”™è®¾è®¡ï¼Ÿç†”æ–­ã€é™æµã€é™çº§ã€å¼¹æ€§ä¼¸ç¼©
1. ç»“åˆå®é™…åœºæ™¯æ˜¯å¦é™æµï¼ˆå¦‚æ‰‹æœºé“¶è¡Œæ‰¿æ¥æ‰€æœ‰å¤–éƒ¨æµé‡ï¼‰ï¼Œä½†éœ€è¦è¿‡æ»¤æ”»å‡»æ€§æµé‡
2. å¼¹æ€§ä¼¸ç¼©åŸºäºæŠ¥å¤‡

#### å¾®æœåŠ¡æ‹†åˆ†å®Œåï¼Œå¾®æœåŠ¡å’Œæ•°æ®åº“çš„è¿æ¥æ•°ä¼šæš´å¢ï¼Œå¦‚ä½•å¤„ç†
è®¾è®¡é˜¶æ®µï¼Œå¾®æœåŠ¡æ‹†åˆ†ï¼Œåšå¥½è¿æ¥æ•°é…ç½®è¯„ä¼°ã€‚å…¶æ¬¡è€ƒè™‘ï¼š
1. æ‹†åº“æ‹†è¡¨
2. ç‰ºç‰²ä¸€äº›æ€§èƒ½ï¼ŒMyCacheæ•°æ®åº“ä»£ç†æœåŠ¡

#### å­˜é‡ç³»ç»Ÿçš„å¾®æœåŠ¡åˆ’åˆ†
1. ä¸šåŠ¡ç»´åº¦ï¼šè€ƒè™‘å°†ä¸€äº›æ”¯çº¿ä¸šåŠ¡å…ˆæ‹†åˆ†ï¼Œå¾ªåºæ¸è¿›åˆ°ä¸»ä¸šåŠ¡
2. æŠ€æœ¯ç»´åº¦ï¼šå…ˆæ‹†åŸºç¡€æ•°æ®åˆ°å¾®æœåŠ¡ï¼Œä»¥APIçš„å½¢å¼è°ƒç”¨
3. é‡æ–°å»ºæ¨¡ï¼šäº‘å¼€å‘èŒƒå¼ä¸šåŠ¡å»ºæ¨¡ã€æŠ€æœ¯å»ºæ¨¡å…¨æ–¹ä½çš„è¯„ä¼°
4. è€ƒè™‘æˆæœ¬ï¼šä¸è¦ä¸ºäº†æ‹†åˆ†è€Œæ‹†åˆ†

## æ•°æ®åº“
### æ•°æ®åº“äº§å“é€‰å‹æ–¹æ³•
1. é¦–å…ˆè€ƒè™‘å•åº“æ€§èƒ½
   - å¦‚æœå•åº“æ•°æ®è§„æ¨¡è¶…è¿‡5TBï¼Œå¹¶ä¸”ä¸å±äºA/Bç±»ç³»ç»Ÿ1/2çº§å­ç³»ç»Ÿçš„1/2çº§æœåŠ¡å•å…ƒï¼Œç›´æ¥é€‰æ‹©TiDBã€‚
2. å…¶æ¬¡è€ƒè™‘ä¸šåŠ¡åœºæ™¯
   - å­˜åœ¨åˆ†åº“åˆ†è¡¨å›°éš¾ï¼Œéœ€è¦æ”¯æŒå¤æ‚SQLï¼Œé€‰æ‹©GaussDBã€‚
å¯¹äºç®€å•å¢åˆ æŸ¥æ”¹åœºæ™¯ï¼Œæ— å¤æ‚SQLã€æ— æ‰¹å¤„ç†ï¼Œä¸”å•åº“è§„æ¨¡åœ¨500GBå†…ï¼Œä¼˜å…ˆé€‰æ‹©TDSQLã€‚

### æ•°æ®åº“æ¶æ„é€‰å‹æ–¹æ³•
1. é¦–å…ˆè€ƒè™‘ä¸šåŠ¡å¯ç”¨æ€§è¦æ±‚
   - å¦‚æœå¯æ¥å—å› æ•°æ®åº“æ•…éšœå¯¼è‡´ä¸šåŠ¡100%ä¸­æ–­è¶…è¿‡30åˆ†é’Ÿï¼Œåˆ™å¯é€‰æ‹©å•åº“ã€è¯»å†™åˆ†ç¦»ï¼›å¦‚æœä¸å¯æ¥å—ï¼Œåˆ™å¯é€‰æ‹©éšæœºå¤šæ´»ã€åˆ‡ç‰‡åˆ†åº“ã€è¯»å†™åˆ†ç¦»ã€‚
2. å…¶æ¬¡è€ƒè™‘ä¸šåŠ¡åœºæ™¯
   - æ ¹æ®è¯»å†™æ¯”ä¾‹æ˜¯å¦è¶…è¿‡4:1ã€æ˜¯å¦æ˜¯æ— çŠ¶æ€æ•°æ®ç­‰è¦æ±‚ï¼Œç¡®å®šæœ€ç»ˆçš„æ¶æ„ã€‚

- å•åº“ï¼šå¯æ¥å—å› æ•°æ®åº“æ•…éšœæ—¶å¯¼è‡´ä¸šåŠ¡100%ä¸­æ–­è¶…è¿‡30åˆ†é’Ÿã€‚

- è¯»å†™åˆ†ç¦»ï¼šè¯»å†™æ¯”ä¾‹ä¼°è®¡è¶…è¿‡4ï¼š1ï¼Œå¯æ¥å—æ•°æ®æœ€ç»ˆä¸€è‡´æ€§ï¼Œå¯¹äº‹åŠ¡ä¸€è‡´æ€§è¦æ±‚ä¸é«˜ã€‚

- åˆ‡ç‰‡åˆ†åº“ï¼šæ— æ³•æ¥å—æ•°æ®åº“æ•…éšœæ—¶å¯¼è‡´ä¸šåŠ¡100%ä¸­æ–­è¶…è¿‡30åˆ†é’Ÿï¼Œæ‰¿è½½å®¢æˆ·ã€è´¦æˆ·ã€è´¦åŠ¡äº¤æ˜“ã€è´¦åŠ¡åè®®ç­‰å®æ—¶äº¤æ˜“æ•°æ®ï¼Œå¯¹äº‹åŠ¡ä¸€è‡´æ€§è¦æ±‚æé«˜ã€‚

- éšæœºå¤šæ´»ï¼šæ— æ³•æ¥å—æ•°æ®åº“æ•…éšœæ—¶å¯¼è‡´ä¸šåŠ¡100%ä¸­æ–­è¶…è¿‡30åˆ†é’Ÿï¼Œé€‚åˆäºæ— çŠ¶æ€ç±»æ•°æ®ï¼ˆå¦‚ä¸šåŠ¡æµæ°´ã€ä¸šåŠ¡æ—¥å¿—ã€æ¸ é“ç±»ä¸šåŠ¡ç­‰ï¼‰ï¼Œä¸šåŠ¡æ•°æ®å¯ä»¥éšæœºå†™å…¥ä»»æ„ä¸€ä¸ªæ•°æ®åº“ä¸­ã€‚

### æ•°æ®åº“å®ä¾‹åˆ’åˆ†åŸåˆ™
1. åŸåˆ™ä¸Šï¼Œé¿å…ä¸€ä¸ªå¾®æœåŠ¡ç‹¬å ä¸€ä¸ªæ•°æ®åº“å®ä¾‹ï¼Œéœ€é‡‡ç”¨å¤šä¸ªå¾®æœåŠ¡å…±ç”¨ä¸€ä¸ªæ•°æ®åº“å®ä¾‹çš„æ–¹å¼ï¼ˆæ¯ä¸ªå¾®æœåŠ¡å¯¹åº”ä¸€ä¸ªSchemaï¼Œå¤šä¸ªSchemaå…±ç”¨ä¸€ä¸ªæ•°æ®åº“å®ä¾‹ï¼‰ã€‚
2. è‹¥å¾®æœåŠ¡å¯¹æ•°æ®åº“æ€§èƒ½ï¼ˆæ¯”å¦‚CPUä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç‡ã€ç£ç›˜ä½¿ç”¨ç‡ï¼‰ã€å¯ç”¨æ€§ï¼ˆæ¯”å¦‚ä¸šåŠ¡ä¿éšœæ€§ã€éš”ç¦»æ€§ï¼‰è¦æ±‚è¾ƒé«˜ï¼ŒSchemaæ–¹å¼æ— æ³•æ»¡è¶³ä¸šåŠ¡è¦æ±‚ï¼Œç»å®¡æ…è€ƒè™‘åå¯ç‹¬å ä¸€ä¸ªæ•°æ®åº“å®ä¾‹ã€‚

### å®ä¾‹è§„æ ¼ä¼°ç®—æ–¹æ³•
1. æ ¹æ®ä¸šåŠ¡æ€§èƒ½è¦æ±‚é¢„ä¼°æ€§èƒ½æŒ‡æ ‡ï¼ˆä¾‹å¦‚TPSï¼‰ï¼Œåˆæ­¥ç¡®è®¤æ•°æ®åº“è§„æ ¼ã€‚
2. è¿›è¡Œæ€§èƒ½å‹æµ‹è¯„ä¼°ï¼Œæœ€ç»ˆç¡®è®¤æ•°æ®åº“è§„æ ¼ã€‚

### æ•°æ®åº“è®¿é—®æ¶æ„ç±»å‹
åœ¨éšæœºå¤šæ´»ã€åˆ‡ç‰‡åˆ†åº“ã€è¯»å†™åˆ†ç¦»æ¶æ„ä¸‹ï¼Œå¾®æœåŠ¡éœ€è®¿é—®å¤šä¸ªæ•°æ®åº“å®ä¾‹è¯»å†™æ•°æ®ï¼Œæ ¹æ®å¾®æœåŠ¡è®¿é—®æ•°æ®åº“çš„æ–¹å¼ä¸åŒï¼Œå¯åˆ†ä¸ºå…¨è¿æ¥è®¿é—®æ¶æ„å’Œå•å…ƒåŒ–è®¿é—®æ¶æ„ã€‚

#### åŸåˆ™
åŸåˆ™ä¸Šï¼Œå„ç³»ç»Ÿ/å­ç³»ç»Ÿä¼˜å…ˆé€‰æ‹©å•å…ƒåŒ–è®¿é—®æ¶æ„ï¼ŒFTCè”æœºåº”ç”¨å¿…é¡»ä½¿ç”¨å•å…ƒåŒ–è®¿é—®æ¶æ„ã€‚

#### å…¨è¿æ¥è®¿é—®æ¶æ„
å…¨è¿æ¥è®¿é—®æ¶æ„æ˜¯æŒ‡æ¯ä¸ªå¾®æœåŠ¡å®ä¾‹è®¿é—®å¤šä¸ªæ•°æ®åº“ã€‚  
![IMG](images/å…¨è¿æ¥è®¿é—®æ¶æ„.png)
è¯¥æ¶æ„å­˜åœ¨ä¸¤ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼š

- å½“å¾®æœåŠ¡å®ä¾‹æ•°é‡ä¸æ–­å¢å¤šæ—¶ï¼Œå•ä¸ªæ•°æ®åº“çš„è¿æ¥æ•°ä¼šå‘ˆå€æ•°å¢åŠ ï¼Œå®¹æ˜“è¶…å‡ºè¿æ¥æ•°é™åˆ¶ï¼Œå¯¼è‡´æ•°æ®åº“ä¸å¯ç”¨ï¼Œè¿›è€Œå½±å“ä¸šåŠ¡ï¼›

- ç”±äºæ¯ä¸ªå¾®æœåŠ¡å®ä¾‹è¿æ¥äº†æ‰€æœ‰æ•°æ®åº“ï¼Œå½“æŸä¸€æ•°æ®åº“æ•…éšœæ—¶ï¼Œå¯èƒ½ä¼šå½±å“åˆ°æ‰€æœ‰çš„å¾®æœåŠ¡ï¼Œå¯¼è‡´ç³»ç»Ÿä¸å¯ç”¨ã€‚

#### å•å…ƒåŒ–è®¿é—®æ¶æ„
å•å…ƒåŒ–è®¿é—®æ¶æ„æŒ‡æ¯ä¸ªå¾®æœåŠ¡å®ä¾‹åªè¿æ¥ä¸€ä¸ªæ•°æ®åº“ã€‚  
![å•å…ƒåŒ–è®¿é—®æ¶æ„](images/å•å…ƒåŒ–è®¿é—®æ¶æ„.png)
è¯¥æ¶æ„å¯æœ‰æ•ˆè§£å†³å…¨è¿æ¥è®¿é—®æ¶æ„å­˜åœ¨çš„é—®é¢˜ï¼š

- å„ä¸ªå¾®æœåŠ¡å®ä¾‹ä¹‹é—´äº’ç›¸éš”ç¦»ï¼Œå½¢æˆç‹¬ç«‹éƒ¨ç½²å•å…ƒï¼ŒæŸä¸€åˆ†åº“æ•…éšœï¼Œåªä¼šå½±å“è®¿é—®è¯¥åˆ†åº“çš„æœåŠ¡ï¼Œç³»ç»Ÿæ•´ä½“ä»å¯ç”¨ï¼Œæ•…éšœéš”ç¦»æ•ˆæœå¥½ï¼›

- ç”±äºè¿æ¥æ•°æ®åº“çš„å®ä¾‹æ•°å˜å°‘ï¼Œåœ¨å¾®æœåŠ¡å®ä¾‹ä¸ªæ•°ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå¯æœ‰æ•ˆé™ä½å•ä¸ªæ•°æ®åº“çš„æ€»è¿æ¥æ•°ã€‚

### æ•°æ®åº“ç°åº¦æ¨¡å‹
åº”ç”¨åšç°åº¦å‘å¸ƒè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°æ•°æ®åº“çš„å˜æ›´ï¼Œæ˜¯æ¯”è¾ƒå¸¸è§çš„è¡Œä¸ºã€‚æ­¤æ—¶æˆ‘ä»¬å»ºè®®ï¼Œå½“æ•°æ®åº“å±‚é¢å˜æ›´è¾ƒå°æ—¶ï¼Œå¯ä»¥å‚è€ƒä¸‹åˆ—æ–¹æ³•åšç°åº¦å˜æ›´ã€‚è€Œå½“æ•°æ®åº“å±‚é¢å˜æ›´è¾ƒå¤§æ—¶ï¼Œå¦‚æ‰§è¡Œç°åº¦å‘å¸ƒè¾ƒä¸ºå›°éš¾ï¼Œå¯ä¸é‡‡ç”¨ç°åº¦å‘å¸ƒã€‚

å½“åº”ç”¨å‘å¸ƒçš„èŒƒå›´æ¶‰åŠåˆ°äº†æ•°æ®åº“å±‚é¢çš„å˜åŒ–ï¼Œä¾‹å¦‚æ•°æ®åº“è¡¨æ–°å¢äº†ä¸€ä¸ªå­—æ®µï¼Œä½¿å¾—æ–°æ—§ç‰ˆæœ¬æ•°æ®åº“çš„è¡¨å­—æ®µä¸ä¸€è‡´ï¼Œå¦‚æœæ–°ç‰ˆæœ¬çš„SQLè¯­å¥ä½¿ç”¨åˆ°äº†æ–°çš„å­—æ®µï¼Œé‚£ä¹ˆå¯¹æ–°ç‰ˆæœ¬åšç°åº¦éªŒè¯æ—¶ï¼Œä¸èƒ½åœ¨è€ç‰ˆæœ¬çš„æ•°æ®åº“è¿›è¡Œä¿®æ”¹ã€‚

ä¸ºäº†è§£å†³è¯¥é—®é¢˜å¯ä»¥é‡‡ç”¨ä¸¤ç±»æ–¹æ¡ˆï¼š
#### æ–¹æ¡ˆä¸€ï¼šå˜æ›´å‘åå…¼å®¹

è¯¥æ–¹æ¡ˆè¾ƒå®¹æ˜“å®ç°ï¼Œéœ€è¦æ•°æ®åº“çš„å˜æ›´å…¼å®¹æ—§ç‰ˆæœ¬åº”ç”¨ã€‚æ­¤æ—¶ï¼Œæ—§ç‰ˆæœ¬åº”ç”¨ä¾ç„¶å¯ä»¥æ­£å¸¸è®¿é—®æ–°ç‰ˆæœ¬æ•°æ®åº“ã€‚åœ¨æ•°æ®åº“æ¥æ”¶ç°åº¦åº”ç”¨æµé‡å‰å®Œæˆæ•°æ®åº“å˜æ›´ï¼Œç°åº¦åº”ç”¨éƒ¨ç½²åä¹Ÿå¯ä»¥æ­£å¸¸è®¿é—®æ–°ç‰ˆæœ¬æ•°æ®åº“ã€‚

ä¸æ˜¯æ‰€æœ‰æ•°æ®åº“å˜æ›´éƒ½å¯ä»¥å‘åå…¼å®¹ï¼Œéœ€è¦å…·ä½“åˆ†æå˜æ›´å†…å®¹ã€‚ä»¥å¸¸è§çš„æ–°å¢å­—æ®µã€åˆ é™¤å­—æ®µã€ä¿®æ”¹å­—æ®µä¸ºä¾‹ï¼Œæ–°å¢å­—æ®µåœºæ™¯ä¸€èˆ¬å‘åå…¼å®¹ï¼Œéœ€è¦æ³¨æ„"INSERT "è¯­å¥å¦‚æœæœªå£°æ˜æ’å…¥çš„å­—æ®µå¯èƒ½ä¼šå¼•å…¥é—®é¢˜ï¼›åˆ é™¤å­—æ®µæ—¶ï¼Œå¯åœ¨ç°åº¦å‘å¸ƒé˜¶æ®µæš‚ç¼“ï¼Œç­‰ç°åº¦å‘å¸ƒå®Œæˆåå†è¡Œåˆ é™¤ï¼›ä¿®æ”¹å­—æ®µå¯ä»¥æ‹†åˆ†ä¸ºæ–°å¢å­—æ®µå’Œåˆ é™¤å­—æ®µä¸¤ä¸ªæ­¥éª¤ï¼ŒåŒæ ·å¯ä»¥è§£å†³ã€‚

#### æ–¹æ¡ˆäºŒï¼šç°åº¦æ•°æ®ç‹¬ç«‹
è¯¥æ–¹æ¡ˆå®ç°è¾ƒä¸ºå¤æ‚ï¼Œéœ€è¦å•ç‹¬ç»´æŠ¤ä¸€ä»½ç°åº¦æ•°æ®ï¼Œä¾‹å¦‚ç°åº¦åº“æˆ–è€…ç°åº¦è¡¨ã€‚

ä½¿ç”¨ç°åº¦åº“æ—¶ï¼Œéœ€è¦å•ç‹¬ç»´æŠ¤ä¸€å¥—ç‹¬ç«‹çš„ç°åº¦åº“ï¼Œç°åº¦åº”ç”¨ä¼šè¿æ¥ç°åº¦åº“å»è®¿é—®ï¼Œä»¥è¾¾åˆ°æ•°æ®å’Œæ­£å¼åº“çš„éš”ç¦»æ•ˆæœï¼›ç°åº¦è¡¨ä¸ç°åº¦åº“æ–¹æ¡ˆè¾ƒä¸ºç›¸ä¼¼ï¼Œåªæ˜¯å°†ç»´æŠ¤çš„ç²’åº¦ç¼©å°åˆ°å…·ä½“çš„è¡¨ã€‚

ä¸¤ç±»æ–¹æ¡ˆä¸­æ›´æ¨èé‡‡ç”¨ç¬¬ä¸€ç±»æ–¹æ¡ˆï¼Œå˜æ›´å‘åå…¼å®¹çš„å®ç°æ–¹å¼æ›´ä¸ºç®€å•ã€‚å…¶ä»–æŸ¥è¯¢ç±»äº‘æœåŠ¡ä¹Ÿå¯ä»¥é‡‡ç”¨ç±»ä¼¼çš„æ–¹å¼æ¥å®ç°ç°åº¦èƒ½åŠ›ã€‚

### æ•°æ®åº“è¡¨å˜æ›´ç°åº¦æ–¹æ¡ˆè®¾è®¡ï¼ˆå­—æ®µæ–°å¢/åˆ é™¤ï¼‰
#### ä¸€ã€ç°åº¦å‘å¸ƒæ ¸å¿ƒåŸåˆ™

1. **æœ€å°å½±å“åŸåˆ™**ï¼šåœ¨æ»¡è¶³éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œå°½å¯èƒ½å°‘å˜æ›´å­—æ®µ
2. **å¯å›æ»šåŸåˆ™**ï¼šç¡®ä¿æ¯ä¸€æ­¥æ“ä½œéƒ½å¯é€†
3. **å…¼å®¹æ€§åŸåˆ™**ï¼šä¿è¯æ–°æ—§ç‰ˆæœ¬ä»£ç å…¼å®¹è¿è¡Œ

#### äºŒã€å­—æ®µæ–°å¢ç°åº¦æ–¹æ¡ˆ

##### æ ‡å‡†æµç¨‹ï¼ˆæ¨èï¼‰

```mermaid
graph TD
    A[è¯„ä¼°å½±å“] --> B[å‡†å¤‡SQL]
    B --> C[é¢„å‘ç¯å¢ƒéªŒè¯]
    C --> D[ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œ]
    D --> E[åº”ç”¨ç°åº¦å‘å¸ƒ]
    E --> F[å…¨é‡å‘å¸ƒ]
```

##### å…·ä½“æ­¥éª¤

1. **è¯„ä¼°é˜¶æ®µ**
    - ç¡®è®¤å­—æ®µå¿…è¦æ€§
    - ç¡®å®šé»˜è®¤å€¼ç­–ç•¥ï¼ˆNULL/é»˜è®¤å€¼ï¼‰
    - è¯„ä¼°ç´¢å¼•éœ€æ±‚

2. **SQLå‡†å¤‡**
   ```sql
   -- æ ‡å‡†æ·»åŠ è¯­æ³•ï¼ˆOracleç¤ºä¾‹ï¼‰
   ALTER TABLE è¡¨å ADD (
     æ–°å­—æ®µå æ•°æ®ç±»å‹ [DEFAULT é»˜è®¤å€¼] [NULL/NOT NULL]
   );
   
   -- ç¤ºä¾‹ï¼šæ·»åŠ å¯ç©ºå­—æ®µ
   ALTER TABLE users ADD (
     mobile VARCHAR2(20) NULL
   );
   ```

3. **ç°åº¦ç­–ç•¥**
    - **ç¬¬ä¸€é˜¶æ®µ**ï¼šä»…æ‰§è¡ŒDDLï¼Œä¸ä¿®æ”¹åº”ç”¨ä»£ç 
    - **ç¬¬äºŒé˜¶æ®µ**ï¼š10%æµé‡ä½¿ç”¨æ–°å­—æ®µ
    - **ç¬¬ä¸‰é˜¶æ®µ**ï¼š50%æµé‡ä½¿ç”¨æ–°å­—æ®µ
    - **ç¬¬å››é˜¶æ®µ**ï¼šå…¨é‡ä½¿ç”¨æ–°å­—æ®µ

4. **å›æ»šæ–¹æ¡ˆ**
   ```sql
   -- å¦‚æœå‘ç°ä¸¥é‡é—®é¢˜
   ALTER TABLE è¡¨å DROP COLUMN æ–°å­—æ®µå;
   ```

#### ä¸‰ã€å­—æ®µåˆ é™¤ç°åº¦æ–¹æ¡ˆ

##### æ ‡å‡†æµç¨‹ï¼ˆå¿…é¡»è°¨æ…ï¼‰

```mermaid
graph TD
    A[ç¡®è®¤å­—æ®µæ— ä¾èµ–] --> B[åº”ç”¨ä»£ç å…¼å®¹æ”¹é€ ]
    B --> C[ç°åº¦å‘å¸ƒæ–°ä»£ç ]
    C --> D[ç¡®è®¤æ—¥å¿—æ— æŠ¥é”™]
    D --> E[æ‰§è¡ŒDDLåˆ é™¤]
```

##### å…·ä½“æ­¥éª¤

1. **è¯„ä¼°é˜¶æ®µ**
    - ç¡®è®¤æ‰€æœ‰åº”ç”¨ä¸å†ä½¿ç”¨è¯¥å­—æ®µ
    - æ£€æŸ¥å¤–é”®ã€ç´¢å¼•ã€è§†å›¾ç­‰ä¾èµ–å¯¹è±¡
    - å¤‡ä»½å¾…åˆ é™¤å­—æ®µæ•°æ®ï¼ˆå¦‚éœ€ï¼‰

2. **ä»£ç æ”¹é€ **
    - å…ˆä¿®æ”¹ä»£ç ä¸å†ä½¿ç”¨è¯¥å­—æ®µ
    - ä¿æŒå…¼å®¹è¯»å–ï¼ˆSELECTè¯­å¥ä¸æŠ¥é”™ï¼‰

3. **åˆ†é˜¶æ®µæ‰§è¡Œ**
    - **é˜¶æ®µ1**ï¼šå‘å¸ƒä¸ä¾èµ–è¯¥å­—æ®µçš„åº”ç”¨ç‰ˆæœ¬
    - **é˜¶æ®µ2**ï¼šç›‘æ§è‡³å°‘2ä¸ªå®Œæ•´ä¸šåŠ¡å‘¨æœŸ
    - **é˜¶æ®µ3**ï¼šç¡®è®¤æ— æŠ¥é”™åæ‰§è¡Œåˆ é™¤

4. **åˆ é™¤SQL**
   ```sql
   -- Oracleåˆ é™¤è¯­æ³•
   ALTER TABLE è¡¨å DROP COLUMN å­—æ®µå [CASCADE CONSTRAINTS];
   
   -- ç¤ºä¾‹ï¼ˆå¸¦çº¦æŸæ£€æŸ¥ï¼‰
   ALTER TABLE users DROP COLUMN old_phone CASCADE CONSTRAINTS;
   ```

5. **å›æ»šæ–¹æ¡ˆ**
   ```sql
   -- åªèƒ½é€šè¿‡å¤‡ä»½æ¢å¤æˆ–é‡æ–°æ·»åŠ å­—æ®µ
   ALTER TABLE è¡¨å ADD (
     å·²åˆ å­—æ®µå åŸæ•°æ®ç±»å‹
   );
   -- ç„¶åä»å¤‡ä»½æ¢å¤æ•°æ®
   ```

##### å®‰å…¨åˆ é™¤ç­–ç•¥

**ç­–ç•¥1**ï¼šæ ‡è®°åºŸå¼ƒè€Œéç«‹å³åˆ é™¤
```sql
-- 1. å…ˆé‡å‘½åå­—æ®µï¼ˆä¿ç•™3ä¸ªæœˆï¼‰
ALTER TABLE è¡¨å RENAME COLUMN å¾…åˆ å­—æ®µå TO åºŸå¼ƒ_å­—æ®µå;

-- 2. ç¡®è®¤æ— é—®é¢˜åå†åˆ é™¤
```


#### å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†

#### åœºæ™¯1ï¼šå¤§è¡¨å˜æ›´ï¼ˆäº¿çº§æ•°æ®ï¼‰
**æ–¹æ¡ˆ**ï¼š
1. ä½¿ç”¨åœ¨çº¿DDLå·¥å…·ï¼ˆå¦‚Oracleçš„DBMS_REDEFINITIONï¼‰
2. åˆ†æ‰¹æ¬¡æ›´æ–°
3. åœ¨ä»åº“å…ˆæ‰§è¡Œï¼Œç„¶åä¸»ä»åˆ‡æ¢

#### åœºæ™¯2ï¼šå…³é”®ä¸šåŠ¡è¡¨å˜æ›´
**æ–¹æ¡ˆ**ï¼š
1. åˆ›å»ºå½±å­è¡¨è¿›è¡ŒåŒå†™
2. é€æ­¥è¿ç§»è¯»è¯·æ±‚åˆ°æ–°è¡¨
3. æœ€ç»ˆåˆ‡æ¢è¡¨å

```sql
-- æœ€ç»ˆåˆ‡æ¢ç¤ºä¾‹
BEGIN
   EXECUTE IMMEDIATE 'RENAME è¡¨å TO è¡¨å_old';
   EXECUTE IMMEDIATE 'RENAME è¡¨å_new TO è¡¨å';
END;
```


### Oracleæ•°æ®åº“ç¢ç‰‡åŒ–å¤„ç†æŒ‡å—
Oracleæ•°æ®åº“ç¢ç‰‡åŒ–ä¸»è¦åˆ†ä¸ºè¡¨ç¢ç‰‡ã€ç´¢å¼•ç¢ç‰‡å’Œè¡¨ç©ºé—´ç¢ç‰‡ä¸‰ç§ç±»å‹ã€‚ä»¥ä¸‹æ˜¯é’ˆå¯¹Oracleæ•°æ®åº“çš„ç¢ç‰‡åŒ–å¤„ç†æ–¹æ³•ï¼š

#### ä¸€ã€ç¢ç‰‡æ£€æµ‹æ–¹æ³•

##### 1. è¡¨ç¢ç‰‡æ£€æµ‹
```sql
-- æ£€æŸ¥è¡¨çš„é«˜æ°´ä½çº¿(HWM)å’Œå®é™…ä½¿ç”¨æƒ…å†µ
SELECT table_name, 
       ROUND((blocks * 8), 2) "é«˜æ°´ä½çº¿(KB)",
       ROUND((num_rows * avg_row_len / 1024), 2) "å®é™…ä½¿ç”¨(KB)",
       ROUND((blocks * 8), 2) - ROUND((num_rows * avg_row_len / 1024), 2) "æµªè´¹ç©ºé—´(KB)"
FROM user_tables 
WHERE table_name = 'è¡¨å';
```

##### 2. ç´¢å¼•ç¢ç‰‡æ£€æµ‹
```sql
-- æ£€æŸ¥ç´¢å¼•ç¢ç‰‡æƒ…å†µ
SELECT index_name, 
       ROUND(100 * del_lf_rows / lf_rows, 2) "ç¢ç‰‡ç‡(%)" 
FROM index_stats 
WHERE lf_rows > 0;
```

##### 3. è¡¨ç©ºé—´ç¢ç‰‡æ£€æµ‹
```sql
-- æ£€æŸ¥è¡¨ç©ºé—´ç¢ç‰‡æƒ…å†µ
SELECT tablespace_name, 
       COUNT(*) "ç¢ç‰‡æ•°é‡",
       MAX(block_id) - MIN(block_id) + 1 "æ€»å—æ•°",
       SUM(bytes)/1024/1024 "æ€»å¤§å°(MB)",
       (MAX(block_id) - MIN(block_id) + 1 - COUNT(*)) / (MAX(block_id) - MIN(block_id) + 1) * 100 "ç¢ç‰‡ç‡(%)"
FROM dba_free_space
GROUP BY tablespace_name
ORDER BY 5 DESC;
```

#### äºŒã€ç¢ç‰‡å¤„ç†æ–¹æ³•

##### 1. è¡¨ç¢ç‰‡å¤„ç†
```sql
-- æ–¹æ³•1ï¼šç§»åŠ¨è¡¨é‡å»º(ä¼šé‡å»ºæ‰€æœ‰ç´¢å¼•)
ALTER TABLE è¡¨å MOVE TABLESPACE è¡¨ç©ºé—´å;

-- æ–¹æ³•2ï¼šåœ¨çº¿é‡å®šä¹‰(ä¸å½±å“ä¸šåŠ¡)
BEGIN
  DBMS_REDEFINITION.start_redef_table(
    uname => 'ç”¨æˆ·å',
    orig_table => 'åŸè¡¨å',
    int_table => 'ä¸­é—´è¡¨å');
  DBMS_REDEFINITION.finish_redef_table(
    uname => 'ç”¨æˆ·å',
    orig_table => 'åŸè¡¨å',
    int_table => 'ä¸­é—´è¡¨å');
END;
/

-- æ–¹æ³•3ï¼šæ”¶ç¼©è¡¨(éœ€è¦å¼€å¯è¡Œç§»åŠ¨)
ALTER TABLE è¡¨å ENABLE ROW MOVEMENT;
ALTER TABLE è¡¨å SHRINK SPACE CASCADE;
```

##### 2. ç´¢å¼•ç¢ç‰‡å¤„ç†
```sql
-- æ–¹æ³•1ï¼šé‡å»ºç´¢å¼•
ALTER INDEX ç´¢å¼•å REBUILD TABLESPACE è¡¨ç©ºé—´å;

-- æ–¹æ³•2ï¼šè”æœºé‡å»ºç´¢å¼•(10gåŠä»¥ä¸Š)
ALTER INDEX ç´¢å¼•å REBUILD ONLINE;

-- æ–¹æ³•3ï¼šåˆå¹¶ç´¢å¼•ç¢ç‰‡
ALTER INDEX ç´¢å¼•å COALESCE;
```

##### 3. è¡¨ç©ºé—´ç¢ç‰‡å¤„ç†
```sql
-- æ–¹æ³•1ï¼šé‡ç»„è¡¨ç©ºé—´(éœ€è¦åœæœº)
-- å¯¼å‡ºæ‰€æœ‰å¯¹è±¡ï¼Œåˆ é™¤è¡¨ç©ºé—´ï¼Œé‡å»ºè¡¨ç©ºé—´ï¼Œå¯¼å…¥æ•°æ®

-- æ–¹æ³•2ï¼šä½¿ç”¨å¯ä¼ è¾“è¡¨ç©ºé—´
-- é€‚ç”¨äºå¤§è¡¨ç©ºé—´çš„é‡ç»„
```

#### ä¸‰ã€è‡ªåŠ¨ç»´æŠ¤ç­–ç•¥

##### 1. å®šæœŸæ”¶é›†ç»Ÿè®¡ä¿¡æ¯
```sql
-- è‡ªåŠ¨æ”¶é›†ç»Ÿè®¡ä¿¡æ¯(é»˜è®¤å·²å¼€å¯)
-- æ‰‹åŠ¨æ”¶é›†ï¼š
EXEC DBMS_STATS.GATHER_SCHEMA_STATS('ç”¨æˆ·å', estimate_percent=>DBMS_STATS.AUTO_SAMPLE_SIZE);
```

##### 2. è®¾ç½®è‡ªåŠ¨æ®µç©ºé—´ç®¡ç†
```sql
-- åˆ›å»ºè¡¨ç©ºé—´æ—¶æŒ‡å®šè‡ªåŠ¨æ®µç©ºé—´ç®¡ç†
CREATE TABLESPACE è¡¨ç©ºé—´å 
DATAFILE 'æ•°æ®æ–‡ä»¶è·¯å¾„' SIZE å¤§å°
EXTENT MANAGEMENT LOCAL 
SEGMENT SPACE MANAGEMENT AUTO;
```

##### 3. å®šæœŸæ‰§è¡Œç¢ç‰‡æ•´ç†è„šæœ¬
```sql
-- è‡ªåŠ¨æ£€æµ‹å¹¶é‡å»ºé«˜ç¢ç‰‡ç‡å¯¹è±¡
-- å¯ç»“åˆDBMS_SCHEDULERåˆ›å»ºå®šæœŸä»»åŠ¡
```

#### å››ã€æ³¨æ„äº‹é¡¹

1. **æ“ä½œæ—¶é—´çª—å£**ï¼šMOVEå’ŒREBUILDæ“ä½œä¼šé”è¡¨ï¼Œå»ºè®®åœ¨ç»´æŠ¤çª—å£è¿›è¡Œ
2. **ç©ºé—´éœ€æ±‚**ï¼šé‡å»ºæ“ä½œéœ€è¦é¢å¤–ç©ºé—´ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´
3. **æƒé™è¦æ±‚**ï¼šéœ€è¦ç›¸åº”ç³»ç»Ÿæƒé™
4. **ä¾èµ–å¯¹è±¡**ï¼šé‡å»ºè¡¨ä¼šå¯¼è‡´æ‰€æœ‰ä¾èµ–å¯¹è±¡å¤±æ•ˆï¼Œéœ€è¦é‡æ–°ç¼–è¯‘
5. **RACç¯å¢ƒ**ï¼šåœ¨RACç¯å¢ƒä¸­éœ€ç‰¹åˆ«æ³¨æ„é”å®šæœºåˆ¶

#### äº”ã€é¢„é˜²æªæ–½

1. åˆç†è®¾ç½®PCTFREEå’ŒPCTUSEDå‚æ•°
2. ä½¿ç”¨æœ¬åœ°ç®¡ç†çš„è¡¨ç©ºé—´(LMT)
3. å¯ç”¨è‡ªåŠ¨æ®µç©ºé—´ç®¡ç†(ASSM)
4. å®šæœŸç»´æŠ¤å’Œç›‘æ§
5. å¯¹å¤§è¡¨è€ƒè™‘ä½¿ç”¨åˆ†åŒºè¡¨

é€šè¿‡ä»¥ä¸Šæ–¹æ³•å¯ä»¥æœ‰æ•ˆç®¡ç†å’Œå‡å°‘Oracleæ•°æ®åº“ä¸­çš„ç¢ç‰‡ï¼Œä¿æŒæ•°æ®åº“æ€§èƒ½ç¨³å®šã€‚

### æ•°æ®åº“å¤§äº‹åŠ¡å’Œé•¿äº‹åŠ¡
åœ¨æ•°æ®åº“ä¸­ï¼Œ**å¤§äº‹åŠ¡**ï¼ˆLarge Transactionï¼‰å’Œ**é•¿äº‹åŠ¡**ï¼ˆLong Transactionï¼‰æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œå®ƒä»¬æœ‰ä¸åŒçš„å…³æ³¨ç‚¹å’Œå½±å“ã€‚

#### 1. å¤§äº‹åŠ¡ï¼ˆLarge Transactionï¼‰

å¤§äº‹åŠ¡é€šå¸¸æ˜¯æŒ‡é‚£äº›æ¶‰åŠå¤§é‡æ•°æ®æ“ä½œçš„äº‹åŠ¡ï¼Œé€šå¸¸æ˜¯ **æ•°æ®é‡è¾ƒå¤§** æˆ– **æ“ä½œå¤æ‚çš„äº‹åŠ¡**ã€‚è¿™ç±»äº‹åŠ¡å¯èƒ½åŒ…å«å¾ˆå¤šæ›´æ–°ã€æ’å…¥ã€åˆ é™¤ç­‰æ“ä½œï¼Œæˆ–è€…æ¶‰åŠå¾ˆå¤šè¡¨çš„æ•°æ®ã€‚å¸¸è§çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼š

* **æ•°æ®é‡å¤§**ï¼šæ¶‰åŠçš„æ•°æ®è¡Œæ•°å¤šï¼Œæˆ–è€…å•ä¸ªæ“ä½œçš„æ•°æ®é‡éå¸¸å¤§ã€‚
* **I/O å¼€é”€é«˜**ï¼šå› ä¸ºå¤„ç†çš„æ•°æ®é‡å¤§ï¼Œå¯¼è‡´ç£ç›˜è¯»å†™æ“ä½œé¢‘ç¹ã€‚
* **é”èµ„æºå¤š**ï¼šä¼šå ç”¨æ›´å¤šçš„é”èµ„æºï¼Œå¯èƒ½ä¼šå½±å“å¹¶å‘æ‰§è¡Œï¼Œå¯¼è‡´å…¶ä»–äº‹åŠ¡çš„ç­‰å¾…ã€‚
* **å¯èƒ½å¯¼è‡´æ€§èƒ½ç“¶é¢ˆ**ï¼šäº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ¶ˆè€—è¾ƒå¤šçš„ç³»ç»Ÿèµ„æºï¼ˆCPUã€å†…å­˜ã€I/Oç­‰ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿæ€§èƒ½ä¸‹é™ã€‚

##### åˆ¤æ–­æ¡ä»¶
åŸºäºè¿‡å»24å°æ—¶æ•°æ®ï¼Œå¯¹OLTPç³»ç»Ÿäº‹åŠ¡æ‰§è¡Œä½¿ç”¨å›æ»šæ®µè¶…è¿‡6400å—ï¼ˆå³å¯¹äºé»˜è®¤8kçš„æ•°æ®å—å¤§å°ï¼Œäº‹åŠ¡äº§ç”Ÿè¶…è¿‡50Mçš„å›æ»šè®°å½•ï¼‰çš„SQLè¯­å¥å°†ç”Ÿæˆå¤§äº‹åŠ¡é—®é¢˜ã€‚

##### ä¼˜åŒ–å»ºè®®ï¼š
- å°†å¤æ‚å¤§äº‹åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªå°çš„æ‰¹å¤„ç†äº‹åŠ¡ï¼Œæ¯”å¦‚æ¯1ä¸‡æ¡è®°å½•å°±æäº¤ä¸€æ¬¡ï¼›
- GCHç»“åˆä¸šåŠ¡äº‹åŠ¡ç‰¹æ€§æ§åˆ¶æ‰¹å¤„ç†äº‹åŠ¡çš„å¤§å°ã€‚

#### 2. é•¿äº‹åŠ¡ï¼ˆLong Transactionï¼‰

é•¿äº‹åŠ¡æ˜¯æŒ‡äº‹åŠ¡ **æŒç»­çš„æ—¶é—´è¾ƒé•¿**ï¼Œé€šå¸¸ç”±äºæŸäº›åŸå› ï¼Œè¯¥äº‹åŠ¡æœªèƒ½åŠæ—¶æäº¤æˆ–å›æ»šã€‚é•¿äº‹åŠ¡çš„ç‰¹ç‚¹æ˜¯ï¼š

* **æ‰§è¡Œæ—¶é—´é•¿**ï¼šäº‹åŠ¡å¯èƒ½ä¼šå ç”¨æ•°æ®åº“è¿æ¥å’Œèµ„æºå¾ˆé•¿æ—¶é—´ï¼Œé€ æˆé˜»å¡ã€‚
* **èµ„æºå ç”¨**ï¼šé•¿æ—¶é—´æŒæœ‰é”ï¼Œå¯èƒ½ä¼šé˜»æ­¢å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œï¼Œå¯¼è‡´**æ­»é”**æˆ–**é”ç«äº‰**é—®é¢˜ã€‚
* **æ—¥å¿—æ–‡ä»¶å¢å¤§**ï¼šç”±äºäº‹åŠ¡æ²¡æœ‰åŠæ—¶æäº¤ï¼Œä¼šå¢åŠ æ•°æ®åº“çš„æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œå¯èƒ½å½±å“æ•°æ®åº“çš„æ€§èƒ½å’Œå­˜å‚¨ç©ºé—´ã€‚
* **å½±å“å¯ç”¨æ€§**ï¼šé•¿äº‹åŠ¡ä¼šå½±å“æ•°æ®åº“çš„å“åº”æ—¶é—´ï¼Œé™ä½å¹¶å‘èƒ½åŠ›ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½ç“¶é¢ˆã€‚

##### åˆ¤æ–­æ¡ä»¶ï¼š
åŸºäºè¿‡å»24å°æ—¶æ•°æ®ï¼Œå¯¹OLTPç³»ç»Ÿäº‹åŠ¡æ‰§è¡Œè¶…è¿‡2åˆ†é’Ÿçš„SQLè¯­å¥å°†ç”Ÿæˆé•¿äº‹åŠ¡é—®é¢˜ã€‚

##### ä¼˜åŒ–å»ºè®®
- äº‹åŠ¡åŠæ—¶æäº¤ï¼›
- å¯¹è¢«é˜»å¡çš„äº‹åŠ¡ï¼Œç»“åˆåº”ç”¨åˆ†æå¤„ç†é˜»å¡æºå¤´ï¼ˆKILLæ‰é˜»å¡çš„ä¼šè¯æˆ–å‚¬ä¿ƒé˜»å¡ä¼šè¯æäº¤ç­‰æ–¹å¼ï¼‰ï¼Œé‡Šæ”¾é˜»å¡èµ„æºï¼›
- å¦‚æœäº‹åŠ¡æ‰§è¡Œçš„ç¡®éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œè¯·ç»“åˆä¸šåŠ¡çš„äº‹åŠ¡ç‰¹æ€§ï¼Œé€šè¿‡æ‹†åˆ†äº‹åŠ¡ã€ä¼˜åŒ–äº‹åŠ¡SQLã€ä¼˜åŒ–äº‹åŠ¡å¯¹è±¡ç­‰æ–¹å¼æé«˜äº‹åŠ¡æ‰§è¡Œæ•ˆç‡ã€‚

#### æ€»ç»“åŒºåˆ«

* **å¤§äº‹åŠ¡**ä¾§é‡äº**æ“ä½œçš„æ•°æ®é‡**ï¼Œå®ƒå¯èƒ½åŒ…å«å¤§é‡çš„æ•°æ®æ›´æ–°æˆ–æ’å…¥ï¼Œä¸”é€šå¸¸ä¼šæ¶ˆè€—å¤§é‡çš„ç³»ç»Ÿèµ„æºã€‚
* **é•¿äº‹åŠ¡**ä¾§é‡äº**äº‹åŠ¡çš„æŒç»­æ—¶é—´**ï¼Œå³äº‹åŠ¡å ç”¨æ•°æ®åº“èµ„æºçš„æ—¶é—´è¾ƒé•¿ï¼Œå¯èƒ½æ˜¯ç”±äºç½‘ç»œå»¶è¿Ÿã€ä¸šåŠ¡é€»è¾‘å¤æ‚æˆ–äººä¸ºå› ç´ å¯¼è‡´äº‹åŠ¡æœªåŠæ—¶æäº¤ã€‚

### æ…¢SQLé—®é¢˜
#### åˆ¤æ–­æ¡ä»¶
åŸºäºT-1æ—¥ä¸šåŠ¡æ—¶æ®µï¼ˆ08:00-20:00ï¼‰çš„æ•°æ®ï¼Œå¯¹OLTPç³»ç»Ÿå¹³å‡æ‰§è¡Œæ—¶é—´è¶…è¿‡2ç§’ä¸”æ‰§è¡Œè¶…è¿‡100æ¬¡çš„é«˜é¢‘SQLè¯­å¥ï¼Œæˆ–å•æ¬¡æ‰§è¡Œæ—¶é—´è¶…è¿‡50ç§’çš„SQLè¯­å¥ï¼Œå°†ç”Ÿæˆæ…¢SQLé—®é¢˜ã€‚

#### é—®é¢˜çº§åˆ«
- é«˜ï¼ˆæ€»æ‰§è¡Œæ¬¡æ•°>=100000ï¼‰ï¼›
- ä¸­ï¼ˆæ€»æ‰§è¡Œæ¬¡æ•°>=10000 ä¸” æ€»æ‰§è¡Œæ¬¡æ•°<100000ï¼‰ï¼›
- ä½ï¼ˆæ€»æ‰§è¡Œæ¬¡æ•°<10000ï¼‰ã€‚

#### ä¼˜åŒ–å»ºè®®
- å¦‚æœSQLæœ‰å¤šä¸ªæ‰§è¡Œè®¡åˆ’ï¼Œæ‰§è¡Œè®¡åˆ’å‘ç”Ÿå˜åŒ–ï¼Œå¯è€ƒè™‘ç»‘å®šæ‰§è¡Œè®¡åˆ’æˆ–ä½¿ç”¨hintç­‰ä¼˜åŒ–æ–¹å¼ï¼›
- ä¼˜åŒ–æ•°æ®åº“å¯¹è±¡è®¾è®¡ã€æ”¹å†™SQLã€ä¼˜åŒ–ä¸šåŠ¡é€»è¾‘ã€‚

### å¹³å‡è¿”å›è¡Œæ•°è¿‡å¤š
#### é—®é¢˜åˆ¤æ–­æ¡ä»¶
åŸºäºT-1æ—¥ä¸šåŠ¡æ—¶æ®µï¼ˆ08:00-20:00ï¼‰çš„æ•°æ®ï¼Œåˆ†æOLTPç³»ç»Ÿæ‰§è¡Œè¾ƒé¢‘ç¹çš„SQLï¼ˆæ‰§è¡Œæ¬¡æ•°è¶…è¿‡100æ¬¡ä¸”å¹³å‡æ‰§è¡Œæ—¶é—´è¶…è¿‡100msï¼‰ï¼Œå¯¹äºå¹³å‡è¿”å›è¡Œæ•°è¶…è¿‡100çš„SQLè¯­å¥å°†ç”Ÿæˆå¹³å‡è¿”å›è¡Œæ•°è¿‡å¤šé—®é¢˜ã€‚

#### é—®é¢˜çº§åˆ«
- é«˜ï¼ˆå¹³å‡è¿”å›è¡Œæ•°>=100000ï¼‰ï¼›
- ä¸­ï¼ˆå¹³å‡è¿”å›è¡Œæ•°>=10000 ä¸” å¹³å‡è¿”å›è¡Œæ•°<100000ï¼‰ï¼›
- ä½ï¼ˆå¹³å‡è¿”å›è¡Œæ•°>100 ä¸” å¹³å‡è¿”å›è¡Œæ•°<10000ï¼‰ã€‚

#### ä¼˜åŒ–å»ºè®®
å¯¹äºæ­¤ç±»é«˜é¢‘ã€é«˜æ•°æ®è¿”å›çš„SQLï¼Œéœ€åˆ†æä¸šåŠ¡åœºæ™¯ï¼Œè¿›è¡Œåˆç†çš„ä¸šåŠ¡è®¾è®¡ã€‚å¦‚æœæ— æ³•é¿å…ä¸€æ¬¡æŸ¥è¯¢å¤§é‡æ•°æ®ï¼Œå¯è€ƒè™‘åˆ†é¡µæŸ¥è¯¢ã€‚

### ç»‘å®šå˜é‡è¿‡å¤šï¼ˆè¯­å¥è¿‡é•¿ï¼‰é—®é¢˜
#### åˆ¤æ–­æ¡ä»¶
åŸºäºè¿‡å»24å°æ—¶æ•°æ®ï¼Œç›‘æ§æŸ¥è¯¢è§†å›¾V$SQLTEXTï¼ŒSQLè¯­å¥çš„é•¿åº¦è¾¾åˆ°500åˆ†ç‰‡å°†ç”Ÿæˆç»‘å®šå˜é‡è¿‡å¤šæˆ–è¯­å¥è¿‡é•¿é—®é¢˜ã€‚

#### ä¼˜åŒ–å»ºè®®
- åº”ç”¨ç¨‹åºé¿å…åœ¨åŒä¸€ä¸ªç»‘å®šå˜é‡ä¸­ä¼ å…¥ä¸åŒæ•°æ®ç±»å‹æˆ–åŒæ•°æ®ç±»å‹ä¸åŒé•¿åº¦çš„å€¼ï¼Œä»è€Œå¯¼è‡´SQLè¯­å¥äº§ç”Ÿä¸å¿…è¦çš„è¿‡å¤šå­æ¸¸æ ‡ï¼›
- åº”ç”¨ç¨‹åºä¿®æ”¹SQLè¯­å¥å¤„ç†æ–¹å¼ï¼Œè§„é¿åœ¨SQLä¸­ä½¿ç”¨å¤§é‡ç»‘å®šå˜é‡ä»¥åŠPGAä½¿ç”¨è¿‡å¤šé—®é¢˜ã€‚ä¾‹å¦‚ï¼Œinsert into xx(â€¦) (select â€¦ from xxx â€¦)å¯ä»¥è€ƒè™‘é‡‡ç”¨insert into xx(â€¦) values(â€¦)çš„æ–¹å¼ï¼Œç»“åˆPreparedStatementçš„addBatch()æ–¹æ³•ï¼Œå¹¶åˆç†æ§åˆ¶æ‰¹æ¬¡å¤§å°æ¥è¿›è¡Œå¤„ç†ï¼›
- åº”ç”¨ç¨‹åºé¿å…åœ¨ä»£ç ä¸­æ ¹æ®å¤§é‡ä¸åŒæ¡ä»¶æ‹¼æ¥SQLï¼Œå¯¼è‡´SQLè¯­å¥è¿‡å¤šé—®é¢˜ã€‚

### äº§ç”Ÿå…¨è¡¨æ‰«æçš„åŸå› ï¼Ÿ
#### 1. **ç¼ºä¹æœ‰æ•ˆç´¢å¼•**
   - æŸ¥è¯¢æ¡ä»¶åˆ—æ²¡æœ‰å»ºç«‹ç´¢å¼•
   - ç°æœ‰ç´¢å¼•ä¸åŒ¹é…æŸ¥è¯¢æ¡ä»¶(å¦‚æœªéµå¾ªæœ€å·¦å‰ç¼€åŸåˆ™)

#### 2. **SQLç¼–å†™é—®é¢˜**
   - ä½¿ç”¨äº†`!=`ã€`NOT IN`ã€`NOT EXISTS`ç­‰å¦å®šæ“ä½œç¬¦
   - å¯¹ç´¢å¼•åˆ—ä½¿ç”¨äº†å‡½æ•°æˆ–è¿ç®—ï¼š`WHERE UPPER(name) = 'ABC'`
   - ä½¿ç”¨äº†`OR`æ¡ä»¶ä½†æœªä¼˜åŒ–ï¼š`WHERE col1 = 1 OR col2 = 2`
   - éšå¼ç±»å‹è½¬æ¢ï¼š`WHERE varchar_col = 123`(æ•°å­—ä¸å­—ç¬¦ä¸²æ¯”è¾ƒ)

#### 3. **æŸ¥è¯¢éœ€æ±‚ç‰¹æ€§**
   - ç¡®å®éœ€è¦è®¿é—®å¤§éƒ¨åˆ†æ•°æ®(å¦‚æŠ¥è¡¨æŸ¥è¯¢)
   - å°è¡¨æŸ¥è¯¢(ä¼˜åŒ–å™¨è®¤ä¸ºå…¨è¡¨æ‰«ææ¯”ç´¢å¼•æ›´å¿«)

#### 4. **ç»Ÿè®¡ä¿¡æ¯ä¸å‡†ç¡®**
   - è¡¨æ•°æ®é‡å˜åŒ–ä½†ç»Ÿè®¡ä¿¡æ¯æœªæ›´æ–°
   - ç›´æ–¹å›¾ç¼ºå¤±å¯¼è‡´ä¼˜åŒ–å™¨è¯¯åˆ¤


### å¦‚ä½•è§£å†³å…¨è¡¨æ‰«æé—®é¢˜

#### ä¸€ã€ç´¢å¼•ä¼˜åŒ–
1. **åˆ›å»ºåˆé€‚ç´¢å¼•**
   - ä¸ºé«˜é¢‘æŸ¥è¯¢æ¡ä»¶åˆ›å»ºç´¢å¼•
   - å¯¹å¤åˆæŸ¥è¯¢åˆ›å»ºç»„åˆç´¢å¼•ï¼Œæ³¨æ„åˆ—é¡ºåº

2. **ä½¿ç”¨è¦†ç›–ç´¢å¼•**
   ```sql
   -- åŸæŸ¥è¯¢
   SELECT id, name FROM users WHERE age > 20;
   
   -- åˆ›å»ºè¦†ç›–ç´¢å¼•
   CREATE INDEX idx_age_name ON users(age, name);
   ```

#### äºŒã€SQLé‡å†™
1. **é¿å…å¦å®šæ“ä½œ**
   ```sql
   -- ä¸ä½³
   SELECT * FROM orders WHERE status != 'COMPLETED';
   
   -- æ”¹è¿›
   SELECT * FROM orders WHERE status IN ('PENDING', 'CANCELLED');
   ```

2. **é¿å…ç´¢å¼•åˆ—è¿ç®—**
   ```sql
   -- ä¸ä½³(ç´¢å¼•å¤±æ•ˆ)
   SELECT * FROM sales WHERE YEAR(sale_date) = 2023;
   
   -- æ”¹è¿›
   SELECT * FROM sales 
   WHERE sale_date BETWEEN '2023-01-01' AND '2023-12-31';
   ```

#### ä¸‰ã€æ•°æ®åº“ä¼˜åŒ–
1. **ä½¿ç”¨æŸ¥è¯¢æç¤º(Hint)**
   ```sql
   -- å¼ºåˆ¶ä½¿ç”¨ç´¢å¼•
   SELECT /*+ INDEX(users idx_age) */ * FROM users WHERE age > 20;
   ```

2. **åˆ†åŒºè¡¨è®¾è®¡**
   - å¯¹å¤§è¡¨æŒ‰èŒƒå›´/åˆ—è¡¨åˆ†åŒºï¼Œå‡å°‘æ‰«æèŒƒå›´

3. **æ›´æ–°ç»Ÿè®¡ä¿¡æ¯**
   ```sql
   ANALYZE TABLE users COMPUTE STATISTICS;
   -- æˆ–
   EXEC DBMS_STATS.GATHER_TABLE_STATS('SCHEMA', 'TABLE');
   ```

### ä½•æ—¶å…è®¸å…¨è¡¨æ‰«æï¼Ÿ

1. æŸ¥è¯¢éœ€è¦è®¿é—®è¶…è¿‡20-30%çš„è¡¨æ•°æ®æ—¶
2. è¡¨æœ¬èº«æ•°æ®é‡å¾ˆå°ï¼ˆå¦‚å°äº1000è¡Œï¼‰
3. æ•°æ®ä»“åº“/æŠ¥è¡¨æŸ¥è¯¢ç­‰åˆ†æå‹åœºæ™¯

é€šè¿‡`EXPLAIN`æˆ–æ‰§è¡Œè®¡åˆ’å·¥å…·å¯ç¡®è®¤æ˜¯å¦å‘ç”Ÿå…¨è¡¨æ‰«æï¼Œåº”é‡ç‚¹å…³æ³¨é«˜é¢‘æŸ¥è¯¢å’Œå¤§è¡¨çš„å…¨è¡¨æ‰«ææƒ…å†µã€‚

### ä»€ä¹ˆæ˜¯å›è¡¨ï¼Ÿ
æ•°æ®åº“å›è¡¨ï¼ˆåˆç§°â€œå›ä¸»è¡¨â€ï¼‰æ˜¯æŒ‡åœ¨ä½¿ç”¨éè¦†ç›–ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œæ•°æ®åº“å…ˆé€šè¿‡ç´¢å¼•æŸ¥æ‰¾åˆ°è®°å½•çš„ä¸»é”®æˆ– rowidï¼Œç„¶åå†æ ¹æ®è¿™ä¸ªä¸»é”®æˆ– rowid å»ä¸»è¡¨ä¸­æŸ¥æ‰¾å®Œæ•´çš„æ•°æ®è¡Œçš„è¿‡ç¨‹ã€‚

ä¸å…¨è¡¨æ‰«æå¯¹æ¯”å¦‚ä¸‹ï¼š

| å¯¹æ¯”é¡¹    | å›è¡¨             | å…¨è¡¨æ‰«æ            |
| ------ | -------------- | --------------- |
| å®šä½æ–¹å¼   | é€šè¿‡ç´¢å¼•å®šä½ï¼Œå†æŸ¥ä¸»è¡¨    | é¡ºåºæ‰«ææ•´å¼ è¡¨         |
| è¯»å–æ•°æ®é‡  | åªè¯»å–æ»¡è¶³æ¡ä»¶çš„è®°å½•     | æ‰«ææ‰€æœ‰è¡Œ           |
| è§¦å‘æ¡ä»¶   | æŸ¥è¯¢å­—æ®µæœªåŒ…å«åœ¨ç´¢å¼•ä¸­    | æ— ç´¢å¼•å¯ç”¨ / æŸ¥è¯¢æ•°æ®å¤ªå¤š  |
| å…¸å‹é€‚ç”¨åœºæ™¯ | ç´¢å¼•è¿‡æ»¤ç²¾ç¡®ã€å°æ‰¹é‡æ•°æ®è®¿é—® | è¡¨å°ã€æˆ–è¿”å›å¤§æ‰¹é‡æ•°æ®æ—¶æ›´åˆé€‚ |
| æ€§èƒ½ï¼ˆå¤§è¡¨ï¼‰ | å¿«ï¼ˆå°é‡è®¿é—®ï¼‰        | æ…¢ï¼ˆéœ€æ‰«æ•´ä¸ªè¡¨ï¼‰        |

### æ•°æ®åº“å¤§è¡¨å®šä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ
åœ¨OracleDBå’ŒGaussDBä¸­ï¼Œå¤§è¡¨çš„å®šä¹‰ä¸ä¼˜åŒ–ç­–ç•¥å› æ¶æ„è®¾è®¡åŠåŠŸèƒ½ç‰¹æ€§çš„ä¸åŒè€Œæœ‰æ‰€å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯ä¸¤è€…çš„å¯¹æ¯”åˆ†æï¼š

---

#### **ä¸€ã€OracleDBå¯¹å¤§è¡¨çš„å®šä¹‰**
##### **1. æ ¸å¿ƒæ ‡å‡†**
- **æ•°æ®é‡é˜ˆå€¼**ï¼š
  - ä¼ ç»Ÿç»éªŒå€¼è®¤ä¸ºï¼Œè®°å½•æ•°è¶…è¿‡ **100ä¸‡è¡Œ** çš„è¡¨å¯è§†ä¸ºå¤§è¡¨ï¼Œè¶…è¿‡ **1000ä¸‡è¡Œ** åˆ™å¯èƒ½éœ€åˆ†åŒºä¼˜åŒ–æ€§èƒ½ã€‚
  - ç‰©ç†å­˜å‚¨å¤§å°è¶…è¿‡ **10GB** çš„è¡¨é€šå¸¸ä¹Ÿè¢«å½’ç±»ä¸ºå¤§è¡¨ã€‚
- **å†…éƒ¨å‚æ•°**ï¼š
  - Oracleé€šè¿‡ `_small_table_threshold` å‚æ•°åŠ¨æ€ç•Œå®šå¤§å°è¡¨ï¼Œè¯¥å‚æ•°é»˜è®¤å€¼ä¸º **Buffer Cacheæ€»é‡çš„2%**ã€‚è‹¥è¡¨å¤§å°è¶…è¿‡æ­¤é˜ˆå€¼ï¼Œåˆ™è§†ä¸ºå¤§è¡¨ï¼Œå…¶å…¨è¡¨æ‰«æä¼šè¢«æ ‡è®°ä¸ºâ€œLong Table Scanâ€ï¼Œå¹¶å¯èƒ½è§¦å‘ä¸åŒçš„ç¼“å­˜ç®¡ç†ç­–ç•¥ã€‚

##### **2. æ€§èƒ½å½±å“**
- **å…¨è¡¨æ‰«æé£é™©**ï¼šå¤§è¡¨çš„å…¨è¡¨æ‰«æå¯èƒ½å¯¼è‡´ `db file scattered read` ç­‰å¾…äº‹ä»¶æ˜¾è‘—å¢åŠ ï¼Œå½±å“æ•´ä½“æ•°æ®åº“æ€§èƒ½ã€‚
- **ç»´æŠ¤æˆæœ¬**ï¼šå¤§è¡¨çš„DDLæ“ä½œï¼ˆå¦‚ALTER TABLEï¼‰è€—æ—¶è¾ƒé•¿ï¼Œä¸”å¤‡ä»½æ¢å¤å›°éš¾ã€‚

##### **3. ä¼˜åŒ–ç­–ç•¥**
- **åˆ†åŒºè¡¨**ï¼šæŒ‰èŒƒå›´ã€åˆ—è¡¨æˆ–å“ˆå¸Œåˆ†åŒºï¼Œå‡å°‘å•åˆ†åŒºæ•°æ®é‡ã€‚
- **ç´¢å¼•è®¾è®¡**ï¼šä¼˜å…ˆä½¿ç”¨å¤åˆç´¢å¼•æˆ–è¦†ç›–ç´¢å¼•ï¼Œå‡å°‘å›è¡¨æ“ä½œã€‚
- **å¤šç¼“å†²æ± ç®¡ç†**ï¼šé€šè¿‡è®¾ç½® `KEEP` æˆ– `RECYCLE` ç¼“å†²æ± ï¼Œä¼˜åŒ–å†…å­˜ä½¿ç”¨ã€‚

---

#### **äºŒã€GaussDBå¯¹å¤§è¡¨çš„å®šä¹‰**
##### **1. æ ¸å¿ƒæ ‡å‡†**
- **åˆ†å¸ƒå¼æ¶æ„ç‰¹æ€§**ï¼š
  - GaussDBä½œä¸ºåˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆMPPæ¶æ„ï¼‰ï¼Œå¤§è¡¨å®šä¹‰ä¸æ•°æ®åˆ†å¸ƒç­–ç•¥å¼ºç›¸å…³ã€‚é€šå¸¸é‡‡ç”¨ **å“ˆå¸Œåˆ†å¸ƒï¼ˆHashï¼‰** çš„è¡¨è¢«è§†ä¸ºå¤§è¡¨ï¼Œè€Œ **å¤åˆ¶è¡¨ï¼ˆReplicationï¼‰** é€‚ç”¨äºå°è¡¨ã€‚
  - å“ˆå¸Œåˆ†å¸ƒè¡¨çš„å…¸å‹åœºæ™¯æ˜¯ **æ•°æ®é‡å¤§çš„äº‹å®è¡¨**ï¼ˆå¦‚è®¢å•è¡¨ï¼‰ï¼Œéœ€é€šè¿‡åˆ†ç‰‡åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹å¤„ç†ã€‚
- **å­˜å‚¨æ¨¡å‹**ï¼š
  - **è¡Œå­˜å‚¨è¡¨**ï¼šé€‚ç”¨äºé¢‘ç¹æ›´æ–°æˆ–ç‚¹æŸ¥è¯¢çš„å¤§è¡¨ã€‚
  - **åˆ—å­˜å‚¨è¡¨**ï¼šé€‚ç”¨äºç»Ÿè®¡åˆ†æç±»å¤§è¡¨ï¼ˆå¦‚æ•°ä»“åœºæ™¯ï¼‰ï¼Œé€šè¿‡åˆ—å‹ç¼©å’Œå‘é‡åŒ–è®¡ç®—æå‡æ€§èƒ½ã€‚

##### **2. æ€§èƒ½å½±å“**
- **æ•°æ®å€¾æ–œé—®é¢˜**ï¼šè‹¥å“ˆå¸Œåˆ†å¸ƒåˆ—é€‰æ‹©ä¸å½“ï¼Œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹é—´æ•°æ®åˆ†å¸ƒä¸å‡ï¼Œå½±å“å¹¶è¡Œæ•ˆç‡ã€‚
- **å­˜å‚¨å†—ä½™**ï¼šå¤åˆ¶è¡¨è™½ç„¶é¿å…è·¨èŠ‚ç‚¹é€šä¿¡ï¼Œä½†ä¼šå¯¼è‡´å…¨é‡æ•°æ®å†—ä½™ï¼Œä»…é€‚ç”¨äºå°ç»´åº¦è¡¨ã€‚

##### **3. ä¼˜åŒ–ç­–ç•¥**
- **åˆ†å¸ƒåˆ—é€‰æ‹©**ï¼šä¼˜å…ˆé€‰æ‹©ç¦»æ•£åº¦é«˜ä¸”å¸¸ç”¨äºå…³è”æŸ¥è¯¢çš„åˆ—ä½œä¸ºå“ˆå¸Œåˆ†å¸ƒåˆ—ï¼Œé¿å…æ•°æ®å€¾æ–œã€‚
- **å±€éƒ¨èšç°‡ï¼ˆPartial Cluster Keyï¼‰**ï¼šåœ¨åˆ—å­˜è¡¨ä¸­é€šè¿‡ç¨€ç–ç´¢å¼•åŠ é€Ÿè¿‡æ»¤ï¼Œé€‚ç”¨äºé«˜é¢‘è¿‡æ»¤å­—æ®µã€‚
- **Deltaè¡¨**ï¼šé’ˆå¯¹åˆ—å­˜è¡¨çš„å°æ‰¹é‡å†™å…¥åœºæ™¯ï¼Œé€šè¿‡è¡Œå­˜Deltaè¡¨å‡å°‘å°CUç”Ÿæˆï¼Œæå‡å†™å…¥æ€§èƒ½ã€‚

---

#### **ä¸‰ã€å¯¹æ¯”æ€»ç»“**
| **ç»´åº¦**         | **OracleDB**                            | **GaussDB**                              |
|------------------|----------------------------------------|------------------------------------------|
| **å®šä¹‰ä¾æ®**     | è¡Œæ•°ï¼ˆ100ä¸‡+ï¼‰ã€ç‰©ç†å¤§å°ã€å†…éƒ¨ç¼“å­˜å‚æ•°  | åˆ†å¸ƒç­–ç•¥ï¼ˆå“ˆå¸Œè¡¨ä¸ºä¸»ï¼‰ã€å­˜å‚¨æ¨¡å‹ï¼ˆè¡Œ/åˆ—å­˜ï¼‰ |
| **å…¸å‹åœºæ™¯**     | OLTPé«˜é¢‘äº‹åŠ¡å¤„ç†                       | åˆ†å¸ƒå¼åˆ†æå‹åœºæ™¯ï¼ˆå¦‚æ•°ä»“ï¼‰               |
| **ä¼˜åŒ–æ ¸å¿ƒ**     | åˆ†åŒºã€ç´¢å¼•ã€ç¼“å†²æ±                      | åˆ†å¸ƒåˆ—è®¾è®¡ã€å±€éƒ¨èšç°‡ã€Deltaè¡¨            |
| **æ•°æ®åˆ†å¸ƒ**     | å•æœºå­˜å‚¨ï¼Œä¾èµ–åˆ†åŒº                     | å¤šèŠ‚ç‚¹å“ˆå¸Œåˆ†å¸ƒï¼Œæ”¯æŒæ¨ªå‘æ‰©å±•             |

---

#### **å››ã€å®è·µå»ºè®®**
1. **OracleDB**ï¼š
   - ç›‘æ§ `V$SYSSTAT` ä¸­çš„ `table scans (long tables)` ç»Ÿè®¡ï¼Œè¯†åˆ«å¤§è¡¨æ‰«æé¢‘ç‡ã€‚
   - å¯¹è¶…è¿‡1000ä¸‡è¡Œçš„è¡¨ä¼˜å…ˆé‡‡ç”¨åˆ†åŒºï¼Œå¹¶ç»“åˆå¤åˆç´¢å¼•å‡å°‘å›è¡¨ã€‚

2. **GaussDB**ï¼š
   - ä½¿ç”¨ `SELECT xc_node_id, COUNT(1) FROM è¡¨å GROUP BY xc_node_id` æ£€æŸ¥æ•°æ®å€¾æ–œï¼Œåå·®è¶…è¿‡5%éœ€è°ƒæ•´åˆ†å¸ƒåˆ—ã€‚
   - æ··åˆä½¿ç”¨è¡Œå­˜ä¸åˆ—å­˜è¡¨ï¼Œåˆ†åˆ«å¤„ç†ç‚¹æŸ¥è¯¢å’Œåˆ†æå‹æŸ¥è¯¢ã€‚

é€šè¿‡ä¸Šè¿°ç­–ç•¥ï¼Œå¯æœ‰æ•ˆç®¡ç†å¤§è¡¨æ€§èƒ½é—®é¢˜ã€‚å…·ä½“å®æ–½éœ€ç»“åˆä¸šåŠ¡åœºæ™¯å’Œå®é™…æ•°æ®ç‰¹å¾è¿›ä¸€æ­¥è°ƒæ•´ã€‚

## æ€§èƒ½è°ƒä¼˜
### æ”¯æŒä¸€æˆ·å¤šå¸
- å®¢æˆ·çš„æˆ·å£ä¿¡æ¯å­˜å‚¨åœ¨æˆ·å£å±‚ï¼Œå¸ç§ä¿¡æ¯å­˜å‚¨åœ¨è´¦å·å±‚ã€‚ä¸€ä¸ªå®¢æˆ·å­˜åœ¨å¤šä¸ªæˆ·å£å·ï¼Œä¸€ä¸ªæˆ·å£å·ä¸‹åˆå­˜åœ¨å¤šä¸ªè´¦å·ã€‚

- æœ€å¼€å§‹åªæœ‰æˆ·å£å±‚æ”¯æŒæ‰¹é‡æŸ¥æˆ·å£å·ï¼ŒæŸ¥è´¦å·å±‚ä¿¡æ¯æ˜¯å¾ªç¯éå†å»æŸ¥çš„ï¼Œéå¸¸çš„æ…¢ã€‚
  - ä¸€æ–¹é¢ï¼Œæ‰¾ä¸šåŠ¡æéœ€æ±‚ç»™è´¦å·å±‚ï¼Œæ”¯æŒä½¿ç”¨æ‰¹é‡æˆ·å£æŸ¥æ‰¹é‡è´¦å·ã€‚
  - å¦ä¸€æ–¹é¢ï¼Œæä¾›æœ¬åœ°ç¼“å­˜ï¼Œæ”¯æŒæŸ¥è¯¢ç¼“å­˜æ•°æ®ã€‚

### SQLæ€§èƒ½è°ƒä¼˜
- ä»£ç å±‚é¢ åˆ†é¡µã€ç¼“å­˜

- æ•°æ®åº“å±‚é¢ åˆé€‚çš„ç´¢å¼•ï¼Œæ¯”å¦‚åˆ—è¡¨æŸ¥è¯¢å¤šæ¡ä»¶

- sqlå±‚é¢ å–„ç”¨explain é¿å…ç´¢å¼•å¤±æ•ˆ

- æ€§èƒ½ç›‘æµ‹å·¥å…·ï¼ŸQPSã€TPS

## äº‘æœåŠ¡
### redis
#### redis å¸¸è§é—®é¢˜
##### ç¼“å­˜ç©¿é€
**é—®é¢˜è¯´æ˜ï¼š**
ç¼“å­˜å‡»ç©¿æŒ‡çš„æ˜¯å¤§é‡è¯·æ±‚æŸ¥è¯¢ç¼“å­˜ä¸­ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå¯¼è‡´è¿™äº›è¯·æ±‚ç›´æ¥è®¿é—®å¤‡ç”¨æ•°æ®æºï¼ˆå¦‚æ•°æ®åº“æˆ–å¤–éƒ¨æœåŠ¡ï¼‰ï¼Œä»è€Œé€ æˆç³»ç»Ÿèµ„æºæµªè´¹å’Œæ€§èƒ½é—®é¢˜ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
1) å‚æ•°æ ¡éªŒï¼šé€šè¿‡æ ¡éªŒæ‹¦æˆªéæ³•è¯·æ±‚ï¼Œé¿å…ä¸å¿…è¦çš„æŸ¥è¯¢ã€‚
2) ç¼“å­˜ç©ºå€¼ï¼šå½“æ•°æ®æºæŸ¥è¯¢ç»“æœä¸ºç©ºæ—¶ï¼Œå°†Redisç¼“å­˜å€¼è®¾ç½®ä¸ºç‰¹æ®Šå€¼ï¼ˆå¦‚`NULL`ï¼‰ï¼Œæ ‡è¯†è®°å½•ä¸å­˜åœ¨ã€‚
3) å¸ƒéš†è¿‡æ»¤å™¨ï¼šæ£€æµ‹è®°å½•IDæ˜¯å¦å­˜åœ¨ï¼Œä½†å®ç°è¾ƒå¤æ‚ï¼Œå»ºè®®ä¼˜å…ˆè€ƒè™‘å‰ä¸¤ç§æ–¹æ¡ˆã€‚
>å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰ æ˜¯ä¸€ç§é«˜æ•ˆçš„ç©ºé—´æ•°æ®ç»“æ„ï¼Œç”¨äºå¿«é€Ÿåˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦ä¸€å®šä¸å­˜åœ¨äºä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒé€šè¿‡æå°çš„å­˜å‚¨ç©ºé—´å’Œå¸¸æ•°çº§æ—¶é—´å¤æ‚åº¦ï¼ˆO(k)ï¼Œkä¸ºå“ˆå¸Œå‡½æ•°æ•°é‡ï¼‰å®ç°å¤§è§„æ¨¡æ•°æ®çš„æ£€ç´¢ï¼Œä½†å­˜åœ¨ä¸€å®šçš„è¯¯åˆ¤ç‡ï¼ˆå¯èƒ½è¯¯æŠ¥å­˜åœ¨ï¼Œä½†ç»ä¸ä¼šæ¼æŠ¥ä¸å­˜åœ¨ï¼‰ã€‚

##### ç¼“å­˜å‡»ç©¿
**é—®é¢˜è¯´æ˜ï¼š**
æŒ‡åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œä¸€ä¸ªçƒ­ç‚¹keyå¤±æ•ˆæˆ–æœªç¼“å­˜æ—¶ï¼Œå¤§é‡è¯·æ±‚åŒæ—¶è®¿é—®å¤‡ç”¨æ•°æ®æºï¼ˆå¦‚æ•°æ®åº“ã€å¤–éƒ¨æœåŠ¡ç­‰ï¼‰ï¼Œå¯¼è‡´å¤‡ç”¨æ•°æ®æºå‹åŠ›è¿‡å¤§ç”šè‡³å²©æœºçš„æƒ…å†µã€‚  

**è§£å†³æ–¹æ¡ˆï¼š**
â€œæ§åˆ¶å¹¶å‘é‡â€ã€â€œäºŒçº§ç¼“å­˜â€ã€â€œåå°åˆ·æ–°çƒ­æ•°æ®â€ç­‰ã€‚ä¼˜å…ˆè€ƒè™‘æ§åˆ¶å¹¶å‘é‡ï¼Œå¯¹å“åº”æ—¶é—´è¾ƒæ•æ„Ÿçš„æƒ…å†µå¯è€ƒè™‘äºŒçº§ç¼“å­˜ã€‚  
1) æ§åˆ¶å¹¶å‘é‡ï¼šåˆ†å¸ƒå¼é”ã€javaäº’æ–¥é”ã€æ§åˆ¶è¿æ¥æ•°  
2) äºŒçº§ç¼“å­˜ï¼šæœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜æŒ‰éœ€è®¾ç½®å…ˆå  
3) åå°åˆ·æ–°çƒ­æ•°æ®ï¼šé€šè¿‡å®šæ—¶ä»»åŠ¡åå°åˆ·æ–°ï¼Œé¿å…çƒ­ç‚¹æ•°æ®ä¸¢å¤±ã€‚è¯¥æ–¹æ¡ˆéœ€è€ƒè™‘åŒºåˆ†ä¸šåŠ¡ä¸Šçš„çƒ­ç‚¹æ•°æ®å’Œéçƒ­ç‚¹æ•°æ®ï¼Œä¸”è¦è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ï¼Œä¸æ¨èä½¿ç”¨ã€‚

##### ç¼“å­˜é›ªå´©
**é—®é¢˜è¯´æ˜ï¼š**
æŒ‡å› Redisæ•…éšœã€æ“ä½œä¸å½“ç­‰åŸå› å¯¼è‡´ç¼“å­˜ä¸­å¤§é‡çš„é”®åŒæ—¶å¤±æ•ˆï¼Œå¯¼è‡´æ‰€æœ‰ç›¸å…³çš„è¯·æ±‚éƒ½è½åˆ°äº†å¤‡ç”¨æ•°æ®æºï¼ˆæ¯”å¦‚æ•°æ®åº“ï¼‰ï¼Œä»è€Œé€ æˆå¤‡ç”¨æ•°æ®æºç¬é—´å‹åŠ›è¿‡å¤§ç”šè‡³å²©æœºçš„æƒ…å†µã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
æœ‰â€œæ§åˆ¶å¹¶å‘é‡â€ã€â€œè®¾ç½®é€‚å½“çš„è¿‡æœŸæ—¶é—´â€ã€â€œæ‹·è´ç¼“å­˜â€ã€â€œç†”æ–­â€4ç§æ–¹æ¡ˆã€‚é€šå¸¸é‡‡ç”¨â€œç†”æ–­â€æ–¹æ¡ˆï¼Œå¯¹äºé‡‡ç”¨åŒæ´»å®ä¾‹éƒ¨ç½²æ¶æ„çš„åœºæ™¯å¯åŒæ—¶è€ƒè™‘åŒæ´»å®ä¾‹çš„â€œæ‹·è´ç¼“å­˜â€ã€‚ å…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š  
1) â€œæ§åˆ¶å¹¶å‘é‡â€ï¼šå‚è€ƒâ€œç¼“å­˜å‡»ç©¿â€éƒ¨åˆ†ä¸­çš„â€œæ§åˆ¶å¹¶å‘é‡â€æ–¹æ¡ˆï¼Œæ§åˆ¶è¯·æ±‚å¤‡ç”¨æ•°æ®æºçš„å¹¶å‘é‡;  
2) "è®¾ç½®é€‚å½“çš„è¿‡æœŸæ—¶é—´â€ï¼šä¸ºKeyçš„è¿‡æœŸæ—¶é—´åˆç†è®¾ç½®éšæœºåç§»é‡ä»¥æ‰“æ•£è¿‡æœŸæ—¶é—´;  
3) "æ‹·è´ç¼“å­˜â€ï¼šå¯¹äºé‡‡ç”¨â€œåŒæ´»å®ä¾‹â€éƒ¨ç½²æ¶æ„æå‡Redisç¼“å­˜å±‚é«˜å¯ç”¨çš„åœºæ™¯ï¼Œå¯è€ƒè™‘æ‹·è´ç¼“å­˜ä»¥é™ä½Redisé›ªå´©çš„æ¦‚ç‡ï¼›  
4) â€œç†”æ–­"ï¼šå¯æ ¹æ®é”™è¯¯ç‡ã€å“åº”æ—¶é—´ç­‰è®¾ç½®ç†”æ–­æœºåˆ¶ã€‚  

### kafka
#### Kafkaå¦‚ä½•ä¿è¯æ¶ˆæ¯åªèƒ½è¢«æ¶ˆè´¹ä¸€æ¬¡å‘¢ï¼Ÿ

##### æ ¸å¿ƒé€»è¾‘ï¼šè®°ç¬”è®° + é˜²æ‰‹æŠ–**
1. **è®°ç¬”è®°ï¼ˆOffsetï¼‰**  
   Kafka ç”¨ `__consumer_offsets` è¿™ä¸ªâ€œç¬”è®°æœ¬â€è®°å½•æ¯ä¸ªæ¶ˆè´¹è€…ç»„ï¼ˆConsumer Groupï¼‰çš„æ¶ˆè´¹è¿›åº¦ã€‚  
   **ä¸‹æ¬¡æ¶ˆè´¹æ—¶ï¼Œç›´æ¥ç¿»ç¬”è®°æ¥ç€è¯»ï¼Œä¸ä¼šé‡è¯»æ—§æ¶ˆæ¯ã€‚**

2. **é˜²æ‰‹æŠ–ï¼ˆExactly-Once é…ç½®ï¼‰**
   - **ç”Ÿäº§è€…é˜²é‡å‘**ï¼šå¼€å¯ `enable.idempotence=true`ï¼ˆé»˜è®¤å¼€ï¼‰ï¼Œç›¸åŒæ¶ˆæ¯åªå‘ä¸€æ¬¡ã€‚
   - **æ¶ˆè´¹è€…é˜²é‡å¤**ï¼š
      - **æ‰‹åŠ¨æäº¤ Offset**ï¼ˆä»£ç ä¸­è°ƒç”¨ `commitSync()`ï¼‰
      - é…ç½® `isolation.level=read_committed`ï¼ˆåªè¯»å·²æäº¤çš„æ¶ˆæ¯ï¼‰

---

##### é¦–æ¬¡æ¶ˆè´¹æ—¶æ€ä¹ˆåŠï¼Ÿ
- **`auto.offset.reset=earliest`**ï¼šä»æœ€æ—©çš„æ¶ˆæ¯å¼€å§‹è¯»ï¼ˆå¯èƒ½è¯»åˆ°å†å²æ•°æ®ï¼‰
- **`auto.offset.reset=latest`**ï¼šåªè¯»**æ–°æ¶ˆæ¯**ï¼ˆå¿½ç•¥å†å²ï¼Œæ¨èå¸¸ç”¨ï¼‰

---

##### ä¸€å¥è¯æ€»ç»“
Kafka é€šè¿‡è®°å½•æ¶ˆè´¹è¿›åº¦ï¼ˆOffsetï¼‰+ ç”Ÿäº§è€…/æ¶ˆè´¹è€…çš„é˜²é‡é…ç½®ï¼Œä¿è¯æ¶ˆæ¯åªè¢«æ¶ˆè´¹ä¸€æ¬¡ã€‚é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œç”¨ `latest` å¯é¿å…æ¶ˆè´¹æ—§æ•°æ®ã€‚

### äº‘æœåŠ¡ç°åº¦ç­–ç•¥
#### æŸ¥è¯¢ç±»äº‘æœåŠ¡
##### ç°åº¦æ–¹æ¡ˆæ€»ä½“æ¶æ„å›¾
![](images/æŸ¥è¯¢ç±»äº‘æœåŠ¡ç°åº¦è¿ç§»ç¤ºæ„å›¾.png)

##### ä¸»è¦æ­¥éª¤
1. **éƒ¨ç½²æ–°å®ä¾‹**ï¼šæ ¹æ®éœ€æ±‚éƒ¨ç½²æ–°çš„äº‘æœåŠ¡å®ä¾‹ã€‚

2. **æ•°æ®åŒæ­¥**ï¼šè‹¥æ— éœ€åŒæ­¥åˆ™è·³è¿‡,å¦åˆ™å¯ä½¿ç”¨äº‘æœåŠ¡æ–¹æä¾›çš„æ•°æ®åŒæ­¥æ–¹æ¡ˆã€‚
3. **å®ç°åŒå†™**ï¼šåŒå†™æ–¹æ¡ˆæ ¸å¿ƒæ­¥éª¤ï¼Œç¡®ä¿å†™å…¥æ•°æ®æ—¶åŒæ—¶å†™å…¥æ–°æ—§ESæˆ–Redisã€‚
4. **ç°åº¦æµé‡åˆ‡æ¢**ï¼šå°†è¯»æµé‡åˆ†æ‰¹è¿›è¡Œè¿ç§»ã€‚ä¾‹å¦‚ï¼Œå¯å…ˆåˆ‡æ¢ç™¾åˆ†ä¹‹åæµé‡åˆ°ç°åº¦äº‘æœåŠ¡å®ä¾‹ï¼ŒéªŒè¯æ— è¯¯åå†é€æ­¥å¢å¤§æµé‡æ¯”ä¾‹ã€‚
5. **å…³é—­åŒå†™**ï¼šå½“æ‰€æœ‰åº”ç”¨ç¨‹åºæµé‡å·²ç™¾åˆ†ç™¾åˆ‡æ¢åˆ°æ–°ESæˆ–Rediså®ä¾‹åï¼Œå¯åœæ­¢åŒå†™ç­–ç•¥ï¼Œå¹¶å…³é—­æ—§å®ä¾‹ã€‚

##### å…³é”®ç‚¹
åœ¨å®æ–½åŒå†™æ–¹æ¡ˆæ—¶ï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹å››ç‚¹ä»¥ç¡®ä¿è¿ç§»çš„æˆåŠŸï¼š

- **é€æ­¥åˆ‡æ¢**ï¼šé€æ­¥åˆ‡æ¢è¯»è¯·æ±‚å¹¶ç›‘æ§æ–°å®ä¾‹æ€§èƒ½ï¼Œé™ä½ç°åº¦ESæˆ–Redisæ•…éšœæ—¶çš„å½±å“èŒƒå›´ã€‚

- **é™çº§æ–¹æ¡ˆ**ï¼šè®¾è®¡å¥½ç›¸åº”æŸ¥è¯¢ç±»äº‘æœåŠ¡çš„é™çº§æ–¹æ¡ˆï¼Œé˜²èŒƒç”Ÿäº§äº‹æ•…ã€‚
- **åŒå†™æ•°æ®ä¸€è‡´æ€§**ï¼šç¡®ä¿åŒå†™æ•°æ®ä¸€è‡´æ€§ï¼Œå‘ç°ä¸ä¸€è‡´æ—¶æ’æŸ¥åŸå› å¹¶è¿›è¡Œä¿®å¤ã€‚
- **åº”å¯¹è¯»å†™å‹åŠ›**ï¼šæå‰å¸ƒå±€ä»¥åº”å¯¹åŒå†™ç»™åº”ç”¨ç¨‹åºå¸¦æ¥çš„è¯»å†™å‹åŠ›ã€‚

#### æ¶ˆæ¯ç±»äº‘æœåŠ¡
##### ç°åº¦æ–¹æ¡ˆæ€»ä½“æ¶æ„å›¾
![](images/æ¶ˆæ¯ç±»äº‘æœåŠ¡ç°åº¦æ–¹æ¡ˆæ€»ä½“æ¶æ„å›¾.png)

##### åŸç”Ÿç¼ºé™·
éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—åœºæ™¯ä¸­ï¼Œç°åº¦è¿ç§»æ–¹æ¡ˆå­˜åœ¨ä¸€å®šçš„åŸç”Ÿç¼ºé™·ï¼Œä¸»è¦åŸå› æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š

1. **é¡ºåºæ€§**ï¼šè®¸å¤šæ¶ˆæ¯é˜Ÿåˆ—åœºæ™¯è¦æ±‚ä¿æŒæ¶ˆæ¯çš„é¡ºåºæ€§ã€‚è¿ç§»ä¸­è‹¥åŒæ—¶æ“ä½œæ–°æ—§æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¾ˆéš¾ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ï¼Œå¯èƒ½å¯¼è‡´æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯æ—¶å‡ºç°é—®é¢˜ã€‚

2. **æ¶ˆè´¹è€…çŠ¶æ€**ï¼šè¿ç§»æ—¶æ¶ˆè´¹è€…é€šå¸¸éœ€è¦ç»´æŠ¤è‡ªèº«çš„æ¶ˆè´¹çŠ¶æ€ï¼ˆå¦‚Kafkaçš„æ¶ˆè´¹è€…ä½ç§»ï¼‰ï¼Œä»è€Œå¢åŠ äº†è¿ç§»çš„å¤æ‚æ€§ã€‚

3. **æ•°æ®ä¸€è‡´æ€§**ï¼šç”±äºæ¶ˆæ¯é˜Ÿåˆ—çš„å®æ—¶æ€§å’ŒåŠ¨æ€ç‰¹ç‚¹ï¼Œå¾ˆéš¾ä¿è¯åœ¨è¿ç§»è¿‡ç¨‹ä¸­æ•°æ®å®Œå…¨ä¸€è‡´ï¼Œå¯èƒ½å¯¼è‡´æ¶ˆè´¹è€…æ”¶åˆ°é‡å¤æˆ–ä¸¢å¤±çš„æ¶ˆæ¯ã€‚

4. **ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…çš„ååŒ**ï¼šå¦‚æœç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åˆ†åˆ«è¿æ¥åˆ°æ–°æ—§é˜Ÿåˆ—ç³»ç»Ÿï¼Œå¯èƒ½å¯¼è‡´æ¶ˆæ¯å¤„ç†å»¶è¿Ÿæˆ–æ¶ˆæ¯å †ç§¯ï¼Œå½±å“ç³»ç»Ÿæ€§èƒ½ã€‚

5. **ç‰¹å®šåœºæ™¯ä¸‹çš„é™åˆ¶**ï¼šåœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸‹ï¼Œå¦‚Kafkaçš„äº‹åŠ¡å¤„ç†å’ŒRabbitMQçš„æ­»ä¿¡é˜Ÿåˆ—ï¼Œç°åº¦è¿ç§»å¯èƒ½ä¼šå¯¼è‡´æ›´å¤æ‚çš„é—®é¢˜ï¼Œéœ€è¦é¢å¤–çš„å¤„ç†å’Œç»´æŠ¤ã€‚

å› æ­¤ï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—åœºæ™¯ä¸‹ï¼Œç°åº¦è¿ç§»æ–¹æ¡ˆå¯èƒ½ä¸é€‚åˆæ‰€æœ‰åœºæ™¯ã€‚ä½†é€šè¿‡è°¨æ…è§„åˆ’å’Œå®æ–½è¿ç§»ç­–ç•¥ï¼Œä»ç„¶å¯ä»¥å®ç°ç°åº¦è¿ç§»ã€‚åœ¨è¿›è¡Œè¿ç§»æ—¶ï¼Œéœ€è¦å……åˆ†è¯„ä¼°å¯èƒ½çš„é£é™©ï¼Œå¹¶ç¡®ä¿åœ¨è¿ç§»è¿‡ç¨‹ä¸­å°½å¯èƒ½å‡å°å¯¹ç³»ç»Ÿæ€§èƒ½å’Œå¯ç”¨æ€§çš„å½±å“ã€‚

##### ä¸»è¦æ­¥éª¤
1. **å‡†å¤‡ç»¿ç¯å¢ƒ**ï¼šéƒ¨ç½²æ–°çš„äº‘æœåŠ¡å®ä¾‹ï¼ˆç»¿ç¯å¢ƒï¼‰ï¼Œç¡®ä¿å…¶é…ç½®ã€ç½‘ç»œã€æ€§èƒ½ä¸åŸç”Ÿäº§ç¯å¢ƒï¼ˆè“ç¯å¢ƒï¼‰ç›¸åŒ¹é…ã€‚

2. **æ¨¡æ‹Ÿæµé‡æµ‹è¯•**ï¼šå¯¹ç»¿ç¯å¢ƒäº‘æœåŠ¡å®ä¾‹è¿›è¡Œæ¨¡æ‹Ÿæµé‡è¯»å†™æµ‹è¯•ï¼Œç¡®ä¿ç»¿ç¯å¢ƒå®ä¾‹å¯ç”¨æ€§ã€‚

3. **å…ˆåˆ‡æ¢å†™**ï¼šæ›´æ–°ç”Ÿäº§è€…åº”ç”¨ç¨‹åºé…ç½®ï¼Œå…ˆä¸€æ¬¡åˆ‡æ¢ç”Ÿäº§è€…åº”ç”¨æµé‡åˆ°ç»¿ç¯å¢ƒã€‚

4. **ååˆ‡æ¢è¯»**ï¼š ç­‰å¾…è“ç¯å¢ƒäº‘æœåŠ¡å®ä¾‹æ¶ˆè´¹å®Œæˆåï¼Œå†æ›´æ–°æ¶ˆè´¹è€…åº”ç”¨ç¨‹åºé…ç½®ï¼Œä¸€æ¬¡åˆ‡æ¢æ¶ˆè´¹è€…åº”ç”¨æµé‡åˆ°ç»¿ç¯å¢ƒï¼Œç„¶åéªŒè¯åº”ç”¨å’Œä¸šåŠ¡æ˜¯å¦æ­£å¸¸ï¼Œä¹Ÿå¯è”ç³»äº‘æœåŠ¡æ–¹å¸®å¿™ååŠ©ç¡®è®¤æ¶ˆæ¯ç±»äº‘æœåŠ¡çš„æœåŠ¡ç«¯æµé‡çŠ¶æ€ã€‚

5. **ç›‘æ§ä¸éªŒè¯**ï¼šå…³æ³¨ç»¿ç¯å¢ƒçš„æ€§èƒ½å’Œç¨³å®šæ€§ï¼Œç¡®ä¿æ–°å®ä¾‹èƒ½æ­£å¸¸å¤„ç†æ¶ˆæ¯è¯»å†™å‹åŠ›ï¼Œå¹¶ç¡®ä¿æ¶ˆæ¯ä¸€è‡´æ€§å’Œé¡ºåºæ€§ã€‚

6. **å…³é—­è“ç¯å¢ƒ**ï¼šå½“æ‰€æœ‰ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åº”ç”¨éƒ½åˆ‡æ¢åˆ°ç»¿ç¯å¢ƒåï¼Œç»ä¸¥æ ¼æ£€æŸ¥æ—§æ¶ˆæ¯é˜Ÿåˆ—æ²¡æœ‰åº”ç”¨ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œä¸€æ®µæ—¶é—´ï¼ˆä¾‹å¦‚ä¸€å‘¨ï¼‰åå¯å…³é—­è“ç¯å¢ƒï¼ŒèŠ‚çœèµ„æºã€‚

æ³¨æ„ï¼šè¯¥æ–¹æ¡ˆä¸­æœ€å¤§é£é™©ç‚¹ä¸ºï¼Œç¡®è®¤è“ç¯å¢ƒäº‘æœåŠ¡å®ä¾‹æ¶ˆè´¹å®Œæˆåéœ€å°½å¿«å®Œæˆåˆ‡æ¢ï¼Œä»¥é¿å…ç»¿ç¯å¢ƒä¸­æ¶ˆæ¯å †ç§¯ã€‚

## æ¶æ„çº¢çº¿
### ä¸€ã€ç‰µå¼•é¡¹
è¦æ±‚ 1ï¼šåŠå…¬ç¯å¢ƒ 30 åˆ†é’Ÿå†…å®šä½è®¾å¤‡çº§æ•…éšœ  
è¦æ±‚ 2ï¼šåº”éµå®ˆé‡è¦ç³»ç»Ÿæ¶æ„çº¢çº¿

### äºŒã€å¼ºåˆ¶é¡¹
è¦æ±‚ 3ï¼šã€ç›‘æ§ã€‘åº”è§„èŒƒå¯¹æ¥åŒ—æ–—  
è¦æ±‚ 4ï¼šã€åˆ‡æµã€‘é‡è¦ç³»ç»Ÿåº”ä½¿ç”¨ç°åº¦å‘å¸ƒå’Œè¿ç§»  
è¦æ±‚ 5ï¼šã€å®¹é”™ã€‘éƒ¨ç½²æ¶æ„åº”ç¬¦åˆåˆ†çº§éƒ¨ç½²åŸåˆ™  
è¦æ±‚ 6ï¼šã€è§£è€¦ã€‘é¿å…ç­‰çº§ä¸åŒ¹é…çš„ä¾èµ–  
è¦æ±‚ 7ï¼šã€å…¶ä»–ã€‘éµå¾ªæ•°æ®åº“å¼€å‘è§„èŒƒï¼Œå®Œæˆé«˜çº§åˆ«é—®é¢˜çš„æ•´æ”¹

### ä¸‰ã€è§‚å¯Ÿé¡¹
è¦æ±‚ 8ï¼šã€åˆ‡æµã€‘åº”è®¾è®¡åˆç†çš„ç°åº¦å‘å¸ƒå’Œè¿ç§»æ–¹æ¡ˆï¼Œç¡®ä¿ç°åº¦æµé‡è¦†ç›–é«˜é¢‘è°ƒç”¨çš„ API  
è¦æ±‚ 9ï¼šã€åˆ‡æµã€‘å‘å¸ƒã€è¿ç§»å¼‚å¸¸æ—¶ï¼Œåº”åœ¨å°½å¯èƒ½çŸ­çš„æ—¶é—´å†…å®Œæˆå›é€€å¹¶ç”Ÿæ•ˆ  
è¦æ±‚ 10ï¼šã€åˆ‡æµã€‘é‡è¦ç³»ç»Ÿæ¯å¹´å‡åº”å¼€å±•å……åˆ†çš„åº”æ€¥åˆ‡æ¢æ¼”ç»ƒ  
è¦æ±‚ 11ï¼šã€å®¹é”™ã€‘æ•°æ®åº“ã€äº‘æœåŠ¡å•ä¸ªèŠ‚ç‚¹åˆ‡æ¢ååº”ç”¨è¦èƒ½æ­£å¸¸è®¿é—®æ•°æ®åº“ã€äº‘æœåŠ¡  
è¦æ±‚ 12ï¼šã€å®¹é”™ã€‘æœ‰å¿…è¦çš„æ•°æ®åº“ã€äº‘æœåŠ¡è®¿é—®å¼‚å¸¸å¤„ç†æœºåˆ¶  
è¦æ±‚ 13ï¼šã€è§£è€¦ã€‘é¡¹ç›®å‘å¸ƒè¦è§£è€¦  
è¦æ±‚ 14ï¼šã€è§£è€¦ã€‘é¿å…éå¿…è¦çš„è·¨åŒºåŸŸï¼ˆDMZã€BIZã€Regionï¼‰è®¿é—®æ•°æ®åº“ã€äº‘æœåŠ¡  
è¦æ±‚ 15ï¼šã€è§£è€¦ã€‘é¿å…éå¿…è¦çš„è·¨ç¯å¢ƒè®¿é—®åº”ç”¨æœåŠ¡å•å…ƒã€æ•°æ®åº“ã€äº‘æœåŠ¡  
è¦æ±‚ 16ï¼šã€è§£è€¦ã€‘é¿å…â€œä¸šåŠ¡ä»£ç â€ç´§è€¦åˆå¤–éƒ¨æŠ€æœ¯ç»„ä»¶  
è¦æ±‚ 17ï¼šã€è§£è€¦ã€‘é¿å…è·¨å¤šä¸ªç³»ç»Ÿã€å¤šä¸ªå›¢é˜Ÿçš„å¤æ‚å¾ªç¯ä¾èµ–

ï¼ˆæ¶æ„ï¼‰é¡»å……åˆ†æ£€è§†ç›´æ¥ä¾èµ–D ç±»ç³»ç»Ÿå’Œ3 çº§æœåŠ¡å•å…ƒçš„é™çº§ç­–ç•¥ã€‚
ï¼ˆä»£ç ï¼‰ä¸¥æ ¼æ§åˆ¶äº‹åŠ¡æ—¶é—´ï¼Œé¿å…å‡ºç°é•¿äº‹åŠ¡æŠ¢å æ•°æ®åº“è¿æ¥ï¼Œå½±å“å…¶ä»–äº¤æ˜“ã€‚
ï¼ˆä»£ç ï¼‰è‡ªå»ºçº¿ç¨‹æ± åº”åˆç†è®¾ç½®çº¿ç¨‹æ± ç­‰å¾…é˜Ÿåˆ—å¤§å°å’Œæ‹’ç»ç­–ç•¥ã€‚
ï¼ˆä»£ç ï¼‰æ‰€æœ‰æ—¥å¿—å‡é¡»å¯¹æ¥ç»Ÿä¸€æ—¥å¿—å¹³å°ï¼Œé”™è¯¯ç é¡»ä¸ŠæŠ¥åŒ—æ–—ä¸”åº”æ ¹æ®ä¸šåŠ¡å¤„ç†ç»“æœåŒºåˆ†æˆåŠŸæˆ–å¤±è´¥ï¼Œä¸¤è€…å‡ä¸å¯é˜»å¡ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚
ï¼ˆè¿ç»´ï¼‰é¡»å…¨é¢æ¢³ç†ç³»ç»Ÿä¸­çš„æ‰€æœ‰åˆ‡æ¢å¼€å…³ç­‰æŠ€æœ¯å‚æ•°ï¼Œè§„èŒƒè¿™ç±»å‚æ•°çš„ä¿®æ”¹æµç¨‹ï¼Œå®šæœŸå¯¹å‚æ•°è¿›è¡Œæ ¸å¯¹æ ¡éªŒã€‚

## èµ‹èƒ½
### æ•°æ®åº“èµ‹èƒ½
GCH è¿ç§»
- å…³é”®å­—ä¸åŒºåˆ†å¤§å°å†™
- è¡¨åã€schemaååŒºåˆ†å¤§å°å†™ï¼Œå¤§å†™æ³¨æ„ç”¨åŒå¼•å·å¼•èµ·æ¥ï¼Œå¦åˆ™ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå°å†™
- GaussDBæ²¡æœ‰systimestampè¿™ä¸ªå‡½æ•°ï¼Œå»ºè®®ä»¥current_timestamp(n)ï¼Œå…¶ä¸­nä»£è¡¨æ—¶é—´ä½æ•°
- pageHelperé—®é¢˜

### SQLæ€§èƒ½è°ƒä¼˜èµ‹èƒ½
é•¿äº‹åŠ¡æ²»ç†ï¼šä¸‹æ¸¸è°ƒç”¨å¤±è´¥
å…¨è¡¨æ‰«æï¼šä»£ç å±‚é¢ã€ç´¢å¼•å±‚é¢ã€SQLå±‚é¢

# èµ‹èƒ½ç›¸å…³
## å¦‚ä½•èµ‹èƒ½ï¼ˆè§‚ç‚¹1ï¼‰
### åšå¥½èµ‹èƒ½å‡†å¤‡å·¥ä½œ
#### è¢«èµ‹èƒ½æ–¹ç³»ç»Ÿ
å…ˆæ¢³ç†å¥½å½“å‰å­˜åœ¨çš„é—®é¢˜ã€é‡æ„çš„ç›®æ ‡
å¯¹äº‘åº”ç”¨å¼€å‘èŒƒå¼è¦æœ‰ä¸€äº›åŸºæœ¬çš„å­¦ä¹ å’Œç†è§£
#### äº‘åº”ç”¨æ¶æ„å¸ˆ
æå‰äº†è§£ç›¸å…³çš„ä¸šåŠ¡èƒŒæ™¯ã€ç³»ç»Ÿç—›ç‚¹å’Œèµ‹èƒ½çš„è¯‰æ±‚

### æ¸…æ™°å®šä½
äº‘åº”ç”¨æ¶æ„å¸ˆåº”è¯¥åšâ€œå¼•å¯¼å¸ˆâ€è€Œä¸æ˜¯â€œå†³ç­–è€…â€
- èµ‹èƒ½è¿‡ç¨‹ä¸­ä»¥äº‘å¼€å‘èŒƒå¼ä¸ºæŒ‡å¼•ï¼Œæ³¨é‡ç³»ç»Ÿçš„ç—›ç‚¹å’Œèµ‹èƒ½è¯‰æ±‚çš„è§£å†³
- å¼•å¯¼é¡¹ç›®ç»„ä¸€æ­¥æ­¥åšå¥½ä¸šåŠ¡å»ºæ¨¡ã€æŠ€æœ¯å»ºæ¨¡å’Œä»£ç å®ç°
è¿‡ç¨‹ä¸­æœ‰ä»»ä½•è®¾è®¡ä¸Šçš„é€‰æ‹©ï¼Œç”±é¡¹ç›®ç»„çš„å¼€å‘åŒå­¦ä½œå‡ºå†³ç­–

### æˆäººä»¥æ¸”
åšäº‘ä¸Šæ€æƒ³çš„ä¼ æ’­è€…ï¼Œèµ‹èƒ½ä»¥å…·ä½“çš„é¡¹ç›®ç€æ‰‹
- æ—¢è¦å…³æ³¨äº‘å¼€å‘èŒƒå¼çš„å®æ–½ï¼ŒæŠ€èƒ½çš„ä¼ æˆ
- åˆè¦å…³æ³¨æ€ç»´æ¨¡å¼çš„è½¬å˜ï¼ŒåŸ¹å…»å’Œä¾èµ–é¡¹ç›®ç»„å†…çš„ç§å­é€‰æ‰‹æ¥è½åœ°æ•´ä¸ªé¡¹ç›®ç›®æ ‡

### æŒç»­èµ‹èƒ½
åšå¥½å¤šé˜¶æ®µèµ‹èƒ½çš„è®¡åˆ’å’Œå›æ£€è®¡åˆ’ï¼Œä¸€ä¸ªæ¨¡å—çš„ä»£ç å®ç°ä¸æ˜¯èµ‹èƒ½çš„ç»“æŸã€‚æ¶æ„å®ˆæŠ¤å’Œæ¨¡å‹ä¼˜åŒ–éœ€è¦æŒç»­çš„è¿›è¡Œï¼Œéœ€è¦åœ¨å¤šä¸ªé˜¶æ®µçš„å…³é”®èŠ‚ç‚¹åšå¥½å›æ£€ã€‚

## å¦‚ä½•èµ‹èƒ½ï¼ˆè§‚ç‚¹2ï¼‰
1) å‘Šè¯‰é¡¹ç›®ç»„äº‘å¼€å‘èŒƒå¼èƒ½å¸¦æ¥çš„å¥½å¤„ã€è§£å†³ä»€ä¹ˆé—®é¢˜
   > ä¸€ç§æ–°æ€æƒ³çš„å¼•å…¥ï¼Œå¿…ç„¶ä¼šäº§ç”Ÿä¸€å®šçš„æŠ—æ‹’ã€‚å¼ºè¡Œæ¨å¹¿ï¼Œå®¹æ˜“é€‚å¾—å…¶åã€‚æ‰€ä»¥é¦–å…ˆè¦å‘Šè¯‰é¡¹ç›®ç»„äº‘å¼€å‘èŒƒå¼èƒ½å¸¦æ¥çš„å¥½å¤„ã€è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œä»å¿ƒç†ä¸Šå¼€å‘ç»„æ¥å—äº‘å¼€å‘èŒƒå¼ã€‚
2) è§£å†³æ€æƒ³ä¸Šçš„é—®é¢˜ï¼Œå†è®¨è®ºå¦‚ä½•å¿«é€Ÿè½åœ°ï¼ˆCtrlC + CtrlVï¼‰
   > ç»™é¡¹ç›®ç»„ä¸€ä¸ªç®€å•ã€å¯ä»¥å¤åˆ»çš„ä¾‹å­
3) ååŠ©å¼€å‘ç»„ä»è¿‡ç¨‹å¼çš„æ€ç»´è½¬å˜æˆé¢å‘å¯¹è±¡æ€ç»´
   > æ€ç»´çš„æ”¹å˜ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œå¯¹é¢†åŸŸå¯¹è±¡çš„è¯†åˆ«ã€å®ä½“å……è¡€ã€é˜²è…è§£è—•ç­‰é‡ç‚¹ç¯èŠ‚éœ€è¦å®šæœŸå›æ£€

## èµ‹èƒ½çš„ä¸€äº›æŠ€å·§
1) åœ¨èµ‹èƒ½è¿‡ç¨‹ä¸­åˆ¶å®šä¸€äº›è§„èŒƒæ¸…å•
ä¸šåŠ¡å»ºæ¨¡ä¸èƒ½è®¨è®ºæŠ€æœ¯ç‚¹ï¼Œä¸€ä¸ªä¸šåŠ¡æµç¨‹å¤šå°‘åˆ†é’Ÿæ— æ³•è¾¾æˆä¸€è‡´ï¼Œåˆ™åŠ å…¥å¾…ç¡®è®¤æ¸…å•ï¼Œè®©é¢†åŸŸä¸“å®¶ä¼šåç¡®è®¤
2) åœ¨èµ‹èƒ½è¿‡ç¨‹ä¸­æœ‰ä¸ç†è§£çš„åœ°æ–¹ï¼Œå¯ä»¥ç”¨ç›¸å…³ç®€å•æ˜“æ‡‚çš„ç¤ºä¾‹æ¥è§£é‡Š
3) åœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­è®©å¼€å‘åŒäº‹æœ‰å……åˆ†çš„å‚ä¸æ„Ÿï¼Œè‡ªå·±ä¸ç”¨ç§°ä¸ºä¸»è§’
4) å®åœ¨å¾ˆéš¾è§£é‡Šå°±ç”¨æ‰“æ ·çš„æ–¹å¼æŒ‡å¯¼